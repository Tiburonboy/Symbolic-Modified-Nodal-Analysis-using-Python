<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>27&nbsp; Klon Centaur, Part 3 – Symbolic Modified Nodal Analysis&lt;br&gt;using Python</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Wien bridge oscillator.html" rel="next">
<link href="./Klon Centaur part 2v0.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-d6667c7b59069bf82d0268b148e64a53.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Example-problems.html">Example Problems</a></li><li class="breadcrumb-item"><a href="./Klon Centaur part 3v1.html"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Klon Centaur, Part 3</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Symbolic Modified Nodal Analysis<br>using Python</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/Tiburonboy/Symbolic-Modified-Nodal-Analysis-using-Python" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Basic_concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Basic Concepts</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Modified_Nodal_Analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Modified Nodal Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MNA_with_python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">MNA with Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Resistive_networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Resistive Networks</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./RLC_networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">RLC Networks</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Transfer_function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Transfer Function</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Transient_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Transient Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Mutual_inductance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Mutual Inductance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Initial_conditions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Initial Conditions</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Example-problems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Example Problems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Two port parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Two Port Parameters</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Thevenin equivalent circuit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Thevenin equivalent circuit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./State-variable-filter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">State Variable Filter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Superposition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Superposition</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2nd_order_BRF.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">2nd Order BRF</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Elliptic-function-LPF.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Elliptic Function LPF</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Bridge-T.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Bridge-T</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Pi-Filter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Pi Filter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SIDO-low-pass-filter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">SIDO Low Pass Filter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Super-node.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Super Node</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Modeling Op Amps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Modeling Op Amps</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Op Amp circuits.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Op Amp circuits</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Two amplifier RIAA Phono Preamp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Two Amplifier RIAA Phono Preamp</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mech-sys.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Mechanical Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Klon Centaur part 1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Klon Centaur, Part 1</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Klon Centaur part 2v0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Klon Centaur, Part 2</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Klon Centaur part 3v1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Klon Centaur, Part 3</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Wien bridge oscillator.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Wien Bridge Oscillator</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Diode Circuit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Diode Circuit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Bridged-T-coil_v2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Bridged T Coil</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Validation-tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Validation Tests</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./test_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Test 1</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./test_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Test 2</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./test_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Test 3</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./test_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Test 4</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./test_5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Test 5</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./test_6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Test 6</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./test_7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Test 7</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./test_8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Test 8</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./test_9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Test 9</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./test_10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Test 10</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./test_11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Test 11</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./test_12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Test 12</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./test_13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Test 13</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./test_14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Test 14</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./test_15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Test 15</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./References.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SymMNA_py.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">SymMNA.py</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Change-log.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Change Log</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Google Colab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Google Colab</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SMNA_mobile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">SMNA Mobile</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./EasyEDA_schematic_editor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">EasyEDA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./History_of_Electric_Circuit_Analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">History of Electric Circuit Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Quick_ref.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Quick Reference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Project_notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Project Notes</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-design_review" id="toc-sec-design_review" class="nav-link active" data-scroll-target="#sec-design_review"><span class="header-section-number">27.1</span> Design Review</a></li>
  <li><a href="#klon-centaur-clones" id="toc-klon-centaur-clones" class="nav-link" data-scroll-target="#klon-centaur-clones"><span class="header-section-number">27.2</span> Klon Centaur Clones</a></li>
  <li><a href="#sec-analysis_of_reactive_branches" id="toc-sec-analysis_of_reactive_branches" class="nav-link" data-scroll-target="#sec-analysis_of_reactive_branches"><span class="header-section-number">27.3</span> Analysis of Reactive Branches</a>
  <ul class="collapse">
  <li><a href="#sec-reactive_branch_1" id="toc-sec-reactive_branch_1" class="nav-link" data-scroll-target="#sec-reactive_branch_1"><span class="header-section-number">27.3.1</span> Reactive Branch 1</a></li>
  <li><a href="#sec-reactive_branch_2" id="toc-sec-reactive_branch_2" class="nav-link" data-scroll-target="#sec-reactive_branch_2"><span class="header-section-number">27.3.2</span> Reactive Branch 2</a></li>
  <li><a href="#sec-reactive_branch_3" id="toc-sec-reactive_branch_3" class="nav-link" data-scroll-target="#sec-reactive_branch_3"><span class="header-section-number">27.3.3</span> Reactive Branch 3</a></li>
  <li><a href="#sec-reactive_branch_3a" id="toc-sec-reactive_branch_3a" class="nav-link" data-scroll-target="#sec-reactive_branch_3a"><span class="header-section-number">27.3.4</span> Reactive Branch 3a</a></li>
  <li><a href="#analysis-using-the-extra-element-theorem" id="toc-analysis-using-the-extra-element-theorem" class="nav-link" data-scroll-target="#analysis-using-the-extra-element-theorem"><span class="header-section-number">27.3.5</span> Analysis Using the Extra Element Theorem</a></li>
  <li><a href="#sec-reactive_branch_3b" id="toc-sec-reactive_branch_3b" class="nav-link" data-scroll-target="#sec-reactive_branch_3b"><span class="header-section-number">27.3.6</span> Reactive Branch 3b</a></li>
  <li><a href="#sec-reactive_branch_4" id="toc-sec-reactive_branch_4" class="nav-link" data-scroll-target="#sec-reactive_branch_4"><span class="header-section-number">27.3.7</span> Reactive Branch 4</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">27.4</span> Summary</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Example-problems.html">Example Problems</a></li><li class="breadcrumb-item"><a href="./Klon Centaur part 3v1.html"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Klon Centaur, Part 3</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Klon Centaur, Part 3</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>This Chapter is the final installment in the Klon Centaur series. Presented in this notebook are a few comments I would provide, if I was attending a design review. Design reviews are standard practice across most industries. A short list of Klon Centaur clones is presented. Then an analysis of some of the reactive paths in the pedal’s circuits are presented. This is of particular interest since the function and operation of parts of the circuits is not intuitively obvious. The series on the Klon Centaur concludes with a final summary and comments.</p>
<!--

Last update: 25 July 2025

ToDo
- Klon Centaur, part 3: Design Review and Reactive branch analysis
- review terminations for reactive branches
- build a prototype to get actual circuit measured waveforms to validate the analysis
- design a variation of the Klon and build a prototype
  - explore alternate diode or non-linear configurations (soft clipping transistor stage).
  - ask/borrow a guitar from Max  
- think about removing some of the symbolic analysis, not really adding anything to understanding of the circuit.
- do spelling and grammar check for part 2 and ~part 3~
- ~update and fix captions for plots and figures~
- ~update schematics~
- remove unused lines of code
- correct reference designator subscripts
- remove unused files, png and schematics
- work on FACTS section under reactive branch 3a 
- upload book to github
- ~update gather files script~

versions
- 18 July 2025: version rolled to 3v1, the notebook file was getting long and sluggish when loading and editing on my laptop. Unused code and text will be deleted in 3v1. 

-->
<section id="sec-design_review" class="level2" data-number="27.1">
<h2 data-number="27.1" class="anchored" data-anchor-id="sec-design_review"><span class="header-section-number">27.1</span> Design Review</h2>
<p>This section is not a formal design review, but will only present some comments and concerns that might have come up at design review. I don’t know if Finnegan ever conducted any <a href="https://en.wikipedia.org/wiki/Design_review">design reviews</a> as is typically done in industry. In hindsight he should have taken steps to legally protect his design beyond trademarking the CENTAUR ™ name. I suppose at the time he didn’t know how popular his pedal would become and lack of funds limited his ability to patent Klon Centaur design. There are many examples of electric circuits that have been patented and Finnegan could have sought out help from friends to help with this aspect. He was naive to think that covering the components with black goop (epoxy) would keep his circuit a secret. Additionally, starting a business based on a product that had a critical component, the Germanium diodes, in extremely limited supply was shortsighted.</p>
<p>It has been reported that Finnegan worked with MIT graduate Fred Fenning and other electrical engineer friends on this project. The description of the development is a little vague but sounded like the design flow was mainly building prototype circuits, fiddling with the design and Finnegan doing evaluation and playing tests to get the tone he wanted. The design and development of the pedal took four and half years.</p>
<p>Sometimes it’s hard to describe exactly what makes something popular, but it’s evident that Finnegan’s goal to build a pedal that would provide guitar players with an open, transparent tone, similar to that of a turned-up tube amplifier, was unique and successful. The scarcity of original pedals contributes to them being coveted, valuable and copied. The ability to blend clean and distortion at low to high volume levels is what made this pedal unique at the time.</p>
<p>Here are a few comments that I would provide during a design review:</p>
<ul>
<li>The circuit analysis present in Part 1, <a href="Klon Centaur part 1.html#fig-klon-centaur-schematic-high-res_w_clean_path1_highlight_sch" class="quarto-xref">Figure&nbsp;<span>25.15</span></a>, shows that Clean Path 1 seems to contribute minimally to the output of the pedal, since the signal on this path gets covered over by signals on the other paths. I think the design could be simplified by removing this path. Blind listing tests would validate this assertion.</li>
<li>The analysis presented in <a href="#sec-reactive_branch_3" class="quarto-xref"><span>Section 27.3.3</span></a> seems to show that the function of this path is somewhat superfluous since the zero created by <span class="math inline">\(C_{13}\)</span> and <span class="math inline">\(R_{20}\)</span> negates the frequency emphasis created by this path.</li>
<li>The use of the dual gang pot, <span class="math inline">\(P_1\)</span>, to blend Clean Path 2 and the diode path should be evaluated. Perhaps there is a way the blending could be accomplished with a single pot. This would simplify the bill of materials and wiring the connections of the printed circuit board (PCB) to <span class="math inline">\(P_1\)</span>.</li>
<li>It seems that loud playing at gains of more than 50% will saturate U1b, those harmonics will color the tone. This aspect of the signal flow through the pedal needs to be examined more closely to determine if this is a desirable effect. Although, <span class="math inline">\(D_2\)</span> and <span class="math inline">\(D_3\)</span> will re-shape the harmonics.</li>
<li>The internal wiring of the PCB to <span class="math inline">\(S_1\)</span>, <span class="math inline">\(D_1\)</span> and the pots could be simplified to make assembly and production simplified.</li>
<li>The use of hand selected Germanium diodes is a problem since this limits future production with a parts obsolescence problem down the road.</li>
<li>A tolerance, reliability and temperature analysis of the design should be done. The mix of carbon and metal film resistors is unusual and contributes to a longer Bill of Materials (BOM).</li>
<li>Other reviews such as: requirements review, production readiness review, documentation review, testing review</li>
</ul>
</section>
<section id="klon-centaur-clones" class="level2" data-number="27.2">
<h2 data-number="27.2" class="anchored" data-anchor-id="klon-centaur-clones"><span class="header-section-number">27.2</span> Klon Centaur Clones</h2>
<p>The Klon Centaur is one of the most legendary and sought-after overdrive pedals in guitar history and clones stem from a few key factors. Bill Finnegan famously “gooped” (covered in epoxy resin) the circuit board of the original Centaurs to prevent replication. However, the circuit was eventually reverse-engineered and schematics became available online around 2008. The limited production of the original Klons (around 8,000 units) and their legendary status led to extremely high prices on the secondary market. This created a huge demand for more affordable alternatives.</p>
<p>Once the circuit was reverse engineered, several manufacturers began producing clones. These variations emerged for several reasons. Primarily to offer the Klon sound at a much lower price point and sourcing the exact original components (especially certain germanium diodes) became difficult and expensive, leading manufacturers to use readily available alternatives that aim to replicate the sound.</p>
<p>In 2014, Finnegan released the Klon KTR, a redesigned version intended for mass production. It uses surface-mount device (SMD) components, is smaller, and includes a buffered/true bypass selector. While the circuit is fundamentally the same as the original, the change in manufacturing methods and component types (even if the same <em>type</em> components, like germanium diodes) can lead to subtle differences that some purists notice.</p>
<p>Many clones (Klones) introduce “improvements” or additional features that weren’t on the original, such as:</p>
<ul>
<li>Bass boost switches (to address the Klon’s subtle low-end roll-off).</li>
<li>Different clipping diode options (silicon, LED, other germanium types) offer different overdrive textures.</li>
<li>Separate clean blend and gain controls (the original Klon uses a dual-ganged gain pot that blends clean and over driven signals).</li>
<li>Smaller enclosures.</li>
<li>True bypass versus a buffered bypass option.</li>
</ul>
<p>In essence, the Klon Centaur variations exist due to a combination of intentional minor adjustments by the original creator, the need to adapt the design for wider production (KTR), and the extensive efforts of other manufacturers to replicate, modify, and improve upon a highly sought-after and influential circuit.</p>
<p>There are many pedals inspired by the Klon Centaur, here are a few:</p>
<ul>
<li><p><a href="https://www.wamplerpedals.com/products/distortion-overdrive/tumnus-deluxe/">Wampler Tumnus Overdrive Pedal</a>: This is a very popular Klon clone that captures the essence of the Klon Centaur in a compact and affordable package. It has a wide range of gain on tap, from a subtle boost to a more overdriven sound. It also has a toggle switch that allows you to select between two different clipping voicings.</p></li>
<li><p><a href="https://www.earthquakerdevices.com/westwood">EarthQuaker Devices Westwood Translucent Overdrive</a>: This pedal is a bit more of a modern take on the Klon Centaur sound. It has a more aggressive clipping section that can add a bit more bite to your overdrive sound. It also has a three-band EQ that allows you to dial in your tone precisely.</p></li>
<li><p><a href="https://rockettpedals.com/product/rockaway-archer/">J Rockett Rockaway Archer</a>: This pedal is another well-regarded Klon clone that is known for its versatility. It has a wide range of gain on tap, as well as a toggle switch that allows you to select between two different clipping voicings. It also has a built-in clean boost that can be used to push your amp into overdrive.</p></li>
<li><p><a href="https://www.tonecityaudio.com/Products/info.aspx?itemid=45&amp;lcid=16">Tone City Bad Horse Overdrive</a>: This is a very affordable Klon clone that is surprisingly good. It captures the essence of the Klon Centaur sound in a compact and affordable package. However, it is not quite as transparent as some of the other pedals on this list.</p></li>
<li><p><a href="https://www.guitarworld.com/features/best-klon-clones">Best Klon clones 2024: Our pick of the best Klon Centaur Klones for every budget</a>: From straight-up clones to full reimaginings, here are some of the best Klon Centaur-inspired pedals on the market today.</p></li>
<li><p><a href="https://www.jimdunlop.com/way-huge-smalls-deep-state-conspiracy-theory-diodes-overdrive/">Way Huge Smalls Deep State Conspiracy Theory Diodes Overdrive</a>: The following bit of snake oil can be found in their product description:</p>
<blockquote class="blockquote">
<p>The Way Huge Deep State Overdrive is a limited-edition guitar pedal designed to emulate the sound of the Klon Centaur, a highly sought-after overdrive pedal from the mid-1990s. The Deep State utilizes a unique diode that Way Huge’s “resident mad scientist” Jeorge Tripps discovered. Tripps’ discovery of the diode was accidental and occurred during an experiment where he inserted the diodes into a Conspiracy Theory overdrive. Way Huge describes this diode as having a “truly magical-sounding voltage drop,” resulting in “smooth, velvety clipping” that is very responsive to playing dynamics.</p>
</blockquote></li>
</ul>
<p>A recent development in the world of Klon clones is that a legal complaint was filed in United States District Court, District of Massachusetts by <a href="https://unicourt.com/case/pc-db5-casegu8a7382714c14-2118518">Klon LLC</a> against Empower Tribe, dated May 30, 2025. It seems the essence of the complaint centers around the use of Klon’s registered “CENTAUR” Trade Mark on Behringer’s <a href="https://www.behringer.com/product.html?modelCode=0709-AKP">CENTARA OVERDRIVE</a> pedal, which has now been branded as “CENTARA”, but originally called “CENTAUR”.</p>
<p>Klon obtained two U.S. trademark registrations for the CENTAUR:</p>
<ul>
<li>U.S. Reg. No.&nbsp;5661741, registered on January 22, 2019, for electronic effects pedals, foot pedals, guitar pedals, sound effect pedals (Class 15), and repair/maintenance services (Class 37).</li>
<li>U.S. Reg. No.&nbsp;6147899, registered on September 8, 2020, for electronic effects pedals, sound effect pedals (Class 9), foot pedals, and guitar pedals (Class 15).</li>
</ul>
<p>Aside from the trademarked “Centaur” name, the pedal’s circuits, function and operation do not seem to be protected intellectual property.</p>
</section>
<section id="sec-analysis_of_reactive_branches" class="level2" data-number="27.3">
<h2 data-number="27.3" class="anchored" data-anchor-id="sec-analysis_of_reactive_branches"><span class="header-section-number">27.3</span> Analysis of Reactive Branches</h2>
<p>The following analysis will examine some of the reactive branches in the pedal’s circuits. A branch is essentially a portion of a circuit that contains one or more circuit elements (like resistors, capacitors, inductors etc.), connects two nodes and provides a topological framework for describing and analyzing the interconnections of components within an electrical circuit. In electrical circuits, <em>reactive branches</em> are branches that contain components that store and release energy rather than simply dissipating it as heat. These components are primarily inductors and capacitors. We want to answer the question - what are the components in this branch of the circuit doing? We have to be careful about loading effects provided by the other components attached to the branch we are analyzing that have been excluded. With this in mind, we can attempt to provide an intuitive explanation of the circuit’s operation.</p>
<!--

- sum path 2a
- gain pot set to 50%
- V2 set to zero
- rename schematics: reactive_branch_1, 2, 3, 4

-->
<p>The following Python modules are used in this JupyterLab notebook.</p>
<div id="e90560b1-89df-48a6-b4d7-ec74b3a19ff1" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;jupyter&quot;,&quot;value&quot;:{&quot;outputs_hidden&quot;:false}}" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sympy <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> signal</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.ticker</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> SymMNA</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display, Markdown, Math, Latex</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tabulate <span class="im">import</span> tabulate</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>init_printing()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The function below is used to display less digits when printing equations. It was copied from stackoverflow from the link provided in the comment.</p>
<div id="29462895-18cc-49bb-ae95-8a47f89cf7cf" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> round_expr(expr, num_digits):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">    from stackoverflow, used to display fewer digits</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">    https://stackoverflow.com/questions/48491577/printing-the-output-rounded-to-3-decimals-in-sympy</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> expr.xreplace({n : <span class="bu">round</span>(n, num_digits) <span class="cf">for</span> n <span class="kw">in</span> expr.atoms(Number)})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="sec-reactive_branch_1" class="level3" data-number="27.3.1">
<h3 data-number="27.3.1" class="anchored" data-anchor-id="sec-reactive_branch_1"><span class="header-section-number">27.3.1</span> Reactive Branch 1</h3>
<p>The circuit shown below is reactive branch 1. This circuit is a modified version of the circuit path analyzed in <a href="Klon Centaur part 1.html#sec-clean_tone_path1" class="quarto-xref"><span>Section 25.10.1</span></a> and is a slightly modified version of the highlighted portion of circuit shown in <a href="Klon Centaur part 1.html#fig-klon-centaur-schematic-high-res_w_clean_path1_highlight_sch" class="quarto-xref">Figure&nbsp;<span>25.15</span></a>.</p>
<p>This circuit branch starts at the output of Op Amp <span class="math inline">\(U_{1A}\)</span> and follows the components <span class="math inline">\(C_3\)</span>, <span class="math inline">\(R_7\)</span> and <span class="math inline">\(R_{24}\)</span> to the Op Amp <span class="math inline">\(U_{2A}\)</span>. Components <span class="math inline">\(R_6\)</span>, <span class="math inline">\(C_5\)</span>, <span class="math inline">\(P_1\)</span> and <span class="math inline">\(C_{16}\)</span> connect to circuit nodes along the branch of interest. The output of <span class="math inline">\(U_{1A}\)</span> is replaced by the independent voltage source <span class="math inline">\(V_1\)</span>. The inverting input of <span class="math inline">\(U_{2A}\)</span> is connected to <span class="math inline">\(R_{24}\)</span> and this is the summing junction for other signal paths in the Klon Centaur. <span class="math inline">\(C_3\)</span> acts as a DC block. The components, <span class="math inline">\(C_5\)</span>, <span class="math inline">\(R_6\)</span> and <span class="math inline">\(P_1\)</span> on node 3, and components <span class="math inline">\(R_7\)</span> and <span class="math inline">\(C_16\)</span> complete a low pass filter section ending at node 5.</p>
<p>The components,<span class="math inline">\(R_{24}\)</span>, <span class="math inline">\(R_{20}\)</span> and <span class="math inline">\(U_{2A}\)</span> are configured as an inverting amplifier with a gain of <span class="math inline">\(\frac{R_{20}}{R_{24}}\)</span>.</p>
<p>The circuit shown below is effectively a low pass filter with a DC block. <span class="math inline">\(C_3\)</span> will block low frequencies down to DC. <span class="math inline">\(C_4\)</span>, <span class="math inline">\(R_6\)</span> and <span class="math inline">\(R_{p1b}\)</span> will put a zero in the transfer function along with <span class="math inline">\(C_3\)</span>. Given that there are three capacitors in the circuit, there are likely three poles in the voltage transfer function. <span class="math inline">\(C_{13}\)</span> in the feedback of <span class="math inline">\(U_{2A}\)</span> was omitted from the analysis so that the operation of the circuit could be analyzed without the pole created by <span class="math inline">\(R_{20}\)</span> and <span class="math inline">\(C_{13}\)</span> from dominating the frequency response of the transfer function.</p>
<p>The component <span class="math inline">\(R_{p1b1}\)</span> in <a href="#fig-reactive_branch_1_sch" class="quarto-xref">Figure&nbsp;<span>27.1</span></a> is one of the dual ganged pots in <span class="math inline">\(P_1\)</span>. The wiper of <span class="math inline">\(P_1\)</span> is connected to ground. Node 4 in the schematic below is connected to the non-inverting input of <span class="math inline">\(U_{1B}\)</span>, but this connection is being ignored for this analysis since <span class="math inline">\(U_{1B}\)</span> is not on the signal path we are interested in. We can still get an idea of what the components shown in the schematic are doing, but the exact location of the poles and zeros will be a little off.</p>
<div id="fig-reactive_branch_1_sch" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-reactive_branch_1_sch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="reactive_branch_1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-reactive_branch_1_sch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;27.1: Schematic of reactive branch 1.
</figcaption>
</figure>
</div>
<p>The netlist below was exported from LTSpice.</p>
<div id="f3131504-09ea-42e3-8001-28f647c36142" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>reactive_branch_1_net_list <span class="op">=</span> <span class="st">'''</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="st">* Klon-Centaur_sum_path1_v1.asc</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="st">V1 1 0 1</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="st">C3 3 1 100e-9</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="st">R6 4 3 10e3</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="st">C5 4 3 68e-9</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="st">R7 3 5 1.5e3</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="st">R24 6 5 15e3</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="st">C16 5 0 1e-6</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="st">Rp1b 0 4 50e3</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="st">O2a 6 0 2</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="st">R20 2 6 392e3</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="st">*C13 2 6 820e-12</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="st">'''</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The MNA equations are generated from the function <code>SymMNA.smna</code>.</p>
<div id="008623d7-c183-40e2-ad4b-95538db8a2da" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>report, network_df, i_unk_df, A, X, Z <span class="op">=</span> SymMNA.smna(reactive_branch_1_net_list)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The code below assembles the network equations from the MNA matrices and displays the equations.</p>
<div id="0408d87f-6b9a-4b8a-a81d-9a85b1bdb0c7" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Put matrices into SymPy </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> Matrix(X)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> Matrix(Z)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>NE_sym <span class="op">=</span> Eq(A<span class="op">*</span>X,Z)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># display the equations</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> <span class="st">''</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(shape(NE_sym.lhs)[<span class="dv">0</span>]):</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    temp <span class="op">+=</span> <span class="st">'$</span><span class="sc">{:s}</span><span class="st"> = </span><span class="sc">{:s}</span><span class="st">$&lt;br&gt;'</span>.<span class="bu">format</span>(latex(NE_sym.rhs[i]),latex(NE_sym.lhs[i]))</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>Markdown(temp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="5">
<p><span class="math inline">\(0 = C_{3} s v_{1} - C_{3} s v_{3} + I_{V1}\)</span><br><span class="math inline">\(0 = I_{O2a} + \frac{v_{2}}{R_{20}} - \frac{v_{6}}{R_{20}}\)</span><br><span class="math inline">\(0 = - C_{3} s v_{1} + v_{3} \left(C_{3} s + C_{5} s + \frac{1}{R_{7}} + \frac{1}{R_{6}}\right) + v_{4} \left(- C_{5} s - \frac{1}{R_{6}}\right) - \frac{v_{5}}{R_{7}}\)</span><br><span class="math inline">\(0 = v_{3} \left(- C_{5} s - \frac{1}{R_{6}}\right) + v_{4} \left(C_{5} s + \frac{1}{Rp1b} + \frac{1}{R_{6}}\right)\)</span><br><span class="math inline">\(0 = v_{5} \left(C_{16} s + \frac{1}{R_{7}} + \frac{1}{R_{24}}\right) - \frac{v_{3}}{R_{7}} - \frac{v_{6}}{R_{24}}\)</span><br><span class="math inline">\(0 = v_{6} \cdot \left(\frac{1}{R_{24}} + \frac{1}{R_{20}}\right) - \frac{v_{5}}{R_{24}} - \frac{v_{2}}{R_{20}}\)</span><br><span class="math inline">\(V_{1} = v_{1}\)</span><br><span class="math inline">\(0 = v_{6}\)</span><br></p>
</div>
</div>
<p>The free symbols are entered as SymPy variables and the element values are put into a dictionary.</p>
<div id="63124dbd-b4c0-4053-b51f-434b99d1d510" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>var(<span class="bu">str</span>(NE_sym.free_symbols).replace(<span class="st">'{'</span>,<span class="st">''</span>).replace(<span class="st">'}'</span>,<span class="st">''</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>element_values <span class="op">=</span> SymMNA.get_part_values(network_df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="symbolic-solution" class="level4" data-number="27.3.1.1">
<h4 data-number="27.3.1.1" class="anchored" data-anchor-id="symbolic-solution"><span class="header-section-number">27.3.1.1</span> Symbolic solution</h4>
<p>The network equations can be solved symbolically.</p>
<div id="fbe4722c-1585-4dc1-83e4-a16ac5fe1c5b" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>U_sym <span class="op">=</span> solve(NE_sym,X)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Display the node voltages and dependent currents using symbolic notation.</p>
<div id="adf5e73f-ce4a-48f7-94f5-ccb31a7106c0" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> <span class="st">''</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> U_sym.keys():</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    temp <span class="op">+=</span> <span class="st">'$</span><span class="sc">{:s}</span><span class="st"> = </span><span class="sc">{:s}</span><span class="st">$&lt;br&gt;'</span>.<span class="bu">format</span>(latex(i),latex(U_sym[i]))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>Markdown(temp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="8">
<p><span class="math inline">\(v_{1} = V_{1}\)</span><br><span class="math inline">\(v_{2} = \frac{- C_{3} C_{5} R_{20} R_{6} Rp1b V_{1} s^{2} - C_{3} R_{20} R_{6} V_{1} s - C_{3} R_{20} Rp1b V_{1} s}{C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b s^{3} + C_{16} C_{3} R_{24} R_{6} R_{7} s^{2} + C_{16} C_{3} R_{24} R_{7} Rp1b s^{2} + C_{16} C_{5} R_{24} R_{6} R_{7} s^{2} + C_{16} C_{5} R_{24} R_{6} Rp1b s^{2} + C_{16} R_{24} R_{6} s + C_{16} R_{24} R_{7} s + C_{16} R_{24} Rp1b s + C_{3} C_{5} R_{24} R_{6} Rp1b s^{2} + C_{3} C_{5} R_{6} R_{7} Rp1b s^{2} + C_{3} R_{24} R_{6} s + C_{3} R_{24} Rp1b s + C_{3} R_{6} R_{7} s + C_{3} R_{7} Rp1b s + C_{5} R_{24} R_{6} s + C_{5} R_{6} R_{7} s + C_{5} R_{6} Rp1b s + R_{24} + R_{6} + R_{7} + Rp1b}\)</span><br><span class="math inline">\(v_{3} = \frac{C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b V_{1} s^{3} + C_{16} C_{3} R_{24} R_{6} R_{7} V_{1} s^{2} + C_{16} C_{3} R_{24} R_{7} Rp1b V_{1} s^{2} + C_{3} C_{5} R_{24} R_{6} Rp1b V_{1} s^{2} + C_{3} C_{5} R_{6} R_{7} Rp1b V_{1} s^{2} + C_{3} R_{24} R_{6} V_{1} s + C_{3} R_{24} Rp1b V_{1} s + C_{3} R_{6} R_{7} V_{1} s + C_{3} R_{7} Rp1b V_{1} s}{C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b s^{3} + C_{16} C_{3} R_{24} R_{6} R_{7} s^{2} + C_{16} C_{3} R_{24} R_{7} Rp1b s^{2} + C_{16} C_{5} R_{24} R_{6} R_{7} s^{2} + C_{16} C_{5} R_{24} R_{6} Rp1b s^{2} + C_{16} R_{24} R_{6} s + C_{16} R_{24} R_{7} s + C_{16} R_{24} Rp1b s + C_{3} C_{5} R_{24} R_{6} Rp1b s^{2} + C_{3} C_{5} R_{6} R_{7} Rp1b s^{2} + C_{3} R_{24} R_{6} s + C_{3} R_{24} Rp1b s + C_{3} R_{6} R_{7} s + C_{3} R_{7} Rp1b s + C_{5} R_{24} R_{6} s + C_{5} R_{6} R_{7} s + C_{5} R_{6} Rp1b s + R_{24} + R_{6} + R_{7} + Rp1b}\)</span><br><span class="math inline">\(v_{4} = \frac{C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b V_{1} s^{3} + C_{16} C_{3} R_{24} R_{7} Rp1b V_{1} s^{2} + C_{3} C_{5} R_{24} R_{6} Rp1b V_{1} s^{2} + C_{3} C_{5} R_{6} R_{7} Rp1b V_{1} s^{2} + C_{3} R_{24} Rp1b V_{1} s + C_{3} R_{7} Rp1b V_{1} s}{C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b s^{3} + C_{16} C_{3} R_{24} R_{6} R_{7} s^{2} + C_{16} C_{3} R_{24} R_{7} Rp1b s^{2} + C_{16} C_{5} R_{24} R_{6} R_{7} s^{2} + C_{16} C_{5} R_{24} R_{6} Rp1b s^{2} + C_{16} R_{24} R_{6} s + C_{16} R_{24} R_{7} s + C_{16} R_{24} Rp1b s + C_{3} C_{5} R_{24} R_{6} Rp1b s^{2} + C_{3} C_{5} R_{6} R_{7} Rp1b s^{2} + C_{3} R_{24} R_{6} s + C_{3} R_{24} Rp1b s + C_{3} R_{6} R_{7} s + C_{3} R_{7} Rp1b s + C_{5} R_{24} R_{6} s + C_{5} R_{6} R_{7} s + C_{5} R_{6} Rp1b s + R_{24} + R_{6} + R_{7} + Rp1b}\)</span><br><span class="math inline">\(v_{5} = \frac{C_{3} C_{5} R_{24} R_{6} Rp1b V_{1} s^{2} + C_{3} R_{24} R_{6} V_{1} s + C_{3} R_{24} Rp1b V_{1} s}{C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b s^{3} + C_{16} C_{3} R_{24} R_{6} R_{7} s^{2} + C_{16} C_{3} R_{24} R_{7} Rp1b s^{2} + C_{16} C_{5} R_{24} R_{6} R_{7} s^{2} + C_{16} C_{5} R_{24} R_{6} Rp1b s^{2} + C_{16} R_{24} R_{6} s + C_{16} R_{24} R_{7} s + C_{16} R_{24} Rp1b s + C_{3} C_{5} R_{24} R_{6} Rp1b s^{2} + C_{3} C_{5} R_{6} R_{7} Rp1b s^{2} + C_{3} R_{24} R_{6} s + C_{3} R_{24} Rp1b s + C_{3} R_{6} R_{7} s + C_{3} R_{7} Rp1b s + C_{5} R_{24} R_{6} s + C_{5} R_{6} R_{7} s + C_{5} R_{6} Rp1b s + R_{24} + R_{6} + R_{7} + Rp1b}\)</span><br><span class="math inline">\(v_{6} = 0\)</span><br><span class="math inline">\(I_{V1} = \frac{- C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} V_{1} s^{3} - C_{16} C_{3} C_{5} R_{24} R_{6} Rp1b V_{1} s^{3} - C_{16} C_{3} R_{24} R_{6} V_{1} s^{2} - C_{16} C_{3} R_{24} R_{7} V_{1} s^{2} - C_{16} C_{3} R_{24} Rp1b V_{1} s^{2} - C_{3} C_{5} R_{24} R_{6} V_{1} s^{2} - C_{3} C_{5} R_{6} R_{7} V_{1} s^{2} - C_{3} C_{5} R_{6} Rp1b V_{1} s^{2} - C_{3} R_{24} V_{1} s - C_{3} R_{6} V_{1} s - C_{3} R_{7} V_{1} s - C_{3} Rp1b V_{1} s}{C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b s^{3} + C_{16} C_{3} R_{24} R_{6} R_{7} s^{2} + C_{16} C_{3} R_{24} R_{7} Rp1b s^{2} + C_{16} C_{5} R_{24} R_{6} R_{7} s^{2} + C_{16} C_{5} R_{24} R_{6} Rp1b s^{2} + C_{16} R_{24} R_{6} s + C_{16} R_{24} R_{7} s + C_{16} R_{24} Rp1b s + C_{3} C_{5} R_{24} R_{6} Rp1b s^{2} + C_{3} C_{5} R_{6} R_{7} Rp1b s^{2} + C_{3} R_{24} R_{6} s + C_{3} R_{24} Rp1b s + C_{3} R_{6} R_{7} s + C_{3} R_{7} Rp1b s + C_{5} R_{24} R_{6} s + C_{5} R_{6} R_{7} s + C_{5} R_{6} Rp1b s + R_{24} + R_{6} + R_{7} + Rp1b}\)</span><br><span class="math inline">\(I_{O2a} = \frac{C_{3} C_{5} R_{6} Rp1b V_{1} s^{2} + C_{3} R_{6} V_{1} s + C_{3} Rp1b V_{1} s}{C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b s^{3} + C_{16} C_{3} R_{24} R_{6} R_{7} s^{2} + C_{16} C_{3} R_{24} R_{7} Rp1b s^{2} + C_{16} C_{5} R_{24} R_{6} R_{7} s^{2} + C_{16} C_{5} R_{24} R_{6} Rp1b s^{2} + C_{16} R_{24} R_{6} s + C_{16} R_{24} R_{7} s + C_{16} R_{24} Rp1b s + C_{3} C_{5} R_{24} R_{6} Rp1b s^{2} + C_{3} C_{5} R_{6} R_{7} Rp1b s^{2} + C_{3} R_{24} R_{6} s + C_{3} R_{24} Rp1b s + C_{3} R_{6} R_{7} s + C_{3} R_{7} Rp1b s + C_{5} R_{24} R_{6} s + C_{5} R_{6} R_{7} s + C_{5} R_{6} Rp1b s + R_{24} + R_{6} + R_{7} + Rp1b}\)</span><br></p>
</div>
</div>
<p>The network transfer function, <span class="math inline">\(H(s)=\frac {v_2(s)}{v_1(s)}\)</span> is:</p>
<div id="864276e7-fd55-48a9-a22a-ceedbc048cc0" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>H_sym <span class="op">=</span> (U_sym[v2]<span class="op">/</span>U_sym[v1]).cancel()</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'$H(s)=</span><span class="sc">{:s}</span><span class="st">$'</span>.<span class="bu">format</span>(latex(H_sym)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="9">
<p><span class="math inline">\(H(s)=\frac{- C_{3} C_{5} R_{20} R_{6} Rp1b s^{2} - C_{3} R_{20} R_{6} s - C_{3} R_{20} Rp1b s}{C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b s^{3} + C_{16} C_{3} R_{24} R_{6} R_{7} s^{2} + C_{16} C_{3} R_{24} R_{7} Rp1b s^{2} + C_{16} C_{5} R_{24} R_{6} R_{7} s^{2} + C_{16} C_{5} R_{24} R_{6} Rp1b s^{2} + C_{16} R_{24} R_{6} s + C_{16} R_{24} R_{7} s + C_{16} R_{24} Rp1b s + C_{3} C_{5} R_{24} R_{6} Rp1b s^{2} + C_{3} C_{5} R_{6} R_{7} Rp1b s^{2} + C_{3} R_{24} R_{6} s + C_{3} R_{24} Rp1b s + C_{3} R_{6} R_{7} s + C_{3} R_{7} Rp1b s + C_{5} R_{24} R_{6} s + C_{5} R_{6} R_{7} s + C_{5} R_{6} Rp1b s + R_{24} + R_{6} + R_{7} + Rp1b}\)</span></p>
</div>
</div>
<p>The numerator is a second order polynomial and the denominator is a third order polynomial. Generally, the order of the dominator is equal to the number of reactive elements in the circuit; sometimes roots of the numerator will exactly cancel with a root of the denominator polynomial. The roots of the numerator polynomial are called the zeros of the transfer function and the roots of the denominator are called the poles of the transfer function.</p>
<div id="a5bd3791-5d0d-4fc3-8535-2b902cc29c70" class="cell" data-tags="[]" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>H_sym_num, H_sym_denom <span class="op">=</span> fraction(H_sym,s) <span class="co">#returns numerator and denominator</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="numerator-polynomial-of-h_syms" class="level4" data-number="27.3.1.2">
<h4 data-number="27.3.1.2" class="anchored" data-anchor-id="numerator-polynomial-of-h_syms"><span class="header-section-number">27.3.1.2</span> Numerator Polynomial of <span class="math inline">\(H_{sym}(s)\)</span></h4>
<p>The numerator polynomial is:</p>
<div id="c38a16e3-a51e-4a51-bd5d-1a45eb54747f" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'$N(s)=</span><span class="sc">{:s}</span><span class="st">$'</span>.<span class="bu">format</span>(latex(H_sym_num)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="11">
<p><span class="math inline">\(N(s)=- C_{3} C_{5} R_{20} R_{6} Rp1b s^{2} - C_{3} R_{20} R_{6} s - C_{3} R_{20} Rp1b s\)</span></p>
</div>
</div>
<p>The coefficients of each Laplace term can be equated to the variables <span class="math inline">\(b_2\)</span>, <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_0\)</span> in the expression:</p>
<p><span class="math inline">\(b_2s^{2}+b_1s+b_0\)</span></p>
<p>where <span class="math inline">\(b_2\)</span>, <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_0\)</span> are:</p>
<div id="1b05387e-b215-46a4-b1fa-3da62bc68522" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>b2 <span class="op">=</span> H_sym_num.coeff(s<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>b1 <span class="op">=</span> H_sym_num.coeff(s<span class="op">**</span><span class="dv">1</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>b0 <span class="op">=</span> (H_sym_num <span class="op">-</span> b1<span class="op">*</span>s<span class="op">*</span><span class="dv">1</span> <span class="op">-</span> b2<span class="op">*</span>s<span class="op">**</span><span class="dv">2</span>).expand()</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'&lt;p&gt;$b_2=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;&lt;p&gt;$b_1=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;&lt;p&gt;$b_0=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;'</span>.<span class="bu">format</span>(latex(b2),latex(b1),latex(b0)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="12">
<p>
<span class="math inline">\(b_2=- C_{3} C_{5} R_{20} R_{6} Rp1b\)</span>
</p>
<p>
<span class="math inline">\(b_1=- C_{3} R_{20} R_{6} - C_{3} R_{20} Rp1b\)</span>
</p>
<p>
<span class="math inline">\(b_0=0\)</span>
</p>
</div>
</div>
<p>The roots of the numerator polynomial can easily be found with SymPy. This filter has two transmission zeros, which can be found using the <code>solve</code> function on the numerator polynomial.</p>
<div id="3946aa67-6ef3-420a-b5d5-1621349d1bdf" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>num_root_sym <span class="op">=</span> solve(H_sym_num,s)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'There are </span><span class="sc">{:d}</span><span class="st"> zeros, which are:</span><span class="op">\</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;p&gt;$z_0=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;&lt;p&gt;$z_1=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;'</span>.<span class="bu">format</span>(<span class="bu">len</span>(num_root_sym),latex(num_root_sym[<span class="dv">0</span>]),latex(num_root_sym[<span class="dv">1</span>])))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="13">
There are 2 zeros, which are:
<p>
<span class="math inline">\(z_0=0\)</span>
</p>
<p>
<span class="math inline">\(z_1=\frac{- R_{6} - Rp1b}{C_{5} R_{6} Rp1b}\)</span>
</p>
</div>
</div>
<p><span class="math inline">\(C_3\)</span> is responsible for the zero at <span class="math inline">\(\omega=0\)</span> since this capacitor provids an open circuit at DC.</p>
</section>
<section id="denominator-polynomial-of-h_syms" class="level4" data-number="27.3.1.3">
<h4 data-number="27.3.1.3" class="anchored" data-anchor-id="denominator-polynomial-of-h_syms"><span class="header-section-number">27.3.1.3</span> Denominator Polynomial of <span class="math inline">\(H_{sym}(s)\)</span></h4>
<p>The denominator polynomial of the transfer function is called the characteristic polynomial. The roots of the denominator, also called poles of the system, determine the system’s stability. If any of these roots have a positive real part, the system is unstable, meaning its output will grow unbounded. The roots also influence how the system responds to changes in input (the transient response). They affect things like how quickly the system settles to a new state, whether it oscillates, and the damping of those oscillations. Each root of the characteristic polynomial corresponds to a natural mode of the system.</p>
<p>The denominator polynomial is:</p>
<div id="984ef078-47bf-4688-bd23-a361b0896369" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'$D(s)=</span><span class="sc">{:s}</span><span class="st">$'</span>.<span class="bu">format</span>(latex(H_sym_denom)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="14">
<p><span class="math inline">\(D(s)=C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b s^{3} + C_{16} C_{3} R_{24} R_{6} R_{7} s^{2} + C_{16} C_{3} R_{24} R_{7} Rp1b s^{2} + C_{16} C_{5} R_{24} R_{6} R_{7} s^{2} + C_{16} C_{5} R_{24} R_{6} Rp1b s^{2} + C_{16} R_{24} R_{6} s + C_{16} R_{24} R_{7} s + C_{16} R_{24} Rp1b s + C_{3} C_{5} R_{24} R_{6} Rp1b s^{2} + C_{3} C_{5} R_{6} R_{7} Rp1b s^{2} + C_{3} R_{24} R_{6} s + C_{3} R_{24} Rp1b s + C_{3} R_{6} R_{7} s + C_{3} R_{7} Rp1b s + C_{5} R_{24} R_{6} s + C_{5} R_{6} R_{7} s + C_{5} R_{6} Rp1b s + R_{24} + R_{6} + R_{7} + Rp1b\)</span></p>
</div>
</div>
<p>The coefficients of each Laplace term can be equated to the variables <span class="math inline">\(a_3\)</span>, <span class="math inline">\(a_2\)</span>, <span class="math inline">\(a_1\)</span> and <span class="math inline">\(a_0\)</span> in the expression:</p>
<p><span class="math inline">\(a_3s^3+a_2s^2+a_1s+a_0\)</span></p>
<p>where <span class="math inline">\(a_3\)</span>, <span class="math inline">\(a_2\)</span>, <span class="math inline">\(a_1\)</span> and <span class="math inline">\(a_0\)</span> are:</p>
<div id="fe3be41c-062d-4543-9abd-b284b77c7b9c" class="cell" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>a3 <span class="op">=</span> H_sym_denom.coeff(s<span class="op">**</span><span class="dv">3</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>a2 <span class="op">=</span> H_sym_denom.coeff(s<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>a1 <span class="op">=</span> H_sym_denom.coeff(s<span class="op">**</span><span class="dv">1</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>a0 <span class="op">=</span> (H_sym_denom <span class="op">-</span> a1<span class="op">*</span>s<span class="op">*</span><span class="dv">1</span> <span class="op">-</span> a2<span class="op">*</span>s<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> a3<span class="op">*</span>s<span class="op">**</span><span class="dv">3</span>).expand()</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'&lt;p&gt;$a_3=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;&lt;p&gt;$a_2=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;&lt;p&gt;</span><span class="op">\</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="st">    $a_1=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;&lt;p&gt;$a_0=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;'</span>.<span class="bu">format</span>(latex(a3),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    latex(a2),latex(a1),latex(a0)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="15">
<p>
<span class="math inline">\(a_3=C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b\)</span>
</p>
<p>
<span class="math inline">\(a_2=C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\)</span>
</p>
<p>
<span class="math inline">\(a_1=C_{16} R_{24} R_{6} + C_{16} R_{24} R_{7} + C_{16} R_{24} Rp1b + C_{3} R_{24} R_{6} + C_{3} R_{24} Rp1b + C_{3} R_{6} R_{7} + C_{3} R_{7} Rp1b + C_{5} R_{24} R_{6} + C_{5} R_{6} R_{7} + C_{5} R_{6} Rp1b\)</span>
</p>
<p>
<span class="math inline">\(a_0=R_{24} + R_{6} + R_{7} + Rp1b\)</span>
</p>
</div>
</div>
<p>The roots of the denominator polynomial, which are the poles of the transfer function, can be found with SymPy.</p>
<div id="c4c0fc5f-d882-448d-a168-866cc45b9b1d" class="cell" data-execution_count="16">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>denom_root_sym <span class="op">=</span> solve(H_sym_denom,s)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'There are </span><span class="sc">{:d}</span><span class="st"> poles, which are:</span><span class="op">\</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;p&gt;$p_0=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;&lt;p&gt;$p_1=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;&lt;p&gt;$p_2=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;'</span>.<span class="bu">format</span>(<span class="bu">len</span>(denom_root_sym),latex(denom_root_sym[<span class="dv">0</span>]),latex(denom_root_sym[<span class="dv">1</span>]),latex(denom_root_sym[<span class="dv">2</span>])))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="16">
There are 3 poles, which are:
<p>
<span class="math inline">\(p_0=- \frac{- \frac{3 \left(C_{16} R_{24} R_{6} + C_{16} R_{24} R_{7} + C_{16} R_{24} Rp1b + C_{3} R_{24} R_{6} + C_{3} R_{24} Rp1b + C_{3} R_{6} R_{7} + C_{3} R_{7} Rp1b + C_{5} R_{24} R_{6} + C_{5} R_{6} R_{7} + C_{5} R_{6} Rp1b\right)}{C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b} + \frac{\left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right)^{2}}{C_{16}^{2} C_{3}^{2} C_{5}^{2} R_{24}^{2} R_{6}^{2} R_{7}^{2} Rp1b^{2}}}{3 \sqrt[3]{\frac{\sqrt{- 4 \left(- \frac{3 \left(C_{16} R_{24} R_{6} + C_{16} R_{24} R_{7} + C_{16} R_{24} Rp1b + C_{3} R_{24} R_{6} + C_{3} R_{24} Rp1b + C_{3} R_{6} R_{7} + C_{3} R_{7} Rp1b + C_{5} R_{24} R_{6} + C_{5} R_{6} R_{7} + C_{5} R_{6} Rp1b\right)}{C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b} + \frac{\left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right)^{2}}{C_{16}^{2} C_{3}^{2} C_{5}^{2} R_{24}^{2} R_{6}^{2} R_{7}^{2} Rp1b^{2}}\right)^{3} + \left(\frac{27 \left(R_{24} + R_{6} + R_{7} + Rp1b\right)}{C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b} - \frac{9 \left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right) \left(C_{16} R_{24} R_{6} + C_{16} R_{24} R_{7} + C_{16} R_{24} Rp1b + C_{3} R_{24} R_{6} + C_{3} R_{24} Rp1b + C_{3} R_{6} R_{7} + C_{3} R_{7} Rp1b + C_{5} R_{24} R_{6} + C_{5} R_{6} R_{7} + C_{5} R_{6} Rp1b\right)}{C_{16}^{2} C_{3}^{2} C_{5}^{2} R_{24}^{2} R_{6}^{2} R_{7}^{2} Rp1b^{2}} + \frac{2 \left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right)^{3}}{C_{16}^{3} C_{3}^{3} C_{5}^{3} R_{24}^{3} R_{6}^{3} R_{7}^{3} Rp1b^{3}}\right)^{2}}}{2} + \frac{27 \left(R_{24} + R_{6} + R_{7} + Rp1b\right)}{2 C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b} - \frac{9 \left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right) \left(C_{16} R_{24} R_{6} + C_{16} R_{24} R_{7} + C_{16} R_{24} Rp1b + C_{3} R_{24} R_{6} + C_{3} R_{24} Rp1b + C_{3} R_{6} R_{7} + C_{3} R_{7} Rp1b + C_{5} R_{24} R_{6} + C_{5} R_{6} R_{7} + C_{5} R_{6} Rp1b\right)}{2 C_{16}^{2} C_{3}^{2} C_{5}^{2} R_{24}^{2} R_{6}^{2} R_{7}^{2} Rp1b^{2}} + \frac{\left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right)^{3}}{C_{16}^{3} C_{3}^{3} C_{5}^{3} R_{24}^{3} R_{6}^{3} R_{7}^{3} Rp1b^{3}}}} - \frac{\sqrt[3]{\frac{\sqrt{- 4 \left(- \frac{3 \left(C_{16} R_{24} R_{6} + C_{16} R_{24} R_{7} + C_{16} R_{24} Rp1b + C_{3} R_{24} R_{6} + C_{3} R_{24} Rp1b + C_{3} R_{6} R_{7} + C_{3} R_{7} Rp1b + C_{5} R_{24} R_{6} + C_{5} R_{6} R_{7} + C_{5} R_{6} Rp1b\right)}{C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b} + \frac{\left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right)^{2}}{C_{16}^{2} C_{3}^{2} C_{5}^{2} R_{24}^{2} R_{6}^{2} R_{7}^{2} Rp1b^{2}}\right)^{3} + \left(\frac{27 \left(R_{24} + R_{6} + R_{7} + Rp1b\right)}{C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b} - \frac{9 \left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right) \left(C_{16} R_{24} R_{6} + C_{16} R_{24} R_{7} + C_{16} R_{24} Rp1b + C_{3} R_{24} R_{6} + C_{3} R_{24} Rp1b + C_{3} R_{6} R_{7} + C_{3} R_{7} Rp1b + C_{5} R_{24} R_{6} + C_{5} R_{6} R_{7} + C_{5} R_{6} Rp1b\right)}{C_{16}^{2} C_{3}^{2} C_{5}^{2} R_{24}^{2} R_{6}^{2} R_{7}^{2} Rp1b^{2}} + \frac{2 \left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right)^{3}}{C_{16}^{3} C_{3}^{3} C_{5}^{3} R_{24}^{3} R_{6}^{3} R_{7}^{3} Rp1b^{3}}\right)^{2}}}{2} + \frac{27 \left(R_{24} + R_{6} + R_{7} + Rp1b\right)}{2 C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b} - \frac{9 \left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right) \left(C_{16} R_{24} R_{6} + C_{16} R_{24} R_{7} + C_{16} R_{24} Rp1b + C_{3} R_{24} R_{6} + C_{3} R_{24} Rp1b + C_{3} R_{6} R_{7} + C_{3} R_{7} Rp1b + C_{5} R_{24} R_{6} + C_{5} R_{6} R_{7} + C_{5} R_{6} Rp1b\right)}{2 C_{16}^{2} C_{3}^{2} C_{5}^{2} R_{24}^{2} R_{6}^{2} R_{7}^{2} Rp1b^{2}} + \frac{\left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right)^{3}}{C_{16}^{3} C_{3}^{3} C_{5}^{3} R_{24}^{3} R_{6}^{3} R_{7}^{3} Rp1b^{3}}}}{3} - \frac{C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b}{3 C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b}\)</span>
</p>
<p>
<span class="math inline">\(p_1=- \frac{- \frac{3 \left(C_{16} R_{24} R_{6} + C_{16} R_{24} R_{7} + C_{16} R_{24} Rp1b + C_{3} R_{24} R_{6} + C_{3} R_{24} Rp1b + C_{3} R_{6} R_{7} + C_{3} R_{7} Rp1b + C_{5} R_{24} R_{6} + C_{5} R_{6} R_{7} + C_{5} R_{6} Rp1b\right)}{C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b} + \frac{\left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right)^{2}}{C_{16}^{2} C_{3}^{2} C_{5}^{2} R_{24}^{2} R_{6}^{2} R_{7}^{2} Rp1b^{2}}}{3 \left(- \frac{1}{2} - \frac{\sqrt{3} i}{2}\right) \sqrt[3]{\frac{\sqrt{- 4 \left(- \frac{3 \left(C_{16} R_{24} R_{6} + C_{16} R_{24} R_{7} + C_{16} R_{24} Rp1b + C_{3} R_{24} R_{6} + C_{3} R_{24} Rp1b + C_{3} R_{6} R_{7} + C_{3} R_{7} Rp1b + C_{5} R_{24} R_{6} + C_{5} R_{6} R_{7} + C_{5} R_{6} Rp1b\right)}{C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b} + \frac{\left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right)^{2}}{C_{16}^{2} C_{3}^{2} C_{5}^{2} R_{24}^{2} R_{6}^{2} R_{7}^{2} Rp1b^{2}}\right)^{3} + \left(\frac{27 \left(R_{24} + R_{6} + R_{7} + Rp1b\right)}{C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b} - \frac{9 \left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right) \left(C_{16} R_{24} R_{6} + C_{16} R_{24} R_{7} + C_{16} R_{24} Rp1b + C_{3} R_{24} R_{6} + C_{3} R_{24} Rp1b + C_{3} R_{6} R_{7} + C_{3} R_{7} Rp1b + C_{5} R_{24} R_{6} + C_{5} R_{6} R_{7} + C_{5} R_{6} Rp1b\right)}{C_{16}^{2} C_{3}^{2} C_{5}^{2} R_{24}^{2} R_{6}^{2} R_{7}^{2} Rp1b^{2}} + \frac{2 \left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right)^{3}}{C_{16}^{3} C_{3}^{3} C_{5}^{3} R_{24}^{3} R_{6}^{3} R_{7}^{3} Rp1b^{3}}\right)^{2}}}{2} + \frac{27 \left(R_{24} + R_{6} + R_{7} + Rp1b\right)}{2 C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b} - \frac{9 \left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right) \left(C_{16} R_{24} R_{6} + C_{16} R_{24} R_{7} + C_{16} R_{24} Rp1b + C_{3} R_{24} R_{6} + C_{3} R_{24} Rp1b + C_{3} R_{6} R_{7} + C_{3} R_{7} Rp1b + C_{5} R_{24} R_{6} + C_{5} R_{6} R_{7} + C_{5} R_{6} Rp1b\right)}{2 C_{16}^{2} C_{3}^{2} C_{5}^{2} R_{24}^{2} R_{6}^{2} R_{7}^{2} Rp1b^{2}} + \frac{\left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right)^{3}}{C_{16}^{3} C_{3}^{3} C_{5}^{3} R_{24}^{3} R_{6}^{3} R_{7}^{3} Rp1b^{3}}}} - \frac{\left(- \frac{1}{2} - \frac{\sqrt{3} i}{2}\right) \sqrt[3]{\frac{\sqrt{- 4 \left(- \frac{3 \left(C_{16} R_{24} R_{6} + C_{16} R_{24} R_{7} + C_{16} R_{24} Rp1b + C_{3} R_{24} R_{6} + C_{3} R_{24} Rp1b + C_{3} R_{6} R_{7} + C_{3} R_{7} Rp1b + C_{5} R_{24} R_{6} + C_{5} R_{6} R_{7} + C_{5} R_{6} Rp1b\right)}{C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b} + \frac{\left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right)^{2}}{C_{16}^{2} C_{3}^{2} C_{5}^{2} R_{24}^{2} R_{6}^{2} R_{7}^{2} Rp1b^{2}}\right)^{3} + \left(\frac{27 \left(R_{24} + R_{6} + R_{7} + Rp1b\right)}{C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b} - \frac{9 \left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right) \left(C_{16} R_{24} R_{6} + C_{16} R_{24} R_{7} + C_{16} R_{24} Rp1b + C_{3} R_{24} R_{6} + C_{3} R_{24} Rp1b + C_{3} R_{6} R_{7} + C_{3} R_{7} Rp1b + C_{5} R_{24} R_{6} + C_{5} R_{6} R_{7} + C_{5} R_{6} Rp1b\right)}{C_{16}^{2} C_{3}^{2} C_{5}^{2} R_{24}^{2} R_{6}^{2} R_{7}^{2} Rp1b^{2}} + \frac{2 \left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right)^{3}}{C_{16}^{3} C_{3}^{3} C_{5}^{3} R_{24}^{3} R_{6}^{3} R_{7}^{3} Rp1b^{3}}\right)^{2}}}{2} + \frac{27 \left(R_{24} + R_{6} + R_{7} + Rp1b\right)}{2 C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b} - \frac{9 \left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right) \left(C_{16} R_{24} R_{6} + C_{16} R_{24} R_{7} + C_{16} R_{24} Rp1b + C_{3} R_{24} R_{6} + C_{3} R_{24} Rp1b + C_{3} R_{6} R_{7} + C_{3} R_{7} Rp1b + C_{5} R_{24} R_{6} + C_{5} R_{6} R_{7} + C_{5} R_{6} Rp1b\right)}{2 C_{16}^{2} C_{3}^{2} C_{5}^{2} R_{24}^{2} R_{6}^{2} R_{7}^{2} Rp1b^{2}} + \frac{\left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right)^{3}}{C_{16}^{3} C_{3}^{3} C_{5}^{3} R_{24}^{3} R_{6}^{3} R_{7}^{3} Rp1b^{3}}}}{3} - \frac{C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b}{3 C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b}\)</span>
</p>
<p>
<span class="math inline">\(p_2=- \frac{- \frac{3 \left(C_{16} R_{24} R_{6} + C_{16} R_{24} R_{7} + C_{16} R_{24} Rp1b + C_{3} R_{24} R_{6} + C_{3} R_{24} Rp1b + C_{3} R_{6} R_{7} + C_{3} R_{7} Rp1b + C_{5} R_{24} R_{6} + C_{5} R_{6} R_{7} + C_{5} R_{6} Rp1b\right)}{C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b} + \frac{\left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right)^{2}}{C_{16}^{2} C_{3}^{2} C_{5}^{2} R_{24}^{2} R_{6}^{2} R_{7}^{2} Rp1b^{2}}}{3 \left(- \frac{1}{2} + \frac{\sqrt{3} i}{2}\right) \sqrt[3]{\frac{\sqrt{- 4 \left(- \frac{3 \left(C_{16} R_{24} R_{6} + C_{16} R_{24} R_{7} + C_{16} R_{24} Rp1b + C_{3} R_{24} R_{6} + C_{3} R_{24} Rp1b + C_{3} R_{6} R_{7} + C_{3} R_{7} Rp1b + C_{5} R_{24} R_{6} + C_{5} R_{6} R_{7} + C_{5} R_{6} Rp1b\right)}{C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b} + \frac{\left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right)^{2}}{C_{16}^{2} C_{3}^{2} C_{5}^{2} R_{24}^{2} R_{6}^{2} R_{7}^{2} Rp1b^{2}}\right)^{3} + \left(\frac{27 \left(R_{24} + R_{6} + R_{7} + Rp1b\right)}{C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b} - \frac{9 \left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right) \left(C_{16} R_{24} R_{6} + C_{16} R_{24} R_{7} + C_{16} R_{24} Rp1b + C_{3} R_{24} R_{6} + C_{3} R_{24} Rp1b + C_{3} R_{6} R_{7} + C_{3} R_{7} Rp1b + C_{5} R_{24} R_{6} + C_{5} R_{6} R_{7} + C_{5} R_{6} Rp1b\right)}{C_{16}^{2} C_{3}^{2} C_{5}^{2} R_{24}^{2} R_{6}^{2} R_{7}^{2} Rp1b^{2}} + \frac{2 \left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right)^{3}}{C_{16}^{3} C_{3}^{3} C_{5}^{3} R_{24}^{3} R_{6}^{3} R_{7}^{3} Rp1b^{3}}\right)^{2}}}{2} + \frac{27 \left(R_{24} + R_{6} + R_{7} + Rp1b\right)}{2 C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b} - \frac{9 \left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right) \left(C_{16} R_{24} R_{6} + C_{16} R_{24} R_{7} + C_{16} R_{24} Rp1b + C_{3} R_{24} R_{6} + C_{3} R_{24} Rp1b + C_{3} R_{6} R_{7} + C_{3} R_{7} Rp1b + C_{5} R_{24} R_{6} + C_{5} R_{6} R_{7} + C_{5} R_{6} Rp1b\right)}{2 C_{16}^{2} C_{3}^{2} C_{5}^{2} R_{24}^{2} R_{6}^{2} R_{7}^{2} Rp1b^{2}} + \frac{\left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right)^{3}}{C_{16}^{3} C_{3}^{3} C_{5}^{3} R_{24}^{3} R_{6}^{3} R_{7}^{3} Rp1b^{3}}}} - \frac{\left(- \frac{1}{2} + \frac{\sqrt{3} i}{2}\right) \sqrt[3]{\frac{\sqrt{- 4 \left(- \frac{3 \left(C_{16} R_{24} R_{6} + C_{16} R_{24} R_{7} + C_{16} R_{24} Rp1b + C_{3} R_{24} R_{6} + C_{3} R_{24} Rp1b + C_{3} R_{6} R_{7} + C_{3} R_{7} Rp1b + C_{5} R_{24} R_{6} + C_{5} R_{6} R_{7} + C_{5} R_{6} Rp1b\right)}{C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b} + \frac{\left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right)^{2}}{C_{16}^{2} C_{3}^{2} C_{5}^{2} R_{24}^{2} R_{6}^{2} R_{7}^{2} Rp1b^{2}}\right)^{3} + \left(\frac{27 \left(R_{24} + R_{6} + R_{7} + Rp1b\right)}{C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b} - \frac{9 \left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right) \left(C_{16} R_{24} R_{6} + C_{16} R_{24} R_{7} + C_{16} R_{24} Rp1b + C_{3} R_{24} R_{6} + C_{3} R_{24} Rp1b + C_{3} R_{6} R_{7} + C_{3} R_{7} Rp1b + C_{5} R_{24} R_{6} + C_{5} R_{6} R_{7} + C_{5} R_{6} Rp1b\right)}{C_{16}^{2} C_{3}^{2} C_{5}^{2} R_{24}^{2} R_{6}^{2} R_{7}^{2} Rp1b^{2}} + \frac{2 \left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right)^{3}}{C_{16}^{3} C_{3}^{3} C_{5}^{3} R_{24}^{3} R_{6}^{3} R_{7}^{3} Rp1b^{3}}\right)^{2}}}{2} + \frac{27 \left(R_{24} + R_{6} + R_{7} + Rp1b\right)}{2 C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b} - \frac{9 \left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right) \left(C_{16} R_{24} R_{6} + C_{16} R_{24} R_{7} + C_{16} R_{24} Rp1b + C_{3} R_{24} R_{6} + C_{3} R_{24} Rp1b + C_{3} R_{6} R_{7} + C_{3} R_{7} Rp1b + C_{5} R_{24} R_{6} + C_{5} R_{6} R_{7} + C_{5} R_{6} Rp1b\right)}{2 C_{16}^{2} C_{3}^{2} C_{5}^{2} R_{24}^{2} R_{6}^{2} R_{7}^{2} Rp1b^{2}} + \frac{\left(C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b\right)^{3}}{C_{16}^{3} C_{3}^{3} C_{5}^{3} R_{24}^{3} R_{6}^{3} R_{7}^{3} Rp1b^{3}}}}{3} - \frac{C_{16} C_{3} R_{24} R_{6} R_{7} + C_{16} C_{3} R_{24} R_{7} Rp1b + C_{16} C_{5} R_{24} R_{6} R_{7} + C_{16} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{24} R_{6} Rp1b + C_{3} C_{5} R_{6} R_{7} Rp1b}{3 C_{16} C_{3} C_{5} R_{24} R_{6} R_{7} Rp1b}\)</span>
</p>
</div>
</div>
<p>The expressions for the poles of <span class="math inline">\(H(s)\)</span> are rather long and not very intuitive.</p>
</section>
<section id="numerical-solution-for-p1-at-50" class="level4" data-number="27.3.1.4">
<h4 data-number="27.3.1.4" class="anchored" data-anchor-id="numerical-solution-for-p1-at-50"><span class="header-section-number">27.3.1.4</span> Numerical Solution for P1 at 50%</h4>
<p>The network equations can be numerically solved when the element values are included in the calculations. The solution below is for when <span class="math inline">\(R_{p1b1}\)</span> is set to 50%.</p>
<div id="01a32927-e076-40df-ab73-a8d62c69408c" class="cell" data-execution_count="17">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>equ_N <span class="op">=</span> NE_sym.subs(element_values)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We get the following numerical network equations:</p>
<div id="463f04ce-8400-4fc9-8dbe-5ecaabc320a2" class="cell" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> <span class="st">''</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(shape(equ_N.lhs)[<span class="dv">0</span>]):</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    temp <span class="op">+=</span> <span class="st">'&lt;p&gt;$</span><span class="sc">{:s}</span><span class="st"> = </span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;'</span>.<span class="bu">format</span>(latex(equ_N.rhs[i]),</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>        latex(round_expr(equ_N.lhs[i],<span class="dv">8</span>)))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>Markdown(temp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="18">
<p>
<span class="math inline">\(0 = I_{V1} + 1.0 \cdot 10^{-7} s v_{1} - 1.0 \cdot 10^{-7} s v_{3}\)</span>
</p>
<p>
<span class="math inline">\(0 = I_{O2a} + 2.55 \cdot 10^{-6} v_{2} - 2.55 \cdot 10^{-6} v_{6}\)</span>
</p>
<p>
<span class="math inline">\(0 = - 1.0 \cdot 10^{-7} s v_{1} + v_{3} \cdot \left(1.7 \cdot 10^{-7} s + 0.00076667\right) + v_{4} \left(- 7.0 \cdot 10^{-8} s - 0.0001\right) - 0.00066667 v_{5}\)</span>
</p>
<p>
<span class="math inline">\(0 = v_{3} \left(- 7.0 \cdot 10^{-8} s - 0.0001\right) + v_{4} \cdot \left(7.0 \cdot 10^{-8} s + 0.00012\right)\)</span>
</p>
<p>
<span class="math inline">\(0 = - 0.00066667 v_{3} + v_{5} \cdot \left(1.0 \cdot 10^{-6} s + 0.00073333\right) - 6.667 \cdot 10^{-5} v_{6}\)</span>
</p>
<p>
<span class="math inline">\(0 = - 2.55 \cdot 10^{-6} v_{2} - 6.667 \cdot 10^{-5} v_{5} + 6.922 \cdot 10^{-5} v_{6}\)</span>
</p>
<p>
<span class="math inline">\(1.0 = v_{1}\)</span>
</p>
<p>
<span class="math inline">\(0 = v_{6}\)</span>
</p>
</div>
</div>
<p>SymPy can solve for unknown node voltages and the unknown currents from the independent voltage source, <span class="math inline">\(V_1\)</span>, and the Op Amp’s output terminal. The unknown currents, <span class="math inline">\(I_{V1}\)</span> and <span class="math inline">\(I_{O1}\)</span>, are not displayed. The node voltages are:</p>
<div id="aacd5527-cc81-405a-81a2-8c49f9764225" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;jupyter&quot;,&quot;value&quot;:{&quot;outputs_hidden&quot;:false}}" data-execution_count="19">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>U <span class="op">=</span> solve(equ_N,X)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> <span class="st">''</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> U.keys():</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">str</span>(i)[<span class="dv">0</span>] <span class="op">==</span> <span class="st">'v'</span>: <span class="co"># only display the node voltages</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>        temp <span class="op">+=</span> <span class="st">'&lt;p&gt;$</span><span class="sc">{:s}</span><span class="st"> = </span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;'</span>.<span class="bu">format</span>(latex(i),latex(U[i]))</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>Markdown(temp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="19">
<p>
<span class="math inline">\(v_{1} = 1.0\)</span>
</p>
<p>
<span class="math inline">\(v_{2} = \frac{- 2.6656 \cdot 10^{29} s^{2} - 4.704 \cdot 10^{32} s}{1.53 \cdot 10^{25} s^{3} + 1.4328 \cdot 10^{29} s^{2} + 2.13344 \cdot 10^{32} s + 1.53 \cdot 10^{34}}\)</span>
</p>
<p>
<span class="math inline">\(v_{3} = \frac{1.53 \cdot 10^{25} s^{3} + 3.822 \cdot 10^{28} s^{2} + 1.98 \cdot 10^{31} s}{1.53 \cdot 10^{25} s^{3} + 1.4328 \cdot 10^{29} s^{2} + 2.13344 \cdot 10^{32} s + 1.53 \cdot 10^{34}}\)</span>
</p>
<p>
<span class="math inline">\(v_{4} = \frac{1.53 \cdot 10^{25} s^{3} + 3.372 \cdot 10^{28} s^{2} + 1.65 \cdot 10^{31} s}{1.53 \cdot 10^{25} s^{3} + 1.4328 \cdot 10^{29} s^{2} + 2.13344 \cdot 10^{32} s + 1.53 \cdot 10^{34}}\)</span>
</p>
<p>
<span class="math inline">\(v_{5} = \frac{1.02 \cdot 10^{28} s^{2} + 1.8 \cdot 10^{31} s}{1.53 \cdot 10^{25} s^{3} + 1.4328 \cdot 10^{29} s^{2} + 2.13344 \cdot 10^{32} s + 1.53 \cdot 10^{34}}\)</span>
</p>
<p>
<span class="math inline">\(v_{6} = 0.0\)</span>
</p>
</div>
</div>
<p>The network transfer function, <span class="math inline">\(H(s)=\frac {v_2(s)}{v_1(s)}\)</span>, is:</p>
<div id="433b8ee5-d033-4c12-9a49-649baf730b6f" class="cell" data-execution_count="20">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>H <span class="op">=</span> (U[v2]<span class="op">/</span>U[v1]).cancel()</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'$H(s)=</span><span class="sc">{:s}</span><span class="st">$'</span>.<span class="bu">format</span>(latex(H)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="20">
<p><span class="math inline">\(H(s)=\frac{- 2.6656 \cdot 10^{29} s^{2} - 4.704 \cdot 10^{32} s}{1.53 \cdot 10^{25} s^{3} + 1.4328 \cdot 10^{29} s^{2} + 2.13344 \cdot 10^{32} s + 1.53 \cdot 10^{34}}\)</span></p>
</div>
</div>
<p>The SciPy function, <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.TransferFunction.html">TransferFunction</a>, is used to represent the system as the continuous-time transfer function. The code below extracts the numerator and denominator polynomials from the voltage transfer function. Then coefficients of the terms are used to build a SciPy transfer function object.</p>
<div id="9907a78b-7e34-4f9f-91cd-2689bf965303" class="cell" data-execution_count="21">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>H_num, H_denom <span class="op">=</span> fraction(H) <span class="co">#returns numerator and denominator</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert symbolic to NumPy polynomial</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array(Poly(H_num, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array(Poly(H_denom, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>sys_tf <span class="op">=</span> signal.TransferFunction(a,b)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="pole-zero-plot" class="level4" data-number="27.3.1.5">
<h4 data-number="27.3.1.5" class="anchored" data-anchor-id="pole-zero-plot"><span class="header-section-number">27.3.1.5</span> Pole Zero Plot</h4>
<p>The poles and zeros of the transfer function can easily be obtained with the following code:</p>
<div id="83cbe9b4-5bb1-4b96-84d2-d3063c1074d4" class="cell" data-execution_count="22">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>sys_zeros <span class="op">=</span> np.roots(sys_tf.num)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>sys_poles <span class="op">=</span> np.roots(sys_tf.den)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The poles and zeros of the transfer function are plotted on the complex frequency plane with the following code:</p>
<div id="e194a239-dc28-40b8-bbc3-6a4aa74cc11f" class="cell" data-execution_count="23">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>plt.plot(np.real(sys_zeros<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)), np.imag(sys_zeros<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)), <span class="st">'ob'</span>,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    markerfacecolor<span class="op">=</span><span class="st">'none'</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>plt.plot(np.real(sys_poles<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)), np.imag(sys_poles<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)), <span class="st">'xr'</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">'Zeros'</span>, <span class="st">'Poles'</span>], loc<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Pole / Zero Plot'</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'real part, </span><span class="ch">\u03B1</span><span class="st">'</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'imaginary part, j</span><span class="ch">\u03C9</span><span class="st">'</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Klon Centaur part 3v1_files/figure-html/cell-24-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The code below generates a table that lists the values of the pole and zero locations.</p>
<div id="60e59547-b3c5-4246-881f-7d4fc7d273a3" class="cell" data-execution_count="24">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>table_header <span class="op">=</span> [<span class="st">'Zeros, Hz'</span>, <span class="st">'Poles, Hz'</span>]</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>num_table_rows <span class="op">=</span> <span class="bu">max</span>(<span class="bu">len</span>(sys_zeros),<span class="bu">len</span>(sys_poles))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>table_row <span class="op">=</span> []</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_table_rows):</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">&lt;</span> <span class="bu">len</span>(sys_zeros):</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>        z <span class="op">=</span> <span class="st">'</span><span class="sc">{:.2f}</span><span class="st">'</span>.<span class="bu">format</span>(sys_zeros[i]<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi))</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>        z <span class="op">=</span> <span class="st">''</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">&lt;</span> <span class="bu">len</span>(sys_poles):</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>        p <span class="op">=</span> <span class="st">'</span><span class="sc">{:.2f}</span><span class="st">'</span>.<span class="bu">format</span>(sys_poles[i]<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi))</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>        p <span class="op">=</span> <span class="st">''</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    table_row.append([z,p])</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tabulate(table_row, headers<span class="op">=</span>table_header,colalign <span class="op">=</span> (<span class="st">'left'</span>,<span class="st">'left'</span>),tablefmt<span class="op">=</span><span class="st">"simple"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Zeros, Hz    Poles, Hz
-----------  -----------
-280.86      -1198.55
0.00         -279.87
             -12.02</code></pre>
</div>
</div>
</section>
<section id="reactive-branch-1-frequency-response" class="level4" data-number="27.3.1.6">
<h4 data-number="27.3.1.6" class="anchored" data-anchor-id="reactive-branch-1-frequency-response"><span class="header-section-number">27.3.1.6</span> Reactive Branch 1 Frequency Response</h4>
<p>The transfer function <span class="math inline">\(H(s)=\frac{v2}{v1}\)</span> is analyzed for various settings of the Gain control, P1. The gain setting is in steps of percentage of full scale, from 1 to 99% and is plotted below.</p>
<div id="90a92971-fe13-49d8-b4f6-3d1f13d8f88c" class="cell" data-execution_count="25">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># setup</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>x_axis <span class="op">=</span> np.logspace(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">2000</span>, endpoint<span class="op">=</span><span class="va">True</span>)<span class="op">*</span><span class="dv">2</span><span class="op">*</span>np.pi</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>color_list <span class="op">=</span> [<span class="st">'tab:blue'</span>,<span class="st">'tab:purple'</span>,<span class="st">'tab:brown'</span>,<span class="st">'tab:red'</span>,<span class="st">'tab:green'</span>,<span class="st">'tab:orange'</span>,<span class="st">'k'</span>]</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>gain_setting <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="fl">2.5</span>,<span class="fl">9.75</span>,<span class="dv">25</span>,<span class="dv">50</span>,<span class="dv">75</span>,<span class="dv">99</span>])<span class="op">/</span><span class="dv">100</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>p1_value <span class="op">=</span> <span class="fl">100e3</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>fig, ax1 <span class="op">=</span> plt.subplots()</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'magnitude, dB'</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'frequency, Hz'</span>)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="co"># instantiate a second y-axes that shares the same x-axis</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> ax1.twinx()</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>color <span class="op">=</span> <span class="st">'k'</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'phase, deg'</span>,color<span class="op">=</span>color)</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>ax2.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelcolor<span class="op">=</span>color)</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(gain_setting)):</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    element_values[Rp1b] <span class="op">=</span> p1_value <span class="op">-</span> gain_setting[i]<span class="op">*</span>p1_value</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>    NE <span class="op">=</span> NE_sym.subs(element_values)</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>    U <span class="op">=</span> solve(NE,X)</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>    H <span class="op">=</span> U[v2]<span class="op">/</span>U[v1] <span class="co">#U[v2]/U[v1]</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>    num, denom <span class="op">=</span> fraction(H) <span class="co">#returns numerator and denominator</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># convert symbolic to NumPy polynomial</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> np.array(Poly(num, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> np.array(Poly(denom, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>    sys <span class="op">=</span> (a, b)</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">#x = np.logspace(1, 5, 2000, endpoint=False)*2*np.pi</span></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>    w, mag, phase <span class="op">=</span> signal.bode(sys, w<span class="op">=</span>x_axis) <span class="co"># returns: rad/s, mag in dB, phase in deg</span></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot the results.  </span></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>    ax1.semilogx(w<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi), mag,<span class="st">'-'</span>,color<span class="op">=</span>color_list[i],label<span class="op">=</span><span class="st">'magnitude @ </span><span class="sc">{:.0f}% g</span><span class="st">ain'</span>.<span class="bu">format</span>(gain_setting[i]<span class="op">*</span><span class="dv">100</span>)) <span class="co"># magnitude plot</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>    ax2.semilogx(w<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi), phase,<span class="st">':'</span>,color<span class="op">=</span>color_list[i],label<span class="op">=</span><span class="st">'phase @ </span><span class="sc">{:.0f}% g</span><span class="st">ain'</span>.<span class="bu">format</span>(gain_setting[i]<span class="op">*</span><span class="dv">100</span>)) <span class="co"># phase plot</span></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a><span class="co"># highlight the guitar audio band, 80 to 8kHz</span></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>plt.axvspan(<span class="dv">80</span>, <span class="fl">8e3</span>, color<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>) </span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a><span class="co"># set plot limits for display</span></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>plt.xlim((<span class="dv">1</span>,<span class="fl">100e3</span>))</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>ax1.set_ylim((<span class="op">-</span><span class="dv">60</span>,<span class="dv">10</span>))</span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a><span class="co"># position legends outside the graph</span></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>ax1.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.6</span>,<span class="dv">1</span>)) <span class="co"># magnitude legend position: relative (horizontal position, vertical position) </span></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>ax2.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.6</span>,<span class="fl">0.5</span>)) <span class="co"># phase legend position:</span></span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>ax1.grid()</span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Magnitude and phase response for gains of 1% to 99%'</span>)</span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Klon Centaur part 3v1_files/figure-html/cell-26-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The plot above shows the band pass characteristic of the circuit in <a href="#fig-reactive_branch_1_sch" class="quarto-xref">Figure&nbsp;<span>27.1</span></a>. The highlighted frequencies are the guitar audio band. Rotation of <span class="math inline">\(P_{1B}\)</span> has a limited effect in this path. Keep in mind that a pole at 500 Hz from <span class="math inline">\(C_{13}\)</span> is not included which would move the low pass corner frequency considerably lower if it was included.</p>
</section>
</section>
<section id="sec-reactive_branch_2" class="level3" data-number="27.3.2">
<h3 data-number="27.3.2" class="anchored" data-anchor-id="sec-reactive_branch_2"><span class="header-section-number">27.3.2</span> Reactive Branch 2</h3>
<p>The circuit shown below is reactive branch 2. This circuit is part of the circuit path analyzed in <a href="Klon Centaur part 1.html#sec-Distortion_path_part_A" class="quarto-xref"><span>Section 25.10.3</span></a> and is a slightly modified version of the highlighted portion of circuit shown in <a href="Klon Centaur part 1.html#fig-klon-centaur-schematic-high-res_w_diode_path1_highlight_sch" class="quarto-xref">Figure&nbsp;<span>25.19</span></a>.</p>
<div id="fig-reactive_branch_2_sch" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-reactive_branch_2_sch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="reactive_branch_2.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-reactive_branch_2_sch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;27.2: Schematic of reactive branch 2.
</figcaption>
</figure>
</div>
<p>The schematic above includes the components that are in the feed back loop around U1B. <span class="math inline">\(P_1\)</span> is modeled by two resistors, Rp1a1 and Rp1b1. The wiper of P1 is connected to ground. When <span class="math inline">\(P_1\)</span> fully clockwise, <span class="math inline">\(V_1\)</span> is shunted by the full value of <span class="math inline">\(P_1\)</span>, which is 100 k<span class="math inline">\(\Omega\)</span>, and node 3 is effectively connected to ground. When <span class="math inline">\(P_1\)</span> is fully counter clockwise, the wiper, which is connected to ground is effectively grounding <span class="math inline">\(V_1\)</span> and the non-inverting terminal of <span class="math inline">\(U_{1B}\)</span>, which prevents the signal from propagating to <span class="math inline">\(U_{1B}\)</span>.</p>
<p>The parallel combination of <span class="math inline">\(C_8\)</span> and <span class="math inline">\(R_{12}\)</span> along with <span class="math inline">\(C_7\)</span> and <span class="math inline">\(R_{11}\)</span> determine the frequency response. The netlist below was exported from LTSpice.</p>
<div id="1d655b90-3d07-4182-9e7d-35039d5de719" class="cell" data-execution_count="26">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>reactive_branch_2_net_list <span class="op">=</span> <span class="st">'''</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="st">*reactive_branch_2.asc</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="st">V1 1 0 1</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="st">Rp1b1 0 1 50e3</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="st">Rp1a1 3 0 50e3</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="st">R10 4 3 2e3</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="st">R11 5 4 15e3</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="st">C7 5 4 82e-9</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="st">C8 2 5 390e-12</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="st">R12 2 5 422e3</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="st">O1B 5 1 2</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="st">'''</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Using the function <code>SymMNA.smna</code> generate the network equations from the MNA matrices and display the equations.</p>
<div id="17567373-1336-4c32-a99d-0ad9017e5bc5" class="cell" data-execution_count="27">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>report, network_df, i_unk_df, A, X, Z <span class="op">=</span> SymMNA.smna(reactive_branch_2_net_list)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Put matrices into SymPy </span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> Matrix(X)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> Matrix(Z)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>NE_sym <span class="op">=</span> Eq(A<span class="op">*</span>X,Z)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co"># display the equations</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> <span class="st">''</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(shape(NE_sym.lhs)[<span class="dv">0</span>]):</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    temp <span class="op">+=</span> <span class="st">'$</span><span class="sc">{:s}</span><span class="st"> = </span><span class="sc">{:s}</span><span class="st">$&lt;br&gt;'</span>.<span class="bu">format</span>(latex(NE_sym.rhs[i]),latex(NE_sym.lhs[i]))</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>Markdown(temp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="27">
<p><span class="math inline">\(0 = I_{V1} + \frac{v_{1}}{Rp1b1}\)</span><br><span class="math inline">\(0 = I_{O1b} + v_{2} \left(C_{8} s + \frac{1}{R_{12}}\right) + v_{5} \left(- C_{8} s - \frac{1}{R_{12}}\right)\)</span><br><span class="math inline">\(0 = v_{3} \cdot \left(\frac{1}{Rp1a1} + \frac{1}{R_{10}}\right) - \frac{v_{4}}{R_{10}}\)</span><br><span class="math inline">\(0 = v_{4} \left(C_{7} s + \frac{1}{R_{11}} + \frac{1}{R_{10}}\right) + v_{5} \left(- C_{7} s - \frac{1}{R_{11}}\right) - \frac{v_{3}}{R_{10}}\)</span><br><span class="math inline">\(0 = v_{2} \left(- C_{8} s - \frac{1}{R_{12}}\right) + v_{4} \left(- C_{7} s - \frac{1}{R_{11}}\right) + v_{5} \left(C_{7} s + C_{8} s + \frac{1}{R_{12}} + \frac{1}{R_{11}}\right)\)</span><br><span class="math inline">\(V_{1} = v_{1}\)</span><br><span class="math inline">\(0 = - v_{1} + v_{5}\)</span><br></p>
</div>
</div>
<p>Turn the free symbols into SymPy variables and load the element values.</p>
<div id="24ee1a1f-cae4-45c9-a772-932bfb780e48" class="cell" data-execution_count="28">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>var(<span class="bu">str</span>(NE_sym.free_symbols).replace(<span class="st">'{'</span>,<span class="st">''</span>).replace(<span class="st">'}'</span>,<span class="st">''</span>))</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>element_values <span class="op">=</span> SymMNA.get_part_values(network_df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="symbolic-solution-1" class="level4" data-number="27.3.2.1">
<h4 data-number="27.3.2.1" class="anchored" data-anchor-id="symbolic-solution-1"><span class="header-section-number">27.3.2.1</span> Symbolic solution</h4>
<p>The network equations for the circuit in <a href="#fig-reactive_branch_2_sch" class="quarto-xref">Figure&nbsp;<span>27.2</span></a> can be solved symbolically.</p>
<div id="b4055aeb-2514-4213-b4c1-f014a818b666" class="cell" data-execution_count="29">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>U_sym <span class="op">=</span> solve(NE_sym,X)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Display the symbolic solution.</p>
<div id="6fd940ac-b283-435f-86a0-19860a0b69f6" class="cell" data-execution_count="30">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> <span class="st">''</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> U_sym.keys():</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    temp <span class="op">+=</span> <span class="st">'$</span><span class="sc">{:s}</span><span class="st"> = </span><span class="sc">{:s}</span><span class="st">$&lt;br&gt;'</span>.<span class="bu">format</span>(latex(i),latex(U_sym[i]))</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>Markdown(temp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="30">
<p><span class="math inline">\(v_{1} = V_{1}\)</span><br><span class="math inline">\(v_{2} = \frac{C_{7} C_{8} R_{10} R_{11} R_{12} V_{1} s^{2} + C_{7} C_{8} R_{11} R_{12} Rp1a1 V_{1} s^{2} + C_{7} R_{10} R_{11} V_{1} s + C_{7} R_{11} R_{12} V_{1} s + C_{7} R_{11} Rp1a1 V_{1} s + C_{8} R_{10} R_{12} V_{1} s + C_{8} R_{11} R_{12} V_{1} s + C_{8} R_{12} Rp1a1 V_{1} s + R_{10} V_{1} + R_{11} V_{1} + R_{12} V_{1} + Rp1a1 V_{1}}{C_{7} C_{8} R_{10} R_{11} R_{12} s^{2} + C_{7} C_{8} R_{11} R_{12} Rp1a1 s^{2} + C_{7} R_{10} R_{11} s + C_{7} R_{11} Rp1a1 s + C_{8} R_{10} R_{12} s + C_{8} R_{11} R_{12} s + C_{8} R_{12} Rp1a1 s + R_{10} + R_{11} + Rp1a1}\)</span><br><span class="math inline">\(v_{3} = \frac{C_{7} R_{11} Rp1a1 V_{1} s + Rp1a1 V_{1}}{C_{7} R_{10} R_{11} s + C_{7} R_{11} Rp1a1 s + R_{10} + R_{11} + Rp1a1}\)</span><br><span class="math inline">\(v_{4} = \frac{C_{7} R_{10} R_{11} V_{1} s + C_{7} R_{11} Rp1a1 V_{1} s + R_{10} V_{1} + Rp1a1 V_{1}}{C_{7} R_{10} R_{11} s + C_{7} R_{11} Rp1a1 s + R_{10} + R_{11} + Rp1a1}\)</span><br><span class="math inline">\(v_{5} = V_{1}\)</span><br><span class="math inline">\(I_{V1} = - \frac{V_{1}}{Rp1b1}\)</span><br><span class="math inline">\(I_{O1b} = \frac{- C_{7} R_{11} V_{1} s - V_{1}}{C_{7} R_{10} R_{11} s + C_{7} R_{11} Rp1a1 s + R_{10} + R_{11} + Rp1a1}\)</span><br></p>
</div>
</div>
<p>The network transfer function, <span class="math inline">\(H(s)=\frac {v_2(s)}{v_1(s)}\)</span> is:</p>
<div id="582deff3-cb78-4949-b997-5f698dfdb455" class="cell" data-execution_count="31">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>H_sym <span class="op">=</span> (U_sym[v2]<span class="op">/</span>U_sym[v1]).cancel()</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'$H(s)=</span><span class="sc">{:s}</span><span class="st">$'</span>.<span class="bu">format</span>(latex(H_sym)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="31">
<p><span class="math inline">\(H(s)=\frac{C_{7} C_{8} R_{10} R_{11} R_{12} s^{2} + C_{7} C_{8} R_{11} R_{12} Rp1a1 s^{2} + C_{7} R_{10} R_{11} s + C_{7} R_{11} R_{12} s + C_{7} R_{11} Rp1a1 s + C_{8} R_{10} R_{12} s + C_{8} R_{11} R_{12} s + C_{8} R_{12} Rp1a1 s + R_{10} + R_{11} + R_{12} + Rp1a1}{C_{7} C_{8} R_{10} R_{11} R_{12} s^{2} + C_{7} C_{8} R_{11} R_{12} Rp1a1 s^{2} + C_{7} R_{10} R_{11} s + C_{7} R_{11} Rp1a1 s + C_{8} R_{10} R_{12} s + C_{8} R_{11} R_{12} s + C_{8} R_{12} Rp1a1 s + R_{10} + R_{11} + Rp1a1}\)</span></p>
</div>
</div>
<p>Both the numerator and denominator are second order polynomials.</p>
<div id="94a0792f-113d-4512-a047-6f03e4479b09" class="cell" data-tags="[]" data-execution_count="32">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>H_sym_num, H_sym_denom <span class="op">=</span> fraction(H_sym,s) <span class="co">#returns numerator and denominator</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="numerator-polynomial" class="level4" data-number="27.3.2.2">
<h4 data-number="27.3.2.2" class="anchored" data-anchor-id="numerator-polynomial"><span class="header-section-number">27.3.2.2</span> Numerator Polynomial</h4>
<p>The numerator polynomial is:</p>
<div id="791b44ba-6bf8-43f7-93a5-e6140a929def" class="cell" data-execution_count="33">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'$N(s)=</span><span class="sc">{:s}</span><span class="st">$'</span>.<span class="bu">format</span>(latex(H_sym_num)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="33">
<p><span class="math inline">\(N(s)=C_{7} C_{8} R_{10} R_{11} R_{12} s^{2} + C_{7} C_{8} R_{11} R_{12} Rp1a1 s^{2} + C_{7} R_{10} R_{11} s + C_{7} R_{11} R_{12} s + C_{7} R_{11} Rp1a1 s + C_{8} R_{10} R_{12} s + C_{8} R_{11} R_{12} s + C_{8} R_{12} Rp1a1 s + R_{10} + R_{11} + R_{12} + Rp1a1\)</span></p>
</div>
</div>
<p>The coefficients of each Laplace term can be equated to the variables <span class="math inline">\(b_2\)</span>, <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_0\)</span> in the expression:</p>
<p><span class="math inline">\(b_2s^{2}+b_1s+b_0\)</span></p>
<p>where <span class="math inline">\(b_2\)</span>, <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_0\)</span> are:</p>
<div id="84f07961-efed-4215-bc30-41d121ccd879" class="cell" data-execution_count="34">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>b2 <span class="op">=</span> H_sym_num.coeff(s<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>b1 <span class="op">=</span> H_sym_num.coeff(s<span class="op">**</span><span class="dv">1</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>b0 <span class="op">=</span> (H_sym_num <span class="op">-</span> b1<span class="op">*</span>s<span class="op">*</span><span class="dv">1</span> <span class="op">-</span> b2<span class="op">*</span>s<span class="op">**</span><span class="dv">2</span>).expand()</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'&lt;p&gt;$b_2=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;&lt;p&gt;$b_1=</span><span class="sc">{:s}</span><span class="st">$</span><span class="op">\</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/p&gt;&lt;p&gt;$b_0=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;'</span>.<span class="bu">format</span>(latex(b2),latex(b1),latex(b0)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="34">
<p>
<span class="math inline">\(b_2=C_{7} C_{8} R_{10} R_{11} R_{12} + C_{7} C_{8} R_{11} R_{12} Rp1a1\)</span>
</p>
<p>
<span class="math inline">\(b_1=C_{7} R_{10} R_{11} + C_{7} R_{11} R_{12} + C_{7} R_{11} Rp1a1 + C_{8} R_{10} R_{12} + C_{8} R_{11} R_{12} + C_{8} R_{12} Rp1a1\)</span>
</p>
<p>
<span class="math inline">\(b_0=R_{10} + R_{11} + R_{12} + Rp1a1\)</span>
</p>
</div>
</div>
<p>The roots of the numerator polynomial can easily be found with SymPy. This filter has two transmission zeros, which can be found using the <code>solve</code> function on the numerator polynomial.</p>
<div id="52ba8252-084f-4719-aaf0-b9b0e1d8deb9" class="cell" data-execution_count="35">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>num_root_sym <span class="op">=</span> solve(H_sym_num,s)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'There are </span><span class="sc">{:d}</span><span class="st"> zeros, which are:</span><span class="op">\</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;p&gt;$z_0=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;&lt;p&gt;$z_1=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;'</span>.<span class="bu">format</span>(<span class="bu">len</span>(num_root_sym),latex(num_root_sym[<span class="dv">0</span>]),latex(num_root_sym[<span class="dv">1</span>])))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="35">
There are 2 zeros, which are:
<p>
<span class="math inline">\(z_0=\frac{- C_{7} R_{10} R_{11} - C_{7} R_{11} R_{12} - C_{7} R_{11} Rp1a1 - C_{8} R_{10} R_{12} - C_{8} R_{11} R_{12} - C_{8} R_{12} Rp1a1 - \sqrt{C_{7}^{2} R_{10}^{2} R_{11}^{2} + 2 C_{7}^{2} R_{10} R_{11}^{2} R_{12} + 2 C_{7}^{2} R_{10} R_{11}^{2} Rp1a1 + C_{7}^{2} R_{11}^{2} R_{12}^{2} + 2 C_{7}^{2} R_{11}^{2} R_{12} Rp1a1 + C_{7}^{2} R_{11}^{2} Rp1a1^{2} - 2 C_{7} C_{8} R_{10}^{2} R_{11} R_{12} - 2 C_{7} C_{8} R_{10} R_{11}^{2} R_{12} - 2 C_{7} C_{8} R_{10} R_{11} R_{12}^{2} - 4 C_{7} C_{8} R_{10} R_{11} R_{12} Rp1a1 + 2 C_{7} C_{8} R_{11}^{2} R_{12}^{2} - 2 C_{7} C_{8} R_{11}^{2} R_{12} Rp1a1 - 2 C_{7} C_{8} R_{11} R_{12}^{2} Rp1a1 - 2 C_{7} C_{8} R_{11} R_{12} Rp1a1^{2} + C_{8}^{2} R_{10}^{2} R_{12}^{2} + 2 C_{8}^{2} R_{10} R_{11} R_{12}^{2} + 2 C_{8}^{2} R_{10} R_{12}^{2} Rp1a1 + C_{8}^{2} R_{11}^{2} R_{12}^{2} + 2 C_{8}^{2} R_{11} R_{12}^{2} Rp1a1 + C_{8}^{2} R_{12}^{2} Rp1a1^{2}}}{2 C_{7} C_{8} R_{11} R_{12} \left(R_{10} + Rp1a1\right)}\)</span>
</p>
<p>
<span class="math inline">\(z_1=\frac{- C_{7} R_{10} R_{11} - C_{7} R_{11} R_{12} - C_{7} R_{11} Rp1a1 - C_{8} R_{10} R_{12} - C_{8} R_{11} R_{12} - C_{8} R_{12} Rp1a1 + \sqrt{C_{7}^{2} R_{10}^{2} R_{11}^{2} + 2 C_{7}^{2} R_{10} R_{11}^{2} R_{12} + 2 C_{7}^{2} R_{10} R_{11}^{2} Rp1a1 + C_{7}^{2} R_{11}^{2} R_{12}^{2} + 2 C_{7}^{2} R_{11}^{2} R_{12} Rp1a1 + C_{7}^{2} R_{11}^{2} Rp1a1^{2} - 2 C_{7} C_{8} R_{10}^{2} R_{11} R_{12} - 2 C_{7} C_{8} R_{10} R_{11}^{2} R_{12} - 2 C_{7} C_{8} R_{10} R_{11} R_{12}^{2} - 4 C_{7} C_{8} R_{10} R_{11} R_{12} Rp1a1 + 2 C_{7} C_{8} R_{11}^{2} R_{12}^{2} - 2 C_{7} C_{8} R_{11}^{2} R_{12} Rp1a1 - 2 C_{7} C_{8} R_{11} R_{12}^{2} Rp1a1 - 2 C_{7} C_{8} R_{11} R_{12} Rp1a1^{2} + C_{8}^{2} R_{10}^{2} R_{12}^{2} + 2 C_{8}^{2} R_{10} R_{11} R_{12}^{2} + 2 C_{8}^{2} R_{10} R_{12}^{2} Rp1a1 + C_{8}^{2} R_{11}^{2} R_{12}^{2} + 2 C_{8}^{2} R_{11} R_{12}^{2} Rp1a1 + C_{8}^{2} R_{12}^{2} Rp1a1^{2}}}{2 C_{7} C_{8} R_{11} R_{12} \left(R_{10} + Rp1a1\right)}\)</span>
</p>
</div>
</div>
</section>
<section id="denominator-polynomial" class="level4" data-number="27.3.2.3">
<h4 data-number="27.3.2.3" class="anchored" data-anchor-id="denominator-polynomial"><span class="header-section-number">27.3.2.3</span> Denominator Polynomial</h4>
<p>The denominator polynomial is:</p>
<div id="ce306613-94ee-455b-bfd3-62300c55dd4f" class="cell" data-execution_count="36">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'$D(s)=</span><span class="sc">{:s}</span><span class="st">$'</span>.<span class="bu">format</span>(latex(H_sym_denom)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="36">
<p><span class="math inline">\(D(s)=C_{7} C_{8} R_{10} R_{11} R_{12} s^{2} + C_{7} C_{8} R_{11} R_{12} Rp1a1 s^{2} + C_{7} R_{10} R_{11} s + C_{7} R_{11} Rp1a1 s + C_{8} R_{10} R_{12} s + C_{8} R_{11} R_{12} s + C_{8} R_{12} Rp1a1 s + R_{10} + R_{11} + Rp1a1\)</span></p>
</div>
</div>
<p>The coefficients of each Laplace term can be equated to the variables <span class="math inline">\(a_3\)</span>, <span class="math inline">\(a_2\)</span>, <span class="math inline">\(a_1\)</span> and <span class="math inline">\(a_0\)</span> in the expression:</p>
<p><span class="math inline">\(a_3s^3+a_2s^2+a_1s+a_0\)</span></p>
<p>where <span class="math inline">\(a_3\)</span>, <span class="math inline">\(a_2\)</span>, <span class="math inline">\(a_1\)</span> and <span class="math inline">\(a_0\)</span> are:</p>
<div id="fb053765-f112-4f39-87ec-e8436531ede1" class="cell" data-execution_count="37">
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="37">
<p></p>
<p>
<span class="math inline">\(a_2=C_{7} C_{8} R_{10} R_{11} R_{12} + C_{7} C_{8} R_{11} R_{12} Rp1a1\)</span>
</p>
<p>
<span class="math inline">\(a_1=C_{7} R_{10} R_{11} + C_{7} R_{11} Rp1a1 + C_{8} R_{10} R_{12} + C_{8} R_{11} R_{12} + C_{8} R_{12} Rp1a1\)</span>
</p>
<p>
<span class="math inline">\(a_0=R_{10} + R_{11} + Rp1a1\)</span>
</p>
</div>
</div>
<p>The roots of the denominator polynomial can be found with SymPy.</p>
<div id="3cc9f506-c6aa-4b50-9a21-0874d6664d04" class="cell" data-execution_count="38">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>denom_root_sym <span class="op">=</span> solve(H_sym_denom,s)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'There are </span><span class="sc">{:d}</span><span class="st"> poles, which are:</span><span class="op">\</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;p&gt;$p_0=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;&lt;p&gt;$p_1=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;'</span>.<span class="bu">format</span>(<span class="bu">len</span>(denom_root_sym),latex(denom_root_sym[<span class="dv">0</span>]),latex(denom_root_sym[<span class="dv">1</span>])))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="38">
There are 2 poles, which are:
<p>
<span class="math inline">\(p_0=- \frac{1}{C_{8} R_{12}}\)</span>
</p>
<p>
<span class="math inline">\(p_1=\frac{- R_{10} - R_{11} - Rp1a1}{C_{7} R_{11} \left(R_{10} + Rp1a1\right)}\)</span>
</p>
</div>
</div>
</section>
<section id="numerical-solution-for-p1-at-50-1" class="level4" data-number="27.3.2.4">
<h4 data-number="27.3.2.4" class="anchored" data-anchor-id="numerical-solution-for-p1-at-50-1"><span class="header-section-number">27.3.2.4</span> Numerical Solution for P1 at 50%</h4>
<p>A numerical solution for the network equations is obtained for P1 at 50% rotation. The element values are substituted into the equations and displayed.</p>
<div id="6e461223-f716-4b7f-b796-3d31a7832fa3" class="cell" data-execution_count="39">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>equ_N <span class="op">=</span> NE_sym.subs(element_values)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> <span class="st">''</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(shape(equ_N.lhs)[<span class="dv">0</span>]):</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    temp <span class="op">+=</span> <span class="st">'&lt;p&gt;$</span><span class="sc">{:s}</span><span class="st"> = </span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;'</span>.<span class="bu">format</span>(latex(equ_N.rhs[i]),</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>        latex(round_expr(equ_N.lhs[i],<span class="dv">6</span>)))</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>Markdown(temp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="39">
<p>
<span class="math inline">\(0 = I_{V1} + 2.0 \cdot 10^{-5} v_{1}\)</span>
</p>
<p>
<span class="math inline">\(0 = I_{O1b} + 2.0 \cdot 10^{-6} v_{2} - 2.0 \cdot 10^{-6} v_{5}\)</span>
</p>
<p>
<span class="math inline">\(0 = 0.00052 v_{3} - 0.0005 v_{4}\)</span>
</p>
<p>
<span class="math inline">\(0 = - 0.0005 v_{3} + 0.000567 v_{4} - 6.7 \cdot 10^{-5} v_{5}\)</span>
</p>
<p>
<span class="math inline">\(0 = - 2.0 \cdot 10^{-6} v_{2} - 6.7 \cdot 10^{-5} v_{4} + 6.9 \cdot 10^{-5} v_{5}\)</span>
</p>
<p>
<span class="math inline">\(1.0 = v_{1}\)</span>
</p>
<p>
<span class="math inline">\(0 = - v_{1} + v_{5}\)</span>
</p>
</div>
</div>
<p>SymPy can solve for unknown node voltages and the unknown currents from the independent voltage source, <span class="math inline">\(V_1\)</span>, and the Op Amp’s output terminal. The unknown currents, <span class="math inline">\(I_{V1}\)</span> and <span class="math inline">\(I_{O1}\)</span>, are not displayed. The node voltages are:</p>
<div id="512ec799-f62c-401f-ae3b-12f79647fadf" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;jupyter&quot;,&quot;value&quot;:{&quot;outputs_hidden&quot;:false}}" data-execution_count="40">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>U <span class="op">=</span> solve(equ_N,X)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> <span class="st">''</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> U.keys():</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">str</span>(i)[<span class="dv">0</span>] <span class="op">==</span> <span class="st">'v'</span>: <span class="co"># only display the node voltages</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>        temp <span class="op">+=</span> <span class="st">'&lt;p&gt;$</span><span class="sc">{:s}</span><span class="st"> = </span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;'</span>.<span class="bu">format</span>(latex(i),latex(U[i]))</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>Markdown(temp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="40">
<p>
<span class="math inline">\(v_{1} = 1.0\)</span>
</p>
<p>
<span class="math inline">\(v_{2} = \frac{3.74166 \cdot 10^{22} s^{2} + 2.11154097156402 \cdot 10^{27} s + 1.7381516587678 \cdot 10^{30}}{3.74166 \cdot 10^{22} s^{2} + 2.66540971563981 \cdot 10^{26} s + 2.38151658767774 \cdot 10^{29}}\)</span>
</p>
<p>
<span class="math inline">\(v_{3} = \frac{3075000000000.0 s + 2.5 \cdot 10^{15}}{3198000000000.0 s + 3.35000000000001 \cdot 10^{15}}\)</span>
</p>
<p>
<span class="math inline">\(v_{4} = \frac{3198000000000.0 s + 2.6 \cdot 10^{15}}{3198000000000.0 s + 3.35000000000001 \cdot 10^{15}}\)</span>
</p>
<p>
<span class="math inline">\(v_{5} = 1.0\)</span>
</p>
</div>
</div>
<p>The network transfer function, <span class="math inline">\(H(s)=\frac {v_2(s)}{v_1(s)}\)</span>, is:</p>
<div id="b21473fb-ba2d-4979-9777-44363b0ef0ec" class="cell" data-execution_count="41">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>H <span class="op">=</span> (U[v2]<span class="op">/</span>U[v1]).cancel()</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'$H(s)=</span><span class="sc">{:s}</span><span class="st">$'</span>.<span class="bu">format</span>(latex(H)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="41">
<p><span class="math inline">\(H(s)=\frac{3.74166 \cdot 10^{22} s^{2} + 2.11154097156402 \cdot 10^{27} s + 1.7381516587678 \cdot 10^{30}}{3.74166 \cdot 10^{22} s^{2} + 2.66540971563981 \cdot 10^{26} s + 2.38151658767774 \cdot 10^{29}}\)</span></p>
</div>
</div>
<p>The SciPy function, <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.TransferFunction.html">TransferFunction</a>, is used to represent the system as the continuous-time transfer function. The code below extracts the numerator and denominator polynomials from the voltage transfer function. Then coefficients of the terms are used to build a SciPy transfer function object.</p>
<div id="6f96836a-634c-4ea5-9bb6-afc3c7795cf2" class="cell" data-execution_count="42">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>H_num, H_denom <span class="op">=</span> fraction(H) <span class="co">#returns numerator and denominator</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert symbolic to NumPy polynomial</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array(Poly(H_num, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array(Poly(H_denom, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>sys_tf <span class="op">=</span> signal.TransferFunction(a,b)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="pole-zero-plot-1" class="level4" data-number="27.3.2.5">
<h4 data-number="27.3.2.5" class="anchored" data-anchor-id="pole-zero-plot-1"><span class="header-section-number">27.3.2.5</span> Pole Zero Plot</h4>
<p>The poles and zeros of the transfer function can easily be obtained with the following code:</p>
<div id="f2dcd8d5-a21c-4119-9076-09cc69f54df3" class="cell" data-execution_count="43">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>sys_zeros <span class="op">=</span> np.roots(sys_tf.num)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>sys_poles <span class="op">=</span> np.roots(sys_tf.den)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The poles and zeros of the transfer function are plotted on the complex frequency plane with the following code:</p>
<div id="8aa13126-0c3e-4769-8ef5-64e395d8083d" class="cell" data-execution_count="44">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>plt.plot(np.real(sys_zeros<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)), np.imag(sys_zeros<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)), <span class="st">'ob'</span>,</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    markerfacecolor<span class="op">=</span><span class="st">'none'</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>plt.plot(np.real(sys_poles<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)), np.imag(sys_poles<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)), <span class="st">'xr'</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">'Zeros'</span>, <span class="st">'Poles'</span>], loc<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Pole / Zero Plot'</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'real part, </span><span class="ch">\u03B1</span><span class="st">'</span>)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'imaginary part, j</span><span class="ch">\u03C9</span><span class="st">'</span>)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Klon Centaur part 3v1_files/figure-html/cell-45-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The code below generates a table that lists the values of the pole and zero locations.</p>
<div id="60643757-4624-474b-8d7c-c43723354bdb" class="cell" data-execution_count="45">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>table_header <span class="op">=</span> [<span class="st">'Zeros, Hz'</span>, <span class="st">'Poles, Hz'</span>]</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>num_table_rows <span class="op">=</span> <span class="bu">max</span>(<span class="bu">len</span>(sys_zeros),<span class="bu">len</span>(sys_poles))</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>table_row <span class="op">=</span> []</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_table_rows):</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">&lt;</span> <span class="bu">len</span>(sys_zeros):</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>        z <span class="op">=</span> <span class="st">'</span><span class="sc">{:.2f}</span><span class="st">'</span>.<span class="bu">format</span>(sys_zeros[i]<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi))</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>        z <span class="op">=</span> <span class="st">''</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">&lt;</span> <span class="bu">len</span>(sys_poles):</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>        p <span class="op">=</span> <span class="st">'</span><span class="sc">{:.2f}</span><span class="st">'</span>.<span class="bu">format</span>(sys_poles[i]<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi))</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>        p <span class="op">=</span> <span class="st">''</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    table_row.append([z,p])</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tabulate(table_row, headers<span class="op">=</span>table_header,colalign <span class="op">=</span> (<span class="st">'left'</span>,<span class="st">'left'</span>),tablefmt<span class="op">=</span><span class="st">"simple"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Zeros, Hz    Poles, Hz
-----------  -----------
-8848.65     -967.04
-132.98      -166.72</code></pre>
</div>
</div>
</section>
<section id="polezero-locus-plot-versus-p_1-value" class="level4" data-number="27.3.2.6">
<h4 data-number="27.3.2.6" class="anchored" data-anchor-id="polezero-locus-plot-versus-p_1-value"><span class="header-section-number">27.3.2.6</span> Pole/Zero Locus Plot versus <span class="math inline">\(P_1\)</span> value</h4>
<p>For each position of <span class="math inline">\(P_1\)</span>, there are two zeros and two poles. The plot below shows the frequency locations for the pole and zero locations as a function of <span class="math inline">\(P_1\)</span> rotation. Since the poles and zeros don’t have imaginary parts, the complex frequency is plotted on the vertical axis versus the gain control rotational position, from 1 to 99 percent. The plot provides a visual indication of how the poles and zeros change as a function <span class="math inline">\(P_1\)</span>.</p>
<div id="d5888611-97cf-4f0d-b79a-f71fe2a4bc53" class="cell" data-execution_count="46">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>sym_num, sym_denom <span class="op">=</span> fraction(H_sym) <span class="co">#returns numerator and denominator</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>p1_value <span class="op">=</span> <span class="fl">100e3</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>num_roots <span class="op">=</span> []</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>denom_roots <span class="op">=</span> []</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.linspace(<span class="dv">1</span>,<span class="dv">99</span>,<span class="dv">20</span>)<span class="op">/</span><span class="dv">100</span>:</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    element_values[Rp1a1] <span class="op">=</span> p1_value <span class="op">-</span> i<span class="op">*</span>p1_value</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    element_values[Rp1b1] <span class="op">=</span> i<span class="op">*</span>p1_value</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    num_roots.append(solve(sym_num.subs(element_values),s))</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    denom_roots.append(solve(sym_denom.subs(element_values),s))</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="co"># put the zeros into an array</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>z0_locus <span class="op">=</span> np.zeros(<span class="bu">len</span>(np.array(num_roots)))</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>z1_locus <span class="op">=</span> np.zeros(<span class="bu">len</span>(np.array(num_roots)))</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(np.array(num_roots))):</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>    z0_locus[i] <span class="op">=</span> <span class="op">-</span>np.array(num_roots)[i][<span class="dv">0</span>]    </span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>    z1_locus[i] <span class="op">=</span> <span class="op">-</span>np.array(num_roots)[i][<span class="dv">1</span>]        </span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="co"># put the poles into an array</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>p0_locus <span class="op">=</span> np.zeros(<span class="bu">len</span>(np.array(denom_roots)))</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>p1_locus <span class="op">=</span> np.zeros(<span class="bu">len</span>(np.array(denom_roots)))</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(np.array(denom_roots))):</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>    p0_locus[i] <span class="op">=</span> <span class="op">-</span>np.array(denom_roots)[i][<span class="dv">0</span>]    </span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>    p1_locus[i] <span class="op">=</span> <span class="op">-</span>np.array(denom_roots)[i][<span class="dv">1</span>]        </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>After solving for the numerator and dominator roots of the transfer function at various positions of <span class="math inline">\(P_1\)</span>, we can examine the range of frequencies that the zeros take on as <span class="math inline">\(P_1\)</span> is rotated.</p>
<div id="10d2e972-f463-40f7-a877-ea47c3894eb0" class="cell" data-execution_count="47">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'z0 range as a function of P1: </span><span class="sc">{</span>z0_locus<span class="sc">.</span><span class="bu">min</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> to </span><span class="sc">{</span>z0_locus<span class="sc">.</span><span class="bu">max</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> kHz'</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'z1 range as a function of P1: </span><span class="sc">{</span>z1_locus<span class="sc">.</span><span class="bu">min</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> to </span><span class="sc">{</span>z1_locus<span class="sc">.</span><span class="bu">max</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> kHz'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>z0 range as a function of P1: 5.023 to 137.640 kHz
z1 range as a function of P1: 0.133 to 0.133 kHz</code></pre>
</div>
</div>
<p>As shown above, <span class="math inline">\(z_0\)</span> will move from about 5kHz to 137 kHz as <span class="math inline">\(P_1\)</span> is rotated. <span class="math inline">\(z_1\)</span>’s position in the complex frequency plane remains constant. The position of <span class="math inline">\(z_0\)</span> is plotted below.</p>
<div id="35a40f7b-89cb-4cf4-a964-dbdd2cf7813b" class="cell" data-execution_count="48">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>plt.plot(np.linspace(<span class="dv">1</span>,<span class="dv">99</span>,<span class="bu">len</span>(np.array(num_roots))),z0_locus<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span>,<span class="st">'o-b'</span>, markerfacecolor<span class="op">=</span><span class="st">'none'</span>,label<span class="op">=</span><span class="st">'z_0'</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.plot(np.linspace(1,99,len(np.array(num_roots))),z1_locus/(2*np.pi)/1e3,'o-b', markerfacecolor='none',label='z_1')</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.plot(np.linspace(1,99,len(np.array(denom_roots))),p0_locus/(2*np.pi)/1e3,'x-r', markerfacecolor='none',label='p_0')</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.plot(np.linspace(1,99,len(np.array(denom_roots))),p1_locus/(2*np.pi)/1e3,'x-r', markerfacecolor='none',label='p_1')</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>plt.ylim((<span class="dv">0</span>,<span class="dv">140</span>))</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Gain control pole &amp; zero frequency plot vs gain rotation %'</span>)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Gain rotation percentage'</span>)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'pole and zero frequency, kHz'</span>)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Klon Centaur part 3v1_files/figure-html/cell-49-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>As shown above, the position of <span class="math inline">\(z_0\)</span> moves more dramatically when <span class="math inline">\(P_1\)</span> is rotated from 80 to 100%.</p>
<p>The range of the poles on the complex plane is printed below.</p>
<div id="e670437f-db26-4f9f-b0ca-fd8f50cfdf04" class="cell" data-execution_count="49">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'p0 range as a function of P1: </span><span class="sc">{</span>p0_locus<span class="sc">.</span><span class="bu">min</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> to </span><span class="sc">{</span>p0_locus<span class="sc">.</span><span class="bu">max</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> kHz'</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'p1 range as a function of P1: </span><span class="sc">{</span>p1_locus<span class="sc">.</span><span class="bu">min</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> to </span><span class="sc">{</span>p1_locus<span class="sc">.</span><span class="bu">max</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> kHz'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>p0 range as a function of P1: 0.967 to 0.967 kHz
p1 range as a function of P1: 0.149 to 0.776 kHz</code></pre>
</div>
</div>
<p>The position of <span class="math inline">\(p_0\)</span> is constant and <span class="math inline">\(p_1\)</span> moves from 150 Hz to 776 Hz as <span class="math inline">\(P_1\)</span> is rotated.</p>
<div id="d4c66621-17b7-4463-ae2b-3abaa71e1db1" class="cell" data-execution_count="50">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.plot(np.linspace(1,99,len(np.array(num_roots))),z0_locus/(2*np.pi)/1e3,'o-b', markerfacecolor='none',label='z_0')</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.plot(np.linspace(1,99,len(np.array(num_roots))),z1_locus/(2*np.pi)/1e3,'o-b', markerfacecolor='none',label='z_1')</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.plot(np.linspace(1,99,len(np.array(denom_roots))),p0_locus/(2*np.pi)/1e3,'x-k', markerfacecolor='none',label='p_0')</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>plt.plot(np.linspace(<span class="dv">1</span>,<span class="dv">99</span>,<span class="bu">len</span>(np.array(denom_roots))),p1_locus<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span>,<span class="st">'x-r'</span>, markerfacecolor<span class="op">=</span><span class="st">'none'</span>,label<span class="op">=</span><span class="st">'p_1'</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>plt.ylim((<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Gain control pole &amp; zero frequency plot vs gain rotation %'</span>)</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Gain rotation percentage'</span>)</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'pole and zero frequency, kHz'</span>)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Klon Centaur part 3v1_files/figure-html/cell-51-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>As shown above, <span class="math inline">\(p_1\)</span> moves more dramatically as <span class="math inline">\(P_1\)</span> is rotated from 80% to 100%.</p>
</section>
<section id="reactive-branch-2-frequency-response" class="level4" data-number="27.3.2.7">
<h4 data-number="27.3.2.7" class="anchored" data-anchor-id="reactive-branch-2-frequency-response"><span class="header-section-number">27.3.2.7</span> Reactive Branch 2 Frequency Response</h4>
<p>The voltage transfer function for the reactive branch shown in <a href="#fig-reactive_branch_2_sch" class="quarto-xref">Figure&nbsp;<span>27.2</span></a> is plotted below.</p>
<div id="ca062402-d1ca-4e59-8c40-65203fbd06b7" class="cell" data-execution_count="51">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set up</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>x_axis <span class="op">=</span> np.logspace(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">2000</span>, endpoint<span class="op">=</span><span class="va">False</span>)<span class="op">*</span><span class="dv">2</span><span class="op">*</span>np.pi</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>color_list <span class="op">=</span> [<span class="st">'tab:blue'</span>,<span class="st">'tab:red'</span>,<span class="st">'tab:green'</span>,<span class="st">'tab:orange'</span>,<span class="st">'k'</span>]</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>gain_setting <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">25</span>,<span class="dv">50</span>,<span class="dv">75</span>,<span class="dv">99</span>])<span class="op">/</span><span class="dv">100</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>p1_value <span class="op">=</span> <span class="fl">100e3</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>fig, ax1 <span class="op">=</span> plt.subplots()</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'magnitude, dB'</span>)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'frequency, Hz'</span>)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="co"># instantiate a second y-axes that shares the same x-axis</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> ax1.twinx()</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>color <span class="op">=</span> <span class="st">'k'</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'phase, deg'</span>,color<span class="op">=</span>color)</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>ax2.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelcolor<span class="op">=</span>color)</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(gain_setting)):</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>    element_values[Rp1a1] <span class="op">=</span> p1_value <span class="op">-</span> gain_setting[i]<span class="op">*</span>p1_value</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>    element_values[Rp1b1] <span class="op">=</span> gain_setting[i]<span class="op">*</span>p1_value</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">#element_values[Rp1a2] = p1_value - gain_setting[i]*p1_value</span></span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">#element_values[Rp1b2] = gain_setting[i]*p1_value</span></span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>    NE <span class="op">=</span> NE_sym.subs(element_values)</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>    U <span class="op">=</span> solve(NE,X)</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>    H <span class="op">=</span> U[v2]<span class="op">/</span>U[v1]</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>    num, denom <span class="op">=</span> fraction(H) <span class="co">#returns numerator and denominator</span></span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># convert symbolic to NumPy polynomial</span></span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> np.array(Poly(num, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> np.array(Poly(denom, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>    <span class="co">#tf_num_coef_list.append(a)</span></span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>    <span class="co">#tf_denom_coef_list.append(b)</span></span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>    <span class="co">#x = np.logspace(1, 5, 2000, endpoint=False)*2*np.pi</span></span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>    w, mag, phase <span class="op">=</span> signal.bode((a, b), w<span class="op">=</span>x_axis) <span class="co"># returns: rad/s, mag in dB, phase in deg</span></span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>    <span class="co">#clean_path1_mag[i] = mag</span></span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot the results.  </span></span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a>    ax1.semilogx(w<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi), mag,<span class="st">'-'</span>,color<span class="op">=</span>color_list[i],label<span class="op">=</span><span class="st">'mag: </span><span class="sc">{:.0f}</span><span class="st">%'</span>.<span class="bu">format</span>(gain_setting[i]<span class="op">*</span><span class="dv">100</span>))    <span class="co"># magnitude plot</span></span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a>    ax2.semilogx(w<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi), phase,<span class="st">':'</span>,color<span class="op">=</span>color_list[i],label<span class="op">=</span><span class="st">'phase: </span><span class="sc">{:.0f}</span><span class="st">%'</span>.<span class="bu">format</span>(gain_setting[i]<span class="op">*</span><span class="dv">100</span>))  <span class="co"># phase plot</span></span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a><span class="co"># highlight the guitar audio band, 80 to 8kHz</span></span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a>plt.axvspan(<span class="dv">80</span>, <span class="fl">8e3</span>, color<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>) </span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a><span class="co"># position legends outside the graph</span></span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a>ax1.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.6</span>,<span class="dv">1</span>)) <span class="co"># magnitude legend position: relative (horizontal position, vertical position) </span></span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a>ax2.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.6</span>,<span class="fl">0.5</span>)) <span class="co"># phase legend position:</span></span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a><span class="co">#ax1.legend(loc='lower left')</span></span>
<span id="cb54-53"><a href="#cb54-53" aria-hidden="true" tabindex="-1"></a><span class="co">#ax2.legend(loc='lower right')</span></span>
<span id="cb54-54"><a href="#cb54-54" aria-hidden="true" tabindex="-1"></a>ax1.grid()</span>
<span id="cb54-55"><a href="#cb54-55" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Magnitude and phase response'</span>)</span>
<span id="cb54-56"><a href="#cb54-56" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Klon Centaur part 3v1_files/figure-html/cell-52-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>As shown above, when the gain is increased, a resonance develops near 1 kHz.</p>
</section>
</section>
<section id="sec-reactive_branch_3" class="level3" data-number="27.3.3">
<h3 data-number="27.3.3" class="anchored" data-anchor-id="sec-reactive_branch_3"><span class="header-section-number">27.3.3</span> Reactive Branch 3</h3>
<p>The schematic shown below represents the highlighted parts of the Klon Centuar circuit shown in <a href="Klon Centaur part 1.html#fig-klon-centaur-schematic-high-res_w_clean_path2_highlight_sch" class="quarto-xref">Figure&nbsp;<span>25.17</span></a> and <a href="Klon Centaur part 1.html#fig-klon-centaur-schematic-high-res_w_diode_path2_highlight_sch" class="quarto-xref">Figure&nbsp;<span>25.21</span></a>. The voltage source <span class="math inline">\(V_1\)</span> is the output Op Amp of <span class="math inline">\(U_{1A}\)</span> and the voltage source <span class="math inline">\(V_2\)</span> is the output of <span class="math inline">\(U_{1B}\)</span>. The Diodes <span class="math inline">\(D_1\)</span> and <span class="math inline">\(D_2\)</span> have been commented out in the netlist. Node 10 is the summing junction for clean path 2 and the diode path.</p>
<p>One of the ganged pots in <span class="math inline">\(P_1\)</span>, which is the gain control, is represented in the schematic by the resistors <span class="math inline">\(R_{p1b2}\)</span> and <span class="math inline">\(R_{p1a2}\)</span>. The variable <span class="math inline">\(R_{gain}\)</span> is used to control the position of the wiper. The gain pot, <span class="math inline">\(P_1\)</span>’s terminals, are across <span class="math inline">\(R_9\)</span> and <span class="math inline">\(C_6\)</span> and <span class="math inline">\(P_1\)</span>’s wiper contact at node 5 and forms a voltage divider that controls the signal amplitude at node 5.</p>
<p>In this section of the analysis we will look at the reactive path from node 1 to node 2 with <span class="math inline">\(V_2\)</span> set to zero. This will include most of the components that are attached to these nodes. The components that are not included are those components along clean path 1 shown in <a href="Klon Centaur part 1.html#fig-klon-centaur-schematic-high-res_w_clean_path1_highlight_sch" class="quarto-xref">Figure&nbsp;<span>25.15</span></a>. Node 10 below is a virtual ground and by superposition we can separate out the contribution from clan path 1 and add it back later if we want to consider the combined contribution of the signals from the inputs to the summing junction. For now we are only interested in reactive branch 3.</p>
<p>The capacitor <span class="math inline">\(C_{13}\)</span> shown in <a href="Klon Centaur part 1.html#fig-klon-centaur-schematic-high-res_w_clean_path2_highlight_sch" class="quarto-xref">Figure&nbsp;<span>25.17</span></a> has been removed from this analysis. <span class="math inline">\(C_{13}\)</span> in parallel with <span class="math inline">\(R_{20}\)</span> in the feedback path around <span class="math inline">\(U_{2B}\)</span> adds a zero to the voltage transfer function at about 500 Hz. The effect of this low pass filter is excluded from this analysis since we are interested only in the reactive path prior to <span class="math inline">\(U_{1B}\)</span></p>
<p>We will examine the solution to the network equations with <span class="math inline">\(P_1\)</span> set to 50%. A symbolic solution was taking too long on my laptop, so this step was skipped. The poles and zeros for <span class="math inline">\(P_1\)</span> are plotted and tabulated. The locus of poles and zeros for the transfer function are plotted to see how they move in the frequency domain as a function of <span class="math inline">\(P_1\)</span>. Finally, a frequency response plot of the voltage transfer function versus gain settings is generated.</p>
<p>In <a href="#sec-reactive_branch_3a" class="quarto-xref"><span>Section 27.3.4</span></a> and <a href="#sec-reactive_branch_3b" class="quarto-xref"><span>Section 27.3.6</span></a>, reactive branch 3 is divided into two smaller subcircuits at <span class="math inline">\(P_1\)</span>. This is done to gain some insight into the operation of components along this path.</p>
<div id="fig-reactive_branch_3_4_sch" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-reactive_branch_3_4_sch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Reactive_branch_3_4.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-reactive_branch_3_4_sch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;27.3: Schematic of reactive branches 3 and 4. Reactive branch 3 is the path from V1 to V2 and reactive branch 4 is the path from V3 to V2.
</figcaption>
</figure>
</div>
<p>The netlist below was exported from LTSpice when the schematic was generated.</p>
<div id="b8316138-807a-4727-ac29-2a8d529fe5f5" class="cell" data-execution_count="52">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>Reactive_branch_3_4_net_list <span class="op">=</span> <span class="st">'''</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="st">* Reactive_branch_3&amp;4.asc</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="st">V1 1 0 1</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="st">V2 6 0 0</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="st">R5 1 3 5.1e3</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="st">R8 3 0 1.5e3</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="st">C4 1 3 68e-9</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="st">C6 3 4 390e-9</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="st">R9 4 0 1e3</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="st">Rp1b2 3 5 50e3</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="st">Rp1a2 5 0 50e3</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="st">R13 8 7 1e3</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="st">C11 9 11 2.2e-9</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a><span class="st">R15 11 5 22e3</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a><span class="st">R17 10 5 27e3</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a><span class="st">R18 12 5 12e3</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="st">C12 10 12 27e-9</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a><span class="st">R16 10 9 47e3</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a><span class="st">*R20 2 10 100e3</span></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a><span class="st">R20 2 10 392e3</span></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a><span class="st">*C13 2 10 820e-12</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a><span class="st">O2a 10 0 2</span></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a><span class="st">*D2 0 8 1N34A</span></span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a><span class="st">*D3 8 0 1N34A</span></span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a><span class="st">C9 6 7 1e-6</span></span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a><span class="st">C10 9 8 1e-6</span></span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a><span class="st">'''</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The function <code>SymMNA.smna</code> generates the MNA matrices from the netlist.</p>
<div id="b3650f44-2499-491b-88a1-d74c74e904c8" class="cell" data-execution_count="53">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>report, network_df, i_unk_df, A, X, Z <span class="op">=</span> SymMNA.smna(Reactive_branch_3_4_net_list)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The following code builds and displays the symbolic circuit equations.</p>
<div id="fafd8f77-9141-451a-b2af-0a9a5cbeeb84" class="cell" data-execution_count="54">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Put matrices into SymPy </span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> Matrix(X)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> Matrix(Z)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>NE_sym <span class="op">=</span> Eq(A<span class="op">*</span>X,Z)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="co"># display the equations</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> <span class="st">''</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(shape(NE_sym.lhs)[<span class="dv">0</span>]):</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>    temp <span class="op">+=</span> <span class="st">'$</span><span class="sc">{:s}</span><span class="st"> = </span><span class="sc">{:s}</span><span class="st">$&lt;br&gt;'</span>.<span class="bu">format</span>(latex(NE_sym.rhs[i]),latex(NE_sym.lhs[i]))</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>Markdown(temp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="54">
<p><span class="math inline">\(0 = I_{V1} + v_{1} \left(C_{4} s + \frac{1}{R_{5}}\right) + v_{3} \left(- C_{4} s - \frac{1}{R_{5}}\right)\)</span><br><span class="math inline">\(0 = I_{O2a} - \frac{v_{10}}{R_{20}} + \frac{v_{2}}{R_{20}}\)</span><br><span class="math inline">\(0 = - C_{6} s v_{4} + v_{1} \left(- C_{4} s - \frac{1}{R_{5}}\right) + v_{3} \left(C_{4} s + C_{6} s + \frac{1}{Rp1b2} + \frac{1}{R_{8}} + \frac{1}{R_{5}}\right) - \frac{v_{5}}{Rp1b2}\)</span><br><span class="math inline">\(0 = - C_{6} s v_{3} + v_{4} \left(C_{6} s + \frac{1}{R_{9}}\right)\)</span><br><span class="math inline">\(0 = v_{5} \cdot \left(\frac{1}{Rp1b2} + \frac{1}{Rp1a2} + \frac{1}{R_{18}} + \frac{1}{R_{17}} + \frac{1}{R_{15}}\right) - \frac{v_{3}}{Rp1b2} - \frac{v_{12}}{R_{18}} - \frac{v_{10}}{R_{17}} - \frac{v_{11}}{R_{15}}\)</span><br><span class="math inline">\(0 = C_{9} s v_{6} - C_{9} s v_{7} + I_{V2}\)</span><br><span class="math inline">\(0 = - C_{9} s v_{6} + v_{7} \left(C_{9} s + \frac{1}{R_{13}}\right) - \frac{v_{8}}{R_{13}}\)</span><br><span class="math inline">\(0 = - C_{10} s v_{9} + v_{8} \left(C_{10} s + \frac{1}{R_{13}}\right) - \frac{v_{7}}{R_{13}}\)</span><br><span class="math inline">\(0 = - C_{10} s v_{8} - C_{11} s v_{11} + v_{9} \left(C_{10} s + C_{11} s + \frac{1}{R_{16}}\right) - \frac{v_{10}}{R_{16}}\)</span><br><span class="math inline">\(0 = - C_{12} s v_{12} + v_{10} \left(C_{12} s + \frac{1}{R_{20}} + \frac{1}{R_{17}} + \frac{1}{R_{16}}\right) - \frac{v_{2}}{R_{20}} - \frac{v_{5}}{R_{17}} - \frac{v_{9}}{R_{16}}\)</span><br><span class="math inline">\(0 = - C_{11} s v_{9} + v_{11} \left(C_{11} s + \frac{1}{R_{15}}\right) - \frac{v_{5}}{R_{15}}\)</span><br><span class="math inline">\(0 = - C_{12} s v_{10} + v_{12} \left(C_{12} s + \frac{1}{R_{18}}\right) - \frac{v_{5}}{R_{18}}\)</span><br><span class="math inline">\(V_{1} = v_{1}\)</span><br><span class="math inline">\(V_{2} = v_{6}\)</span><br><span class="math inline">\(0 = v_{10}\)</span><br></p>
</div>
</div>
<p>The free symbols in the equations above are turned into SymPy variables and the element values are loaded into a Python dictionary.</p>
<div id="864333ed-f60f-4467-b46e-d820f5091406" class="cell" data-execution_count="55">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>var(<span class="bu">str</span>(NE_sym.free_symbols).replace(<span class="st">'{'</span>,<span class="st">''</span>).replace(<span class="st">'}'</span>,<span class="st">''</span>))</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>element_values <span class="op">=</span> SymMNA.get_part_values(network_df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="numerical-solution-for-p1-at-50-2" class="level4" data-number="27.3.3.1">
<h4 data-number="27.3.3.1" class="anchored" data-anchor-id="numerical-solution-for-p1-at-50-2"><span class="header-section-number">27.3.3.1</span> Numerical Solution for P1 at 50%</h4>
<p>The network equations were too complex to generate symbolic solutions on my laptop. A numerical solution for the equations can easily be generated and this was done for <span class="math inline">\(P_1\)</span> = 50%. The element values are substituted into the equations and displayed.</p>
<div id="26996b6a-8b3d-43c7-817b-5c9ba5aacebe" class="cell" data-execution_count="56">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>equ_N <span class="op">=</span> NE_sym.subs(element_values)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> <span class="st">''</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(shape(equ_N.lhs)[<span class="dv">0</span>]):</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    temp <span class="op">+=</span> <span class="st">'&lt;p&gt;$</span><span class="sc">{:s}</span><span class="st"> = </span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;'</span>.<span class="bu">format</span>(latex(equ_N.rhs[i]),</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>        latex(round_expr(equ_N.lhs[i],<span class="dv">9</span>)))</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>Markdown(temp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="56">
<p>
<span class="math inline">\(0 = I_{V1} + v_{1} \cdot \left(6.8 \cdot 10^{-8} s + 0.000196078\right) + v_{3} \left(- 6.8 \cdot 10^{-8} s - 0.000196078\right)\)</span>
</p>
<p>
<span class="math inline">\(0 = I_{O2a} - 2.551 \cdot 10^{-6} v_{10} + 2.551 \cdot 10^{-6} v_{2}\)</span>
</p>
<p>
<span class="math inline">\(0 = - 3.9 \cdot 10^{-7} s v_{4} + v_{1} \left(- 6.8 \cdot 10^{-8} s - 0.000196078\right) + v_{3} \cdot \left(4.58 \cdot 10^{-7} s + 0.000882745\right) - 2.0 \cdot 10^{-5} v_{5}\)</span>
</p>
<p>
<span class="math inline">\(0 = - 3.9 \cdot 10^{-7} s v_{3} + v_{4} \cdot \left(3.9 \cdot 10^{-7} s + 0.001\right)\)</span>
</p>
<p>
<span class="math inline">\(0 = - 3.7037 \cdot 10^{-5} v_{10} - 4.5455 \cdot 10^{-5} v_{11} - 8.3333 \cdot 10^{-5} v_{12} - 2.0 \cdot 10^{-5} v_{3} + 0.000205825 v_{5}\)</span>
</p>
<p>
<span class="math inline">\(0 = I_{V2} + 1.0 \cdot 10^{-6} s v_{6} - 1.0 \cdot 10^{-6} s v_{7}\)</span>
</p>
<p>
<span class="math inline">\(0 = - 1.0 \cdot 10^{-6} s v_{6} + v_{7} \cdot \left(1.0 \cdot 10^{-6} s + 0.001\right) - 0.001 v_{8}\)</span>
</p>
<p>
<span class="math inline">\(0 = - 1.0 \cdot 10^{-6} s v_{9} - 0.001 v_{7} + v_{8} \cdot \left(1.0 \cdot 10^{-6} s + 0.001\right)\)</span>
</p>
<p>
<span class="math inline">\(0 = - 2.0 \cdot 10^{-9} s v_{11} - 1.0 \cdot 10^{-6} s v_{8} - 2.1277 \cdot 10^{-5} v_{10} + v_{9} \cdot \left(1.002 \cdot 10^{-6} s + 2.1277 \cdot 10^{-5}\right)\)</span>
</p>
<p>
<span class="math inline">\(0 = - 2.7 \cdot 10^{-8} s v_{12} + v_{10} \cdot \left(2.7 \cdot 10^{-8} s + 6.0865 \cdot 10^{-5}\right) - 2.551 \cdot 10^{-6} v_{2} - 3.7037 \cdot 10^{-5} v_{5} - 2.1277 \cdot 10^{-5} v_{9}\)</span>
</p>
<p>
<span class="math inline">\(0 = - 2.0 \cdot 10^{-9} s v_{9} + v_{11} \cdot \left(2.0 \cdot 10^{-9} s + 4.5455 \cdot 10^{-5}\right) - 4.5455 \cdot 10^{-5} v_{5}\)</span>
</p>
<p>
<span class="math inline">\(0 = - 2.7 \cdot 10^{-8} s v_{10} + v_{12} \cdot \left(2.7 \cdot 10^{-8} s + 8.3333 \cdot 10^{-5}\right) - 8.3333 \cdot 10^{-5} v_{5}\)</span>
</p>
<p>
<span class="math inline">\(1.0 = v_{1}\)</span>
</p>
<p>
<span class="math inline">\(0 = v_{6}\)</span>
</p>
<p>
<span class="math inline">\(0 = v_{10}\)</span>
</p>
</div>
</div>
<p>Use SymPy to solve for the unknown voltages and currents in the network equations. The unknown currents, <span class="math inline">\(I_{V1}\)</span> and <span class="math inline">\(I_{O1}\)</span>, are not displayed. The node voltages are:</p>
<div id="c1c33795-33d0-4291-b132-0b1f1d1e7573" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;jupyter&quot;,&quot;value&quot;:{&quot;outputs_hidden&quot;:false}}" data-execution_count="57">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>U <span class="op">=</span> solve(equ_N,X)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> <span class="st">''</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> U.keys():</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">str</span>(i)[<span class="dv">0</span>] <span class="op">==</span> <span class="st">'v'</span>: <span class="co"># only display the node voltages</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>        temp <span class="op">+=</span> <span class="st">'&lt;p&gt;$</span><span class="sc">{:s}</span><span class="st"> = </span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;'</span>.<span class="bu">format</span>(latex(i),latex(U[i]))</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>Markdown(temp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="57">
<p>
<span class="math inline">\(v_{1} = 1.0\)</span>
</p>
<p>
<span class="math inline">\(v_{2} = \frac{- 2.02215504303191 \cdot 10^{56} s^{5} - 5.2950674540929 \cdot 10^{60} s^{4} - 2.8308370994823 \cdot 10^{64} s^{3} - 5.27827462462547 \cdot 10^{67} s^{2} - 3.01998947548071 \cdot 10^{70} s - 1.16148974096409 \cdot 10^{72}}{4.3362244543883 \cdot 10^{55} s^{5} + 2.06897279791109 \cdot 10^{60} s^{4} + 2.53915433684715 \cdot 10^{64} s^{3} + 5.64733157523515 \cdot 10^{67} s^{2} + 3.55388545376323 \cdot 10^{70} s + 1.37913277012933 \cdot 10^{72}}\)</span>
</p>
<p>
<span class="math inline">\(v_{3} = \frac{7.70884347446809 \cdot 10^{55} s^{5} + 1.76830244412326 \cdot 10^{60} s^{4} + 9.75686883763291 \cdot 10^{63} s^{3} + 2.00756023341467 \cdot 10^{67} s^{2} + 1.40196836955285 \cdot 10^{70} s + 5.47822825670137 \cdot 10^{71}}{7.70884347446809 \cdot 10^{55} s^{5} + 3.67817386295305 \cdot 10^{60} s^{4} + 4.51405215439493 \cdot 10^{64} s^{3} + 1.00397005781958 \cdot 10^{68} s^{2} + 6.31801858446797 \cdot 10^{70} s + 2.45179159134104 \cdot 10^{72}}\)</span>
</p>
<p>
<span class="math inline">\(v_{4} = \frac{7.70884347446809 \cdot 10^{55} s^{5} + 1.57063979093177 \cdot 10^{60} s^{4} + 5.72958732242324 \cdot 10^{63} s^{3} + 5.3843527894717 \cdot 10^{66} s^{2} + 2.13650902011353 \cdot 10^{68} s}{7.70884347446809 \cdot 10^{55} s^{5} + 3.67817386295305 \cdot 10^{60} s^{4} + 4.51405215439493 \cdot 10^{64} s^{3} + 1.00397005781958 \cdot 10^{68} s^{2} + 6.31801858446797 \cdot 10^{70} s + 2.45179159134104 \cdot 10^{72}}\)</span>
</p>
<p>
<span class="math inline">\(v_{5} = \frac{4.72614965425532 \cdot 10^{53} s^{5} + 1.34411248109 \cdot 10^{58} s^{4} + 9.21167841492205 \cdot 10^{61} s^{3} + 2.41846205484128 \cdot 10^{65} s^{2} + 2.24113593696666 \cdot 10^{68} s + 8.88895209921494 \cdot 10^{69}}{4.81802717154256 \cdot 10^{54} s^{5} + 2.29885866434566 \cdot 10^{59} s^{4} + 2.82128259649683 \cdot 10^{63} s^{3} + 6.27481286137239 \cdot 10^{66} s^{2} + 3.94876161529248 \cdot 10^{69} s + 1.53236974458815 \cdot 10^{71}}\)</span>
</p>
<p>
<span class="math inline">\(v_{6} = 0.0\)</span>
</p>
<p>
<span class="math inline">\(v_{7} = \frac{2.0138625 \cdot 10^{55} s^{4} + 1.71863602941176 \cdot 10^{59} s^{3} + 4.87499999999999 \cdot 10^{62} s^{2} + 4.59558823529411 \cdot 10^{65} s}{4.81802717154256 \cdot 10^{54} s^{5} + 2.29885866434566 \cdot 10^{59} s^{4} + 2.82128259649683 \cdot 10^{63} s^{3} + 6.27481286137239 \cdot 10^{66} s^{2} + 3.94876161529248 \cdot 10^{69} s + 1.53236974458815 \cdot 10^{71}}\)</span>
</p>
<p>
<span class="math inline">\(v_{8} = \frac{2.0138625 \cdot 10^{52} s^{5} + 1.92002227941176 \cdot 10^{56} s^{4} + 6.59363602941176 \cdot 10^{59} s^{3} + 9.47058823529411 \cdot 10^{62} s^{2} + 4.59558823529411 \cdot 10^{65} s}{4.81802717154256 \cdot 10^{54} s^{5} + 2.29885866434566 \cdot 10^{59} s^{4} + 2.82128259649683 \cdot 10^{63} s^{3} + 6.27481286137239 \cdot 10^{66} s^{2} + 3.94876161529248 \cdot 10^{69} s + 1.53236974458815 \cdot 10^{71}}\)</span>
</p>
<p>
<span class="math inline">\(v_{9} = \frac{2.0138625 \cdot 10^{52} s^{5} + 2.12140852941176 \cdot 10^{56} s^{4} + 8.31227205882352 \cdot 10^{59} s^{3} + 1.43455882352941 \cdot 10^{63} s^{2} + 9.19117647058822 \cdot 10^{65} s}{4.81802717154256 \cdot 10^{54} s^{5} + 2.29885866434566 \cdot 10^{59} s^{4} + 2.82128259649683 \cdot 10^{63} s^{3} + 6.27481286137239 \cdot 10^{66} s^{2} + 3.94876161529248 \cdot 10^{69} s + 1.53236974458815 \cdot 10^{71}}\)</span>
</p>
<p>
<span class="math inline">\(v_{10} = 0.0\)</span>
</p>
<p>
<span class="math inline">\(v_{11} = \frac{2.0138625 \cdot 10^{52} s^{5} + 9.56082557247695 \cdot 10^{57} s^{4} + 8.10026990741267 \cdot 10^{61} s^{3} + 2.31064415746956 \cdot 10^{65} s^{2} + 2.23683368415064 \cdot 10^{68} s + 8.88895209921494 \cdot 10^{69}}{4.81802717154256 \cdot 10^{54} s^{5} + 2.29885866434566 \cdot 10^{59} s^{4} + 2.82128259649683 \cdot 10^{63} s^{3} + 6.27481286137239 \cdot 10^{66} s^{2} + 3.94876161529248 \cdot 10^{69} s + 1.53236974458815 \cdot 10^{71}}\)</span>
</p>
<p>
<span class="math inline">\(v_{12} = \frac{1.45868816489362 \cdot 10^{57} s^{4} + 3.69828291543406 \cdot 10^{61} s^{3} + 1.70166527761975 \cdot 10^{65} s^{2} + 2.2123357321652 \cdot 10^{68} s + 8.88895209921494 \cdot 10^{69}}{4.81802717154256 \cdot 10^{54} s^{5} + 2.29885866434566 \cdot 10^{59} s^{4} + 2.82128259649683 \cdot 10^{63} s^{3} + 6.27481286137239 \cdot 10^{66} s^{2} + 3.94876161529248 \cdot 10^{69} s + 1.53236974458815 \cdot 10^{71}}\)</span>
</p>
</div>
</div>
<p>The network transfer function, <span class="math inline">\(H(s)=\frac {v_2(s)}{v_1(s)}\)</span>, is:</p>
<div id="824d233c-7b54-4cef-a41e-ddcad56023b8" class="cell" data-execution_count="58">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>H <span class="op">=</span> (U[v2]<span class="op">/</span>U[v1]).cancel()</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'$H(s)=</span><span class="sc">{:s}</span><span class="st">$'</span>.<span class="bu">format</span>(latex(H)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="58">
<p><span class="math inline">\(H(s)=\frac{- 2.02215504303191 \cdot 10^{56} s^{5} - 5.2950674540929 \cdot 10^{60} s^{4} - 2.8308370994823 \cdot 10^{64} s^{3} - 5.27827462462547 \cdot 10^{67} s^{2} - 3.01998947548071 \cdot 10^{70} s - 1.16148974096409 \cdot 10^{72}}{4.3362244543883 \cdot 10^{55} s^{5} + 2.06897279791109 \cdot 10^{60} s^{4} + 2.53915433684715 \cdot 10^{64} s^{3} + 5.64733157523515 \cdot 10^{67} s^{2} + 3.55388545376323 \cdot 10^{70} s + 1.37913277012933 \cdot 10^{72}}\)</span></p>
</div>
</div>
<p>The code below extracts the numerator and denominator polynomials from the voltage transfer function. Then coefficients of the terms are used to build a SciPy transfer function object.</p>
<div id="8f6b42e5-5c45-4953-80b5-3fb21e96222e" class="cell" data-execution_count="59">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>H_num, H_denom <span class="op">=</span> fraction(H) <span class="co">#returns numerator and denominator</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert symbolic to NumPy polynomial</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array(Poly(H_num, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array(Poly(H_denom, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>sys_tf <span class="op">=</span> signal.TransferFunction(a,b)</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>sys_zeros <span class="op">=</span> np.roots(sys_tf.num)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>sys_poles <span class="op">=</span> np.roots(sys_tf.den)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The poles and zeros of the transfer function are plotted on the complex frequency plane with the following code:</p>
<div id="92381655-48e4-45c7-8565-7258e8d218c6" class="cell" data-execution_count="60">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>plt.plot(np.real(sys_zeros<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)), np.imag(sys_zeros<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)), <span class="st">'ob'</span>, markerfacecolor<span class="op">=</span><span class="st">'none'</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>plt.plot(np.real(sys_poles<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)), np.imag(sys_poles<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)), <span class="st">'xr'</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">'Zeros'</span>, <span class="st">'Poles'</span>], loc<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Pole / Zero Plot for P1=50%'</span>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'real part, </span><span class="ch">\u03B1</span><span class="st">'</span>)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'imaginary part, j</span><span class="ch">\u03C9</span><span class="st">'</span>)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Klon Centaur part 3v1_files/figure-html/cell-61-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The code below generates a table that lists the values of the pole and zero locations.</p>
<div id="5915f235-7c02-429a-ba59-a30cd9fbb65c" class="cell" data-execution_count="61">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>table_header <span class="op">=</span> [<span class="st">'Zeros, Hz'</span>, <span class="st">'Poles, Hz'</span>]</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>num_table_rows <span class="op">=</span> <span class="bu">max</span>(<span class="bu">len</span>(sys_zeros),<span class="bu">len</span>(sys_poles))</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>table_row <span class="op">=</span> []</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_table_rows):</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">&lt;</span> <span class="bu">len</span>(sys_zeros):</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>        z <span class="op">=</span> <span class="st">'</span><span class="sc">{:.2f}</span><span class="st">'</span>.<span class="bu">format</span>(sys_zeros[i]<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi))</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>        z <span class="op">=</span> <span class="st">''</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">&lt;</span> <span class="bu">len</span>(sys_poles):</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>        p <span class="op">=</span> <span class="st">'</span><span class="sc">{:.2f}</span><span class="st">'</span>.<span class="bu">format</span>(sys_poles[i]<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi))</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>        p <span class="op">=</span> <span class="st">''</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>    table_row.append([z,p])</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tabulate(table_row, headers<span class="op">=</span>table_header,colalign <span class="op">=</span> (<span class="st">'left'</span>,<span class="st">'left'</span>),tablefmt<span class="op">=</span><span class="st">"simple"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Zeros, Hz    Poles, Hz
-----------  -----------
-3142.62     -4629.79
-458.92      -2545.69
-408.09      -231.62
-151.29      -180.17
-6.59        -6.6</code></pre>
</div>
</div>
</section>
<section id="polezero-locus-plot-versus-p1-value" class="level4" data-number="27.3.3.2">
<h4 data-number="27.3.3.2" class="anchored" data-anchor-id="polezero-locus-plot-versus-p1-value"><span class="header-section-number">27.3.3.2</span> Pole/Zero Locus Plot versus P1 value</h4>
<p>There are 5 zeros and poles in the voltage transfer function. Solutions for the values of the poles and zeros as a function of <span class="math inline">\(P_1\)</span>’s rotational position are saved to an array.</p>
<div id="f68baf81-4d56-400a-a12e-7d738e9118d7" class="cell" data-execution_count="62">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>p1_value <span class="op">=</span> <span class="fl">100e3</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>num_roots <span class="op">=</span> []</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>denom_roots <span class="op">=</span> []</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.linspace(<span class="dv">1</span>,<span class="dv">99</span>,<span class="dv">20</span>)<span class="op">/</span><span class="dv">100</span>:</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    element_values[Rp1a2] <span class="op">=</span> p1_value <span class="op">-</span> i<span class="op">*</span>p1_value</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>    element_values[Rp1b2] <span class="op">=</span> i<span class="op">*</span>p1_value</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>    NE <span class="op">=</span> NE_sym.subs(element_values)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>    U <span class="op">=</span> solve(NE,X)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>    H <span class="op">=</span> U[v2]<span class="op">/</span>U[v1]</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    num, denom <span class="op">=</span> fraction(H) <span class="co">#returns numerator and denominator</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># convert symbolic to NumPy polynomial</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> np.array(Poly(num, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> np.array(Poly(denom, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)    </span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>    sys_tf <span class="op">=</span> signal.TransferFunction(a,b)</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>    num_roots.append(np.roots(sys_tf.num))</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>    denom_roots.append(np.roots(sys_tf.den))</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a><span class="co"># put the zeros into an array</span></span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>z0_locus <span class="op">=</span> np.zeros(<span class="bu">len</span>(np.array(num_roots)))</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>z1_locus <span class="op">=</span> np.zeros(<span class="bu">len</span>(np.array(num_roots)))</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>z2_locus <span class="op">=</span> np.zeros(<span class="bu">len</span>(np.array(num_roots)))</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>z3_locus <span class="op">=</span> np.zeros(<span class="bu">len</span>(np.array(num_roots)))</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>z4_locus <span class="op">=</span> np.zeros(<span class="bu">len</span>(np.array(num_roots)))</span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(np.array(num_roots))):</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>    z0_locus[i] <span class="op">=</span> <span class="op">-</span>np.array(num_roots)[i][<span class="dv">0</span>]    </span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>    z1_locus[i] <span class="op">=</span> <span class="op">-</span>np.array(num_roots)[i][<span class="dv">1</span>]        </span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>    z2_locus[i] <span class="op">=</span> <span class="op">-</span>np.array(num_roots)[i][<span class="dv">2</span>]    </span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>    z3_locus[i] <span class="op">=</span> <span class="op">-</span>np.array(num_roots)[i][<span class="dv">3</span>]  </span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a>    z4_locus[i] <span class="op">=</span> <span class="op">-</span>np.array(num_roots)[i][<span class="dv">4</span>]    </span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a><span class="co"># put the poles into an array</span></span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a>p0_locus <span class="op">=</span> np.zeros(<span class="bu">len</span>(np.array(denom_roots)))</span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a>p1_locus <span class="op">=</span> np.zeros(<span class="bu">len</span>(np.array(denom_roots)))</span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a>p2_locus <span class="op">=</span> np.zeros(<span class="bu">len</span>(np.array(denom_roots)))</span>
<span id="cb66-39"><a href="#cb66-39" aria-hidden="true" tabindex="-1"></a>p3_locus <span class="op">=</span> np.zeros(<span class="bu">len</span>(np.array(denom_roots)))</span>
<span id="cb66-40"><a href="#cb66-40" aria-hidden="true" tabindex="-1"></a>p4_locus <span class="op">=</span> np.zeros(<span class="bu">len</span>(np.array(denom_roots)))</span>
<span id="cb66-41"><a href="#cb66-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-42"><a href="#cb66-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(np.array(denom_roots))):</span>
<span id="cb66-43"><a href="#cb66-43" aria-hidden="true" tabindex="-1"></a>    p0_locus[i] <span class="op">=</span> <span class="op">-</span>np.array(denom_roots)[i][<span class="dv">0</span>]    </span>
<span id="cb66-44"><a href="#cb66-44" aria-hidden="true" tabindex="-1"></a>    p1_locus[i] <span class="op">=</span> <span class="op">-</span>np.array(denom_roots)[i][<span class="dv">1</span>]       </span>
<span id="cb66-45"><a href="#cb66-45" aria-hidden="true" tabindex="-1"></a>    p2_locus[i] <span class="op">=</span> <span class="op">-</span>np.array(denom_roots)[i][<span class="dv">2</span>]      </span>
<span id="cb66-46"><a href="#cb66-46" aria-hidden="true" tabindex="-1"></a>    p3_locus[i] <span class="op">=</span> <span class="op">-</span>np.array(denom_roots)[i][<span class="dv">3</span>]      </span>
<span id="cb66-47"><a href="#cb66-47" aria-hidden="true" tabindex="-1"></a>    p4_locus[i] <span class="op">=</span> <span class="op">-</span>np.array(denom_roots)[i][<span class="dv">4</span>]      </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The range of values the zeros take on as a function of <span class="math inline">\(P_1\)</span> is printed below.</p>
<div id="9358d72a-44e1-4a54-9300-7c1fc706f4ff" class="cell" data-execution_count="63">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'z0 range as a function of P1: </span><span class="sc">{</span>z0_locus<span class="sc">.</span><span class="bu">min</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> to </span><span class="sc">{</span>z0_locus<span class="sc">.</span><span class="bu">max</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> kHz'</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'z1 range as a function of P1: </span><span class="sc">{</span>z1_locus<span class="sc">.</span><span class="bu">min</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> to </span><span class="sc">{</span>z1_locus<span class="sc">.</span><span class="bu">max</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> kHz'</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'z2 range as a function of P1: </span><span class="sc">{</span>z2_locus<span class="sc">.</span><span class="bu">min</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> to </span><span class="sc">{</span>z2_locus<span class="sc">.</span><span class="bu">max</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> kHz'</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'z3 range as a function of P1: </span><span class="sc">{</span>z3_locus<span class="sc">.</span><span class="bu">min</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> to </span><span class="sc">{</span>z3_locus<span class="sc">.</span><span class="bu">max</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> kHz'</span>)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'z4 range as a function of P1: </span><span class="sc">{</span>z4_locus<span class="sc">.</span><span class="bu">min</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> to </span><span class="sc">{</span>z4_locus<span class="sc">.</span><span class="bu">max</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> kHz'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>z0 range as a function of P1: 3.143 to 3.143 kHz
z1 range as a function of P1: 0.459 to 0.459 kHz
z2 range as a function of P1: 0.408 to 0.408 kHz
z3 range as a function of P1: 0.151 to 0.151 kHz
z4 range as a function of P1: 0.007 to 0.007 kHz</code></pre>
</div>
</div>
<p>As shown above, the zeros of the transfer function don’t change with <span class="math inline">\(P_1\)</span>.</p>
<p>The range of values the poles take on as a function of <span class="math inline">\(P_1\)</span> is printed below.</p>
<div id="9044453c-54b7-488b-b06a-a894a128b26e" class="cell" data-execution_count="64">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'p0 range as a function of P1: </span><span class="sc">{</span>p0_locus<span class="sc">.</span><span class="bu">min</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> to </span><span class="sc">{</span>p0_locus<span class="sc">.</span><span class="bu">max</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> kHz'</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'p1 range as a function of P1: </span><span class="sc">{</span>p1_locus<span class="sc">.</span><span class="bu">min</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> to </span><span class="sc">{</span>p1_locus<span class="sc">.</span><span class="bu">max</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> kHz'</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'p2 range as a function of P1: </span><span class="sc">{</span>p2_locus<span class="sc">.</span><span class="bu">min</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> to </span><span class="sc">{</span>p2_locus<span class="sc">.</span><span class="bu">max</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> kHz'</span>)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'p3 range as a function of P1: </span><span class="sc">{</span>p3_locus<span class="sc">.</span><span class="bu">min</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> to </span><span class="sc">{</span>p3_locus<span class="sc">.</span><span class="bu">max</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> kHz'</span>)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'p4 range as a function of P1: </span><span class="sc">{</span>p4_locus<span class="sc">.</span><span class="bu">min</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> to </span><span class="sc">{</span>p4_locus<span class="sc">.</span><span class="bu">max</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> kHz'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>p0 range as a function of P1: 4.611 to 5.043 kHz
p1 range as a function of P1: 2.546 to 3.046 kHz
p2 range as a function of P1: 0.232 to 0.455 kHz
p3 range as a function of P1: 0.179 to 0.181 kHz
p4 range as a function of P1: 0.007 to 0.007 kHz</code></pre>
</div>
</div>
<p>As shown above the poles of the transfer function vary with <span class="math inline">\(P_1\)</span>, and these are plotted below.</p>
<div id="7e338a8e-a920-40a0-80a9-590fef74139f" class="cell" data-execution_count="65">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>plt.plot(np.linspace(<span class="dv">1</span>,<span class="dv">99</span>,<span class="bu">len</span>(np.array(denom_roots))),p0_locus<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span>,<span class="st">'x-'</span>, markerfacecolor<span class="op">=</span><span class="st">'none'</span>,label<span class="op">=</span><span class="st">'p_0'</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>plt.plot(np.linspace(<span class="dv">1</span>,<span class="dv">99</span>,<span class="bu">len</span>(np.array(denom_roots))),p1_locus<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span>,<span class="st">'x-'</span>, markerfacecolor<span class="op">=</span><span class="st">'none'</span>,label<span class="op">=</span><span class="st">'p_1'</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>plt.plot(np.linspace(<span class="dv">1</span>,<span class="dv">99</span>,<span class="bu">len</span>(np.array(denom_roots))),p2_locus<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span>,<span class="st">'x-'</span>, markerfacecolor<span class="op">=</span><span class="st">'none'</span>,label<span class="op">=</span><span class="st">'p_2'</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>plt.plot(np.linspace(<span class="dv">1</span>,<span class="dv">99</span>,<span class="bu">len</span>(np.array(denom_roots))),p3_locus<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span>,<span class="st">'x-'</span>, markerfacecolor<span class="op">=</span><span class="st">'none'</span>,label<span class="op">=</span><span class="st">'p_3'</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>plt.ylim((<span class="dv">0</span>,<span class="dv">6</span>))</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Gain control pole frequency plot vs gain pot rotation %'</span>)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Gain rotation percentage'</span>)</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'pole and zero frequency, kHz'</span>)</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Klon Centaur part 3v1_files/figure-html/cell-66-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>As shown in the plots above, the pole locations don’t change all that much as a function of <span class="math inline">\(P_1\)</span> rotation.</p>
</section>
<section id="reactive-branch-3-frequency-response" class="level4" data-number="27.3.3.3">
<h4 data-number="27.3.3.3" class="anchored" data-anchor-id="reactive-branch-3-frequency-response"><span class="header-section-number">27.3.3.3</span> Reactive Branch 3 Frequency Response</h4>
<p>The plot below shows the magnitude and phase of voltage transfer function versus frequency at various positions of <span class="math inline">\(P_1\)</span>.</p>
<div id="d16ad5ae-b728-401a-9b50-15d5c57e49b7" class="cell" data-execution_count="66">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># setup</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>x_axis <span class="op">=</span> np.logspace(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">2000</span>, endpoint<span class="op">=</span><span class="va">False</span>)<span class="op">*</span><span class="dv">2</span><span class="op">*</span>np.pi</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>color_list <span class="op">=</span> [<span class="st">'tab:blue'</span>,<span class="st">'tab:red'</span>,<span class="st">'tab:green'</span>,<span class="st">'tab:orange'</span>,<span class="st">'k'</span>]</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>gain_setting <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">25</span>,<span class="dv">50</span>,<span class="dv">75</span>,<span class="dv">99</span>])<span class="op">/</span><span class="dv">100</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>p1_value <span class="op">=</span> <span class="fl">100e3</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>fig, ax1 <span class="op">=</span> plt.subplots()</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'magnitude, dB'</span>)</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'frequency, Hz'</span>)</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a><span class="co"># instantiate a second y-axes that shares the same x-axis</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> ax1.twinx()</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>color <span class="op">=</span> <span class="st">'k'</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'phase, deg'</span>,color<span class="op">=</span>color)</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>ax2.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelcolor<span class="op">=</span>color)</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(gain_setting)):</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>    element_values[Rp1a2] <span class="op">=</span> p1_value <span class="op">-</span> gain_setting[i]<span class="op">*</span>p1_value</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>    element_values[Rp1b2] <span class="op">=</span> gain_setting[i]<span class="op">*</span>p1_value</span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">#element_values[Rp1a2] = p1_value - gain_setting[i]*p1_value</span></span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">#element_values[Rp1b2] = gain_setting[i]*p1_value</span></span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a>    NE <span class="op">=</span> NE_sym.subs(element_values)</span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a>    U <span class="op">=</span> solve(NE,X)</span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>    H <span class="op">=</span> U[v2]<span class="op">/</span>U[v1]</span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a>    num, denom <span class="op">=</span> fraction(H) <span class="co">#returns numerator and denominator</span></span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># convert symbolic to NumPy polynomial</span></span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> np.array(Poly(num, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> np.array(Poly(denom, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a>    <span class="co">#tf_num_coef_list.append(a)</span></span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a>    <span class="co">#tf_denom_coef_list.append(b)</span></span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a>    <span class="co">#x = np.logspace(1, 5, 2000, endpoint=False)*2*np.pi</span></span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a>    w, mag, phase <span class="op">=</span> signal.bode((a, b), w<span class="op">=</span>x_axis) <span class="co"># returns: rad/s, mag in dB, phase in deg</span></span>
<span id="cb72-39"><a href="#cb72-39" aria-hidden="true" tabindex="-1"></a>    <span class="co">#clean_path1_mag[i] = mag</span></span>
<span id="cb72-40"><a href="#cb72-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb72-41"><a href="#cb72-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot the results.  </span></span>
<span id="cb72-42"><a href="#cb72-42" aria-hidden="true" tabindex="-1"></a>    ax1.semilogx(w<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi), mag,<span class="st">'-'</span>,color<span class="op">=</span>color_list[i],label<span class="op">=</span><span class="st">'mag: </span><span class="sc">{:.0f}</span><span class="st">%'</span>.<span class="bu">format</span>(gain_setting[i]<span class="op">*</span><span class="dv">100</span>))    <span class="co"># magnitude plot</span></span>
<span id="cb72-43"><a href="#cb72-43" aria-hidden="true" tabindex="-1"></a>    ax2.semilogx(w<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi), phase,<span class="st">':'</span>,color<span class="op">=</span>color_list[i],label<span class="op">=</span><span class="st">'phase: </span><span class="sc">{:.0f}</span><span class="st">%'</span>.<span class="bu">format</span>(gain_setting[i]<span class="op">*</span><span class="dv">100</span>))  <span class="co"># phase plot</span></span>
<span id="cb72-44"><a href="#cb72-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-45"><a href="#cb72-45" aria-hidden="true" tabindex="-1"></a><span class="co"># highlight the guitar audio band, 80 to 8kHz</span></span>
<span id="cb72-46"><a href="#cb72-46" aria-hidden="true" tabindex="-1"></a>plt.axvspan(<span class="dv">80</span>, <span class="fl">8e3</span>, color<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>) </span>
<span id="cb72-47"><a href="#cb72-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-48"><a href="#cb72-48" aria-hidden="true" tabindex="-1"></a><span class="co"># position legends outside the graph</span></span>
<span id="cb72-49"><a href="#cb72-49" aria-hidden="true" tabindex="-1"></a>ax1.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.6</span>,<span class="dv">1</span>)) <span class="co"># magnitude legend position: relative (horizontal position, vertical position) </span></span>
<span id="cb72-50"><a href="#cb72-50" aria-hidden="true" tabindex="-1"></a>ax2.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.6</span>,<span class="fl">0.5</span>)) <span class="co"># phase legend position:</span></span>
<span id="cb72-51"><a href="#cb72-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-52"><a href="#cb72-52" aria-hidden="true" tabindex="-1"></a><span class="co">#ax1.legend(loc='lower left')</span></span>
<span id="cb72-53"><a href="#cb72-53" aria-hidden="true" tabindex="-1"></a><span class="co">#ax2.legend(loc='lower right')</span></span>
<span id="cb72-54"><a href="#cb72-54" aria-hidden="true" tabindex="-1"></a>ax1.grid()</span>
<span id="cb72-55"><a href="#cb72-55" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Magnitude and phase response'</span>)</span>
<span id="cb72-56"><a href="#cb72-56" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.savefig('plt_rb_3.png')</span></span>
<span id="cb72-57"><a href="#cb72-57" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Klon Centaur part 3v1_files/figure-html/cell-67-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The magnitude and phase of voltage transfer function for reactive branch 3 shows about a 20 dB increase in gain over the guitar frequency band.</p>
<p>Keep in mind that <span class="math inline">\(C_{13}\)</span> and <span class="math inline">\(R_{20}\)</span> put a pole into the voltage transfer function at about 500 Hz, which reduces the frequency emphasis plotted above. This can be easily seen if <span class="math inline">\(C_{13}\)</span> is included in the netlist and the analysis above is re-run. Poles and zeros with C13 as shown below, notice the addition of a pole at 495 Hz.</p>
<pre><code>Zeros, Hz    Poles, Hz
-----------  -----------
-3142.62     -4629.79
-458.92      -2545.69
-408.09      -495.13
-151.29      -231.62
-6.59        -180.17
             -6.6</code></pre>
<p>The plot of transfer function with <span class="math inline">\(C_{13}\)</span> included in the analysis is:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="plt_rb_3.png" class="img-fluid figure-img"></p>
<figcaption>Frequency response of reactive branch 3 with C13 included in the analysis.</figcaption>
</figure>
</div>
<p>Notice that zero at 500 Hz now dominates the shape of the transfer function, which is now somewhat flat over the guitar band and a low pass filter with a cutoff starting around 3 kHz.</p>
</section>
</section>
<section id="sec-reactive_branch_3a" class="level3" data-number="27.3.4">
<h3 data-number="27.3.4" class="anchored" data-anchor-id="sec-reactive_branch_3a"><span class="header-section-number">27.3.4</span> Reactive Branch 3a</h3>
<p>The schematic shown below is a sub-circuit of reactive branch 3 from <span class="math inline">\(V_1\)</span> to <span class="math inline">\(P_1\)</span> (in the schematic below, the reference designator for <span class="math inline">\(P_1\)</span> is <span class="math inline">\(R_{p1ab2}\)</span> since <span class="math inline">\(P_1\)</span> is modeled as two resistors.). In <a href="#fig-Reactive_branch_3a" class="quarto-xref">Figure&nbsp;<span>27.4</span></a>, the nodes have been renumbered and <span class="math inline">\(P_1\)</span> has been replaced by a fixed value resistor of 100 k<span class="math inline">\(\Omega\)</span>.</p>
<p>The branch from node 1 to node 3 is composed of components <span class="math inline">\(R_5\)</span> and <span class="math inline">\(C_4\)</span>, and these have a resonant frequency of about 450 Hz. <span class="math inline">\(R_5\)</span> and <span class="math inline">\(C_4\)</span> are in parallel with each other and in series with the signal path and this arrangement forms a zero in the voltage transfer function. The components <span class="math inline">\(R_9\)</span> and <span class="math inline">\(C_6\)</span> are in series with each other and have a resonant frequency of about 400 Hz and present a shunt to the signal path, which produces a second zero in the voltage transfer function. By inspection we can see the gain is <span class="math inline">\((R_8||P_1)/(R_5+R_8||P_1)\)</span> at <span class="math inline">\(\omega=0\)</span> since the capacitors are open circuits at DC. At high frequency the gain is 1 since <span class="math inline">\(C_4\)</span> looks like a short at high frequency.</p>
<div id="fig-Reactive_branch_3a" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Reactive_branch_3a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Reactive_branch_3a.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Reactive_branch_3a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;27.4: Schematic of reactive branch 3a.
</figcaption>
</figure>
</div>
<p>The netlist below was obtained from the LTSpice schematic.</p>
<div id="c196f0a9-26ff-48c2-a938-0cc9b7ba3644" class="cell" data-execution_count="67">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>reactive_branch_3_4_a_net_list <span class="op">=</span> <span class="st">'''</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="st">* Reactive_branch_3&amp;4_a.asc</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="st">R5 1 2 5.1e3</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="st">R8 2 0 1.5e3</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="st">C4 1 2 68e-9</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="st">C6 2 3 390e-9</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="st">R9 3 0 1e3</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="st">Rp1ab2 2 0 100e3</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="st">V1 1 0 1</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="st">'''</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The MNA matrices are generated by calling <code>SymMNA.smna</code>.</p>
<div id="ac025baa-7adb-4464-b3f1-f033520d0190" class="cell" data-execution_count="68">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>report, network_df, i_unk_df, A, X, Z <span class="op">=</span> SymMNA.smna(reactive_branch_3_4_a_net_list)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The network equations are built from the MNA matrices.</p>
<div id="07cff683-bba3-4d4a-9913-cc631454188e" class="cell" data-execution_count="69">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Put matrices into SymPy </span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> Matrix(X)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> Matrix(Z)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>NE_sym <span class="op">=</span> Eq(A<span class="op">*</span>X,Z)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="co"># display the equations</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> <span class="st">''</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(shape(NE_sym.lhs)[<span class="dv">0</span>]):</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>    temp <span class="op">+=</span> <span class="st">'$</span><span class="sc">{:s}</span><span class="st"> = </span><span class="sc">{:s}</span><span class="st">$&lt;br&gt;'</span>.<span class="bu">format</span>(latex(NE_sym.rhs[i]),latex(NE_sym.lhs[i]))</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>Markdown(temp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="69">
<p><span class="math inline">\(0 = I_{V1} + v_{1} \left(C_{4} s + \frac{1}{R_{5}}\right) + v_{2} \left(- C_{4} s - \frac{1}{R_{5}}\right)\)</span><br><span class="math inline">\(0 = - C_{6} s v_{3} + v_{1} \left(- C_{4} s - \frac{1}{R_{5}}\right) + v_{2} \left(C_{4} s + C_{6} s + \frac{1}{Rp1ab2} + \frac{1}{R_{8}} + \frac{1}{R_{5}}\right)\)</span><br><span class="math inline">\(0 = - C_{6} s v_{2} + v_{3} \left(C_{6} s + \frac{1}{R_{9}}\right)\)</span><br><span class="math inline">\(V_{1} = v_{1}\)</span><br></p>
</div>
</div>
<p>The free symbols are turned into SymPy symbols and the element values are loaded into a dictionary.</p>
<div id="c5fe697f-3c9d-4a4d-8891-c418619bef8a" class="cell" data-execution_count="70">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>var(<span class="bu">str</span>(NE_sym.free_symbols).replace(<span class="st">'{'</span>,<span class="st">''</span>).replace(<span class="st">'}'</span>,<span class="st">''</span>))</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>element_values <span class="op">=</span> SymMNA.get_part_values(network_df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="symbolic-solution-2" class="level4" data-number="27.3.4.1">
<h4 data-number="27.3.4.1" class="anchored" data-anchor-id="symbolic-solution-2"><span class="header-section-number">27.3.4.1</span> Symbolic solution</h4>
<p>The network equations can be solved symbolically and are displayed below.</p>
<div id="35523f02-5f2a-4a12-917b-8a09d5f410f7" class="cell" data-execution_count="71">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>U_sym <span class="op">=</span> solve(NE_sym,X)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> <span class="st">''</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> U_sym.keys():</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>    temp <span class="op">+=</span> <span class="st">'$</span><span class="sc">{:s}</span><span class="st"> = </span><span class="sc">{:s}</span><span class="st">$&lt;br&gt;'</span>.<span class="bu">format</span>(latex(i),latex(U_sym[i]))</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>Markdown(temp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="71">
<p><span class="math inline">\(v_{1} = V_{1}\)</span><br><span class="math inline">\(v_{2} = \frac{C_{4} C_{6} R_{5} R_{8} R_{9} Rp1ab2 V_{1} s^{2} + C_{4} R_{5} R_{8} Rp1ab2 V_{1} s + C_{6} R_{8} R_{9} Rp1ab2 V_{1} s + R_{8} Rp1ab2 V_{1}}{C_{4} C_{6} R_{5} R_{8} R_{9} Rp1ab2 s^{2} + C_{4} R_{5} R_{8} Rp1ab2 s + C_{6} R_{5} R_{8} R_{9} s + C_{6} R_{5} R_{8} Rp1ab2 s + C_{6} R_{5} R_{9} Rp1ab2 s + C_{6} R_{8} R_{9} Rp1ab2 s + R_{5} R_{8} + R_{5} Rp1ab2 + R_{8} Rp1ab2}\)</span><br><span class="math inline">\(v_{3} = \frac{C_{4} C_{6} R_{5} R_{8} R_{9} Rp1ab2 V_{1} s^{2} + C_{6} R_{8} R_{9} Rp1ab2 V_{1} s}{C_{4} C_{6} R_{5} R_{8} R_{9} Rp1ab2 s^{2} + C_{4} R_{5} R_{8} Rp1ab2 s + C_{6} R_{5} R_{8} R_{9} s + C_{6} R_{5} R_{8} Rp1ab2 s + C_{6} R_{5} R_{9} Rp1ab2 s + C_{6} R_{8} R_{9} Rp1ab2 s + R_{5} R_{8} + R_{5} Rp1ab2 + R_{8} Rp1ab2}\)</span><br><span class="math inline">\(I_{V1} = \frac{- C_{4} C_{6} R_{5} R_{8} R_{9} V_{1} s^{2} - C_{4} C_{6} R_{5} R_{8} Rp1ab2 V_{1} s^{2} - C_{4} C_{6} R_{5} R_{9} Rp1ab2 V_{1} s^{2} - C_{4} R_{5} R_{8} V_{1} s - C_{4} R_{5} Rp1ab2 V_{1} s - C_{6} R_{8} R_{9} V_{1} s - C_{6} R_{8} Rp1ab2 V_{1} s - C_{6} R_{9} Rp1ab2 V_{1} s - R_{8} V_{1} - Rp1ab2 V_{1}}{C_{4} C_{6} R_{5} R_{8} R_{9} Rp1ab2 s^{2} + C_{4} R_{5} R_{8} Rp1ab2 s + C_{6} R_{5} R_{8} R_{9} s + C_{6} R_{5} R_{8} Rp1ab2 s + C_{6} R_{5} R_{9} Rp1ab2 s + C_{6} R_{8} R_{9} Rp1ab2 s + R_{5} R_{8} + R_{5} Rp1ab2 + R_{8} Rp1ab2}\)</span><br></p>
</div>
</div>
<p>SymPy can solve and display the node voltage equations.</p>
<div id="7f0a6832-b624-4904-a2d9-2323e43c532c" class="cell" data-execution_count="72">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>U_sym <span class="op">=</span> solve(NE_sym,X)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> <span class="st">''</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> U_sym.keys():</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>    temp <span class="op">+=</span> <span class="st">'$</span><span class="sc">{:s}</span><span class="st"> = </span><span class="sc">{:s}</span><span class="st">$&lt;br&gt;'</span>.<span class="bu">format</span>(latex(i),latex(U_sym[i]))</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>Markdown(temp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="72">
<p><span class="math inline">\(v_{1} = V_{1}\)</span><br><span class="math inline">\(v_{2} = \frac{C_{4} C_{6} R_{5} R_{8} R_{9} Rp1ab2 V_{1} s^{2} + C_{4} R_{5} R_{8} Rp1ab2 V_{1} s + C_{6} R_{8} R_{9} Rp1ab2 V_{1} s + R_{8} Rp1ab2 V_{1}}{C_{4} C_{6} R_{5} R_{8} R_{9} Rp1ab2 s^{2} + C_{4} R_{5} R_{8} Rp1ab2 s + C_{6} R_{5} R_{8} R_{9} s + C_{6} R_{5} R_{8} Rp1ab2 s + C_{6} R_{5} R_{9} Rp1ab2 s + C_{6} R_{8} R_{9} Rp1ab2 s + R_{5} R_{8} + R_{5} Rp1ab2 + R_{8} Rp1ab2}\)</span><br><span class="math inline">\(v_{3} = \frac{C_{4} C_{6} R_{5} R_{8} R_{9} Rp1ab2 V_{1} s^{2} + C_{6} R_{8} R_{9} Rp1ab2 V_{1} s}{C_{4} C_{6} R_{5} R_{8} R_{9} Rp1ab2 s^{2} + C_{4} R_{5} R_{8} Rp1ab2 s + C_{6} R_{5} R_{8} R_{9} s + C_{6} R_{5} R_{8} Rp1ab2 s + C_{6} R_{5} R_{9} Rp1ab2 s + C_{6} R_{8} R_{9} Rp1ab2 s + R_{5} R_{8} + R_{5} Rp1ab2 + R_{8} Rp1ab2}\)</span><br><span class="math inline">\(I_{V1} = \frac{- C_{4} C_{6} R_{5} R_{8} R_{9} V_{1} s^{2} - C_{4} C_{6} R_{5} R_{8} Rp1ab2 V_{1} s^{2} - C_{4} C_{6} R_{5} R_{9} Rp1ab2 V_{1} s^{2} - C_{4} R_{5} R_{8} V_{1} s - C_{4} R_{5} Rp1ab2 V_{1} s - C_{6} R_{8} R_{9} V_{1} s - C_{6} R_{8} Rp1ab2 V_{1} s - C_{6} R_{9} Rp1ab2 V_{1} s - R_{8} V_{1} - Rp1ab2 V_{1}}{C_{4} C_{6} R_{5} R_{8} R_{9} Rp1ab2 s^{2} + C_{4} R_{5} R_{8} Rp1ab2 s + C_{6} R_{5} R_{8} R_{9} s + C_{6} R_{5} R_{8} Rp1ab2 s + C_{6} R_{5} R_{9} Rp1ab2 s + C_{6} R_{8} R_{9} Rp1ab2 s + R_{5} R_{8} + R_{5} Rp1ab2 + R_{8} Rp1ab2}\)</span><br></p>
</div>
</div>
<p>The network transfer function, <span class="math inline">\(H(s)=\frac {v_2(s)}{v_1(s)}\)</span> is:</p>
<div id="30ad9ed6-68e4-4d90-9a63-c3077ac4ed4b" class="cell" data-execution_count="73">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>H_sym <span class="op">=</span> (U_sym[v2]<span class="op">/</span>U_sym[v1]).cancel()</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'$H(s)=</span><span class="sc">{:s}</span><span class="st">$'</span>.<span class="bu">format</span>(latex(H_sym)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="73">
<p><span class="math inline">\(H(s)=\frac{C_{4} C_{6} R_{5} R_{8} R_{9} Rp1ab2 s^{2} + C_{4} R_{5} R_{8} Rp1ab2 s + C_{6} R_{8} R_{9} Rp1ab2 s + R_{8} Rp1ab2}{C_{4} C_{6} R_{5} R_{8} R_{9} Rp1ab2 s^{2} + C_{4} R_{5} R_{8} Rp1ab2 s + C_{6} R_{5} R_{8} R_{9} s + C_{6} R_{5} R_{8} Rp1ab2 s + C_{6} R_{5} R_{9} Rp1ab2 s + C_{6} R_{8} R_{9} Rp1ab2 s + R_{5} R_{8} + R_{5} Rp1ab2 + R_{8} Rp1ab2}\)</span></p>
</div>
</div>
<p>We can look at the numerator and denominator polynomials of the transfer function.</p>
<div id="54814d48-9a81-45de-a791-ba99efce917f" class="cell" data-tags="[]" data-execution_count="74">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>H_sym_num, H_sym_denom <span class="op">=</span> fraction(H_sym,s) <span class="co">#returns numerator and denominator</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="numerator-polynomial-1" class="level4" data-number="27.3.4.2">
<h4 data-number="27.3.4.2" class="anchored" data-anchor-id="numerator-polynomial-1"><span class="header-section-number">27.3.4.2</span> Numerator Polynomial</h4>
<p>The numerator polynomial is:</p>
<div id="f88daa03-508c-4486-8f31-8ab0f7538428" class="cell" data-execution_count="75">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'$N(s)=</span><span class="sc">{:s}</span><span class="st">$'</span>.<span class="bu">format</span>(latex(H_sym_num)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="75">
<p><span class="math inline">\(N(s)=C_{4} C_{6} R_{5} R_{8} R_{9} Rp1ab2 s^{2} + C_{4} R_{5} R_{8} Rp1ab2 s + C_{6} R_{8} R_{9} Rp1ab2 s + R_{8} Rp1ab2\)</span></p>
</div>
</div>
<p>The coefficients of each Laplace term can be equated to the variables <span class="math inline">\(b_2\)</span>, <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_0\)</span> in the expression:</p>
<p><span class="math inline">\(b_2s^{2}+b_1s+b_0\)</span></p>
<p>where <span class="math inline">\(b_2\)</span>, <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_0\)</span> are:</p>
<div id="963e74fd-96bc-4e2a-8734-8d5ecf94a4e8" class="cell" data-execution_count="76">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>b2 <span class="op">=</span> H_sym_num.coeff(s<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>b1 <span class="op">=</span> H_sym_num.coeff(s<span class="op">**</span><span class="dv">1</span>)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>b0 <span class="op">=</span> (H_sym_num <span class="op">-</span> b1<span class="op">*</span>s<span class="op">*</span><span class="dv">1</span> <span class="op">-</span> b2<span class="op">*</span>s<span class="op">**</span><span class="dv">2</span>).expand()</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'&lt;p&gt;$b_2=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;&lt;p&gt;$b_1=</span><span class="sc">{:s}</span><span class="st">$</span><span class="op">\</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/p&gt;&lt;p&gt;$b_0=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;'</span>.<span class="bu">format</span>(latex(b2),latex(b1),latex(b0)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="76">
<p>
<span class="math inline">\(b_2=C_{4} C_{6} R_{5} R_{8} R_{9} Rp1ab2\)</span>
</p>
<p>
<span class="math inline">\(b_1=C_{4} R_{5} R_{8} Rp1ab2 + C_{6} R_{8} R_{9} Rp1ab2\)</span>
</p>
<p>
<span class="math inline">\(b_0=R_{8} Rp1ab2\)</span>
</p>
</div>
</div>
<p>The roots of the numerator polynomial can easily be found with SymPy. This filter has two transmission zeros, which can be found using the <code>solve</code> function on the numerator polynomial.</p>
<div id="c89fb809-5b7d-4c26-9847-41c71a5488bb" class="cell" data-execution_count="77">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>num_root_sym <span class="op">=</span> solve(H_sym_num,s)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'There are </span><span class="sc">{:d}</span><span class="st"> zeros, which are:</span><span class="op">\</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;p&gt;$z_0=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;&lt;p&gt;$z_1=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;'</span>.<span class="bu">format</span>(<span class="bu">len</span>(num_root_sym),latex(num_root_sym[<span class="dv">0</span>]),latex(num_root_sym[<span class="dv">1</span>])))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="77">
There are 2 zeros, which are:
<p>
<span class="math inline">\(z_0=- \frac{1}{C_{4} R_{5}}\)</span>
</p>
<p>
<span class="math inline">\(z_1=- \frac{1}{C_{6} R_{9}}\)</span>
</p>
</div>
</div>
</section>
<section id="denominator-polynomial-1" class="level4" data-number="27.3.4.3">
<h4 data-number="27.3.4.3" class="anchored" data-anchor-id="denominator-polynomial-1"><span class="header-section-number">27.3.4.3</span> Denominator Polynomial</h4>
<p>The denominator polynomial of the transfer function is called the characteristic polynomial. The roots of the denominator, also called poles of the system, determine the system’s stability. If any of these roots have a positive real part, the system is unstable, meaning its output will grow unbounded. The roots also influence how the system responds to changes in input (the transient response). They affect things like how quickly the system settles to a new state, whether it oscillates, and the damping of those oscillations. Each root of the characteristic polynomial corresponds to a natural mode of the system.</p>
<p>The denominator polynomial is:</p>
<div id="c8f2bf73-3fdb-4796-a956-ecfcea21b034" class="cell" data-execution_count="78">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'$D(s)=</span><span class="sc">{:s}</span><span class="st">$'</span>.<span class="bu">format</span>(latex(H_sym_denom)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="78">
<p><span class="math inline">\(D(s)=C_{4} C_{6} R_{5} R_{8} R_{9} Rp1ab2 s^{2} + C_{4} R_{5} R_{8} Rp1ab2 s + C_{6} R_{5} R_{8} R_{9} s + C_{6} R_{5} R_{8} Rp1ab2 s + C_{6} R_{5} R_{9} Rp1ab2 s + C_{6} R_{8} R_{9} Rp1ab2 s + R_{5} R_{8} + R_{5} Rp1ab2 + R_{8} Rp1ab2\)</span></p>
</div>
</div>
<p>The coefficients of each Laplace term can be equated to the variables <span class="math inline">\(a_2\)</span>, <span class="math inline">\(a_1\)</span> and <span class="math inline">\(a_0\)</span> in the expression:</p>
<p><span class="math inline">\(a_2s^2+a_1s+a_0\)</span></p>
<p>where <span class="math inline">\(a_2\)</span>, <span class="math inline">\(a_1\)</span> and <span class="math inline">\(a_0\)</span> are:</p>
<div id="a9d18023-7104-4d69-b1ad-c8acbfccea89" class="cell" data-execution_count="79">
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="79">
<p>
<span class="math inline">\(a_2=C_{4} C_{6} R_{5} R_{8} R_{9} Rp1ab2\)</span>
</p>
<p>
<span class="math inline">\(a_1=C_{4} R_{5} R_{8} Rp1ab2 + C_{6} R_{5} R_{8} R_{9} + C_{6} R_{5} R_{8} Rp1ab2 + C_{6} R_{5} R_{9} Rp1ab2 + C_{6} R_{8} R_{9} Rp1ab2\)</span>
</p>
<p>
<span class="math inline">\(a_0=R_{5} R_{8} + R_{5} Rp1ab2 + R_{8} Rp1ab2\)</span>
</p>
</div>
</div>
<p>The roots of the denominator polynomial, which are the poles of the transder fuction, can be found with SymPy.</p>
<div id="9de3a89a-eeb1-41ba-a6d1-49b0feb135a6" class="cell" data-execution_count="80">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>denom_root_sym <span class="op">=</span> solve(H_sym_denom,s)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'There are </span><span class="sc">{:d}</span><span class="st"> poles, which are:</span><span class="op">\</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;p&gt;$p_0=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;&lt;p&gt;$p_1=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;'</span>.<span class="bu">format</span>(<span class="bu">len</span>(denom_root_sym),latex(denom_root_sym[<span class="dv">0</span>]),latex(denom_root_sym[<span class="dv">1</span>])))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="80">
There are 2 poles, which are:
<p>
<span class="math inline">\(p_0=\frac{- C_{4} R_{5} R_{8} Rp1ab2 - C_{6} R_{5} R_{8} R_{9} - C_{6} R_{5} R_{8} Rp1ab2 - C_{6} R_{5} R_{9} Rp1ab2 - C_{6} R_{8} R_{9} Rp1ab2 - \sqrt{C_{4}^{2} R_{5}^{2} R_{8}^{2} Rp1ab2^{2} - 2 C_{4} C_{6} R_{5}^{2} R_{8}^{2} R_{9} Rp1ab2 + 2 C_{4} C_{6} R_{5}^{2} R_{8}^{2} Rp1ab2^{2} - 2 C_{4} C_{6} R_{5}^{2} R_{8} R_{9} Rp1ab2^{2} - 2 C_{4} C_{6} R_{5} R_{8}^{2} R_{9} Rp1ab2^{2} + C_{6}^{2} R_{5}^{2} R_{8}^{2} R_{9}^{2} + 2 C_{6}^{2} R_{5}^{2} R_{8}^{2} R_{9} Rp1ab2 + C_{6}^{2} R_{5}^{2} R_{8}^{2} Rp1ab2^{2} + 2 C_{6}^{2} R_{5}^{2} R_{8} R_{9}^{2} Rp1ab2 + 2 C_{6}^{2} R_{5}^{2} R_{8} R_{9} Rp1ab2^{2} + C_{6}^{2} R_{5}^{2} R_{9}^{2} Rp1ab2^{2} + 2 C_{6}^{2} R_{5} R_{8}^{2} R_{9}^{2} Rp1ab2 + 2 C_{6}^{2} R_{5} R_{8}^{2} R_{9} Rp1ab2^{2} + 2 C_{6}^{2} R_{5} R_{8} R_{9}^{2} Rp1ab2^{2} + C_{6}^{2} R_{8}^{2} R_{9}^{2} Rp1ab2^{2}}}{2 C_{4} C_{6} R_{5} R_{8} R_{9} Rp1ab2}\)</span>
</p>
<p>
<span class="math inline">\(p_1=\frac{- C_{4} R_{5} R_{8} Rp1ab2 - C_{6} R_{5} R_{8} R_{9} - C_{6} R_{5} R_{8} Rp1ab2 - C_{6} R_{5} R_{9} Rp1ab2 - C_{6} R_{8} R_{9} Rp1ab2 + \sqrt{C_{4}^{2} R_{5}^{2} R_{8}^{2} Rp1ab2^{2} - 2 C_{4} C_{6} R_{5}^{2} R_{8}^{2} R_{9} Rp1ab2 + 2 C_{4} C_{6} R_{5}^{2} R_{8}^{2} Rp1ab2^{2} - 2 C_{4} C_{6} R_{5}^{2} R_{8} R_{9} Rp1ab2^{2} - 2 C_{4} C_{6} R_{5} R_{8}^{2} R_{9} Rp1ab2^{2} + C_{6}^{2} R_{5}^{2} R_{8}^{2} R_{9}^{2} + 2 C_{6}^{2} R_{5}^{2} R_{8}^{2} R_{9} Rp1ab2 + C_{6}^{2} R_{5}^{2} R_{8}^{2} Rp1ab2^{2} + 2 C_{6}^{2} R_{5}^{2} R_{8} R_{9}^{2} Rp1ab2 + 2 C_{6}^{2} R_{5}^{2} R_{8} R_{9} Rp1ab2^{2} + C_{6}^{2} R_{5}^{2} R_{9}^{2} Rp1ab2^{2} + 2 C_{6}^{2} R_{5} R_{8}^{2} R_{9}^{2} Rp1ab2 + 2 C_{6}^{2} R_{5} R_{8}^{2} R_{9} Rp1ab2^{2} + 2 C_{6}^{2} R_{5} R_{8} R_{9}^{2} Rp1ab2^{2} + C_{6}^{2} R_{8}^{2} R_{9}^{2} Rp1ab2^{2}}}{2 C_{4} C_{6} R_{5} R_{8} R_{9} Rp1ab2}\)</span>
</p>
</div>
</div>
</section>
</section>
<section id="analysis-using-the-extra-element-theorem" class="level3" data-number="27.3.5">
<h3 data-number="27.3.5" class="anchored" data-anchor-id="analysis-using-the-extra-element-theorem"><span class="header-section-number">27.3.5</span> Analysis Using the Extra Element Theorem</h3>
<p>The coefficients of the numerator and denominator polynomials for the transfer function of the circuit shown in <a href="#fig-Reactive_branch_3a" class="quarto-xref">Figure&nbsp;<span>27.4</span></a> can be determined by using the N Extra Element Theorem of <span class="citation" data-cites="Middlebrook1998">Middlebrook, Vorperian, and Lindal (<a href="References.html#ref-Middlebrook1998" role="doc-biblioref">1998</a>)</span>. Since there are only two reactive components in the circuit, this can be performed by inspection. See the example starting on slide 85 of <span class="citation" data-cites="basso2016">Basso (<a href="References.html#ref-basso2016" role="doc-biblioref">2016</a>)</span>. The following code cells walk through the steps.</p>
<p>The denominator polynomial coefficients <span class="math inline">\(c_2\)</span> and <span class="math inline">\(c_1\)</span> in the expression:</p>
<p><span class="math inline">\(c_2s^2+c_1s+1\)</span></p>
<p>can be found by the following steps. First find the time constants <span class="math inline">\(\tau_1\)</span> and <span class="math inline">\(\tau_2\)</span> while <span class="math inline">\(V_1=0\)</span>. To find <span class="math inline">\(\tau_1\)</span>, look at <a href="#fig-Reactive_branch_3a" class="quarto-xref">Figure&nbsp;<span>27.4</span></a> with <span class="math inline">\(V_1=0\)</span> and <span class="math inline">\(C_6\)</span> replaced by its impedance at <span class="math inline">\(\omega=0\)</span>, which is an open circuit. The resistance seen by <span class="math inline">\(C_4\)</span> is the parallel combination of <span class="math inline">\(R_5\)</span>, <span class="math inline">\(R_8\)</span> and <span class="math inline">\(R_{p1ab2}\)</span> which is equal to <span class="math inline">\(\frac {1} {\frac {1}{R_5}+\frac {1}{R_8}+\frac {1}{R_{p1ab2}} }\)</span>. We can create a new symbol <span class="math inline">\(Rp\)</span> to represent the parallel combination of <span class="math inline">\(R_5\)</span>, <span class="math inline">\(R_8\)</span> and <span class="math inline">\(R_{p1ab2}\)</span>.</p>
<div id="a2141aa1-363b-446b-bb1f-9730f47d24f3" class="cell" data-execution_count="81">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>Rp <span class="op">=</span> symbols(<span class="st">'Rp'</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>tau_1 <span class="op">=</span> C4<span class="op">*</span>Rp</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'The time constant $</span><span class="ch">\\</span><span class="st">tau_1 = </span><span class="sc">{:s}</span><span class="st">$.'</span>.<span class="bu">format</span>(latex(tau_1)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="81">
<p>The time constant <span class="math inline">\(\tau_1 = C_{4} Rp\)</span>.</p>
</div>
</div>
<p>To find <span class="math inline">\(\tau_2\)</span>, replace <span class="math inline">\(C_4\)</span> its impedance at <span class="math inline">\(\omega=0\)</span>, which is an open circuit. The resistance seen by <span class="math inline">\(C_6\)</span> is <span class="math inline">\(R_9\)</span> plus the parallel combination of <span class="math inline">\(R_5\)</span>, <span class="math inline">\(R_8\)</span> and <span class="math inline">\(R_{p1ab2}\)</span> which is equal to <span class="math inline">\(R_9 + \frac {1} {\frac {1}{R_5}+\frac {1}{R_8}+\frac {1}{R_{p1ab2}} }\)</span>.</p>
<div id="3b9de646-df8e-4a6e-8773-11677198276f" class="cell" data-execution_count="82">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>tau_2 <span class="op">=</span> C6<span class="op">*</span>(Rp<span class="op">+</span>R9)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'The time constant $</span><span class="ch">\\</span><span class="st">tau_2 = </span><span class="sc">{:s}</span><span class="st">$.'</span>.<span class="bu">format</span>(latex(tau_2)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="82">
<p>The time constant <span class="math inline">\(\tau_2 = C_{6} \left(R_{9} + Rp\right)\)</span>.</p>
</div>
</div>
<div id="80cbe428-4a0f-4aeb-9553-350aa478d744" class="cell" data-execution_count="83">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>c_1 <span class="op">=</span> tau_1<span class="op">+</span>tau_2</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'The denominator polynomial coefficient, $c_1 = </span><span class="ch">\\</span><span class="st">tau_1+</span><span class="ch">\\</span><span class="st">tau_2 = </span><span class="sc">{:s}</span><span class="st">$.'</span>.<span class="bu">format</span>(latex(c_1)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="83">
<p>The denominator polynomial coefficient, <span class="math inline">\(c_1 = \tau_1+\tau_2 = C_{4} Rp + C_{6} \left(R_{9} + Rp\right)\)</span>.</p>
</div>
</div>
<p>To find <span class="math inline">\(c_2\)</span>, place C1 in its high-frequency and look into C2, <span class="math inline">\(V_1\)</span> is still zero, this is <span class="math inline">\(\tau_1^2\)</span> and <span class="math inline">\(a_2 = \tau_1 \tau_1^2\)</span>.</p>
<div id="c85022cd-b36c-4d23-9986-04756e04c306" class="cell" data-execution_count="84">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tau_1^2</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>tau_1_2 <span class="op">=</span> (C6<span class="op">*</span>R9)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'$</span><span class="ch">\\</span><span class="st">tau_1^2 = </span><span class="sc">{:s}</span><span class="st">$'</span>.<span class="bu">format</span>(latex(tau_1_2)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="84">
<p><span class="math inline">\(\tau_1^2 = C_{6} R_{9}\)</span></p>
</div>
</div>
<p>The second coeeficient is equal to <span class="math inline">\(\tau_1 \tau_1^2\)</span>.</p>
<div id="b066d6fd-5c95-4d17-b055-dde80f34c7f5" class="cell" data-execution_count="85">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>c_2 <span class="op">=</span> tau_1<span class="op">*</span>tau_1_2</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'$c_2 = </span><span class="sc">{:s}</span><span class="st">$'</span>.<span class="bu">format</span>(latex(c_2)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="85">
<p><span class="math inline">\(c_2 = C_{4} C_{6} R_{9} Rp\)</span></p>
</div>
</div>
<div id="b16fb0c9-5c99-4a35-a30e-600bda86bb08" class="cell" data-execution_count="86">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'The denominator polynomial = $</span><span class="sc">{:s}</span><span class="st">$'</span>.<span class="bu">format</span>(latex(c_2<span class="op">*</span>s<span class="op">**</span><span class="dv">2</span><span class="op">+</span>c_1<span class="op">*</span>s<span class="op">+</span><span class="dv">1</span>)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="86">
<p>The denominator polynomial = <span class="math inline">\(C_{4} C_{6} R_{9} Rp s^{2} + s \left(C_{4} Rp + C_{6} \left(R_{9} + Rp\right)\right) + 1\)</span></p>
</div>
</div>
<p>To find if <span class="math inline">\(C_4\)</span> and <span class="math inline">\(C_6\)</span> cause zeros in the transfer function, the following procedure is used:</p>
<ul>
<li>Place <span class="math inline">\(C_4\)</span> in its high-frequency state while <span class="math inline">\(C_6\)</span> is in its low frequency state, check if the stimulus can propagate through the circuit to form a response on the output.</li>
<li>The place <span class="math inline">\(C_6\)</span> in its high-frequency state while <span class="math inline">\(C_4\)</span> is in its low frequency state, check if the stimulus can propagate through the circuit to form a response on the output.</li>
</ul>
<p>In both cases the stimulus can propagate through the circuit to form a response on the output.</p>
<p>To find the locations of the zeros, you have to find the impedance condition in the circuit where, for a certain stimulus frequency, you null the response. Either a series impedance becomes an infinite value or a shunt branch is zero. This happens for:</p>
<div id="7f4f6741-6aca-4fd6-aafe-453011fb081d" class="cell" data-execution_count="87">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>t1 <span class="op">=</span> C6<span class="op">*</span>R9</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>t2 <span class="op">=</span> C4<span class="op">*</span>R5</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'$t_1 = C_6R_9$ and $t_2 = C_4R_5$'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="87">
<p><span class="math inline">\(t_1 = C_6R_9\)</span> and <span class="math inline">\(t_2 = C_4R_5\)</span></p>
</div>
</div>
<div id="96905f76-50c5-4545-b5ff-cbed5e8ed3e6" class="cell" data-execution_count="88">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'We can write the numerator polynomial in factored form: $</span><span class="sc">{:s}</span><span class="st">$'</span>.<span class="bu">format</span>(latex((s<span class="op">+</span><span class="dv">1</span><span class="op">/</span>t1)<span class="op">*</span>(s<span class="op">+</span><span class="dv">1</span><span class="op">/</span>t2))))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="88">
<p>We can write the numerator polynomial in factored form: <span class="math inline">\(\left(s + \frac{1}{C_{4} R_{5}}\right) \left(s + \frac{1}{C_{6} R_{9}}\right)\)</span></p>
</div>
</div>
<p>The DC gain of the transfer function, <span class="math inline">\(H_0\)</span> can be found by letting <span class="math inline">\(\omega=0\)</span> and is:</p>
<p><span class="math inline">\(H_0=\frac{R_8||P_1}{R_5+R_8||P_1}\)</span></p>
<p>Now we can write the transfer function:</p>
<div id="b13a9eac-0247-4d0c-99b5-67088a5fa6c2" class="cell" data-execution_count="89">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>H_0 <span class="op">=</span> symbols(<span class="st">'H_0'</span>)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'$H(s)=</span><span class="sc">{:s}</span><span class="st">$'</span>.<span class="bu">format</span>(latex(H_0<span class="op">*</span>(s<span class="op">+</span><span class="dv">1</span><span class="op">/</span>t1)<span class="op">*</span>(s<span class="op">+</span><span class="dv">1</span><span class="op">/</span>t2)<span class="op">/</span>(c_2<span class="op">*</span>s<span class="op">**</span><span class="dv">2</span><span class="op">+</span>c_1<span class="op">*</span>s<span class="op">+</span><span class="dv">1</span>))))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="89">
<p><span class="math inline">\(H(s)=\frac{H_{0} \left(s + \frac{1}{C_{4} R_{5}}\right) \left(s + \frac{1}{C_{6} R_{9}}\right)}{C_{4} C_{6} R_{9} Rp s^{2} + s \left(C_{4} Rp + C_{6} \left(R_{9} + Rp\right)\right) + 1}\)</span></p>
</div>
</div>
<p>The expression obtained for <span class="math inline">\(H(s)\)</span> above can be checked by substituting element values and comparing to the MNA results above.</p>
<p>Substituting <span class="math inline">\(R_{p1ab2}\)</span> for <span class="math inline">\(P_1\)</span>, the expression for <span class="math inline">\(H_0\)</span> is:</p>
<div id="a7808348-e431-4bb9-931f-db6fd2625953" class="cell" data-execution_count="90">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>H_0 <span class="op">=</span> (<span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">/</span>R8<span class="op">+</span><span class="dv">1</span><span class="op">/</span>Rp1ab2))<span class="op">/</span>(R5<span class="op">+</span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">/</span>R8<span class="op">+</span><span class="dv">1</span><span class="op">/</span>Rp1ab2))</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'$H_0(s)=</span><span class="sc">{:s}</span><span class="st">$'</span>.<span class="bu">format</span>(latex(H_0)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="90">
<p><span class="math inline">\(H_0(s)=\frac{1}{\left(R_{5} + \frac{1}{\frac{1}{Rp1ab2} + \frac{1}{R_{8}}}\right) \left(\frac{1}{Rp1ab2} + \frac{1}{R_{8}}\right)}\)</span></p>
</div>
</div>
<p>Putting all the sysmbols together, we get:</p>
<div id="1cf2be13-c2d3-4cac-be11-a64045f269ec" class="cell" data-execution_count="92">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'$H(s)=</span><span class="sc">{:s}</span><span class="st">$'</span>.<span class="bu">format</span>(latex(H_0<span class="op">*</span>(s<span class="op">+</span><span class="dv">1</span><span class="op">/</span>t1)<span class="op">*</span>(s<span class="op">+</span><span class="dv">1</span><span class="op">/</span>t2)<span class="op">/</span>(c_2<span class="op">*</span>s<span class="op">**</span><span class="dv">2</span><span class="op">+</span>c_1<span class="op">*</span>s<span class="op">+</span><span class="dv">1</span>))))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="92">
<p><span class="math inline">\(H(s)=\frac{\left(s + \frac{1}{C_{4} R_{5}}\right) \left(s + \frac{1}{C_{6} R_{9}}\right)}{\left(R_{5} + \frac{1}{\frac{1}{Rp1ab2} + \frac{1}{R_{8}}}\right) \left(\frac{1}{Rp1ab2} + \frac{1}{R_{8}}\right) \left(C_{4} C_{6} R_{9} Rp s^{2} + s \left(C_{4} Rp + C_{6} \left(R_{9} + Rp\right)\right) + 1\right)}\)</span></p>
</div>
</div>
<p>Making the substitution for <span class="math inline">\(R_P\)</span> we get:</p>
<div id="18a035c8-cb3d-444d-89c3-1ebf11ba99d6" class="cell" data-execution_count="93">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>H <span class="op">=</span> (H_0<span class="op">*</span>(s<span class="op">+</span><span class="dv">1</span><span class="op">/</span>t1)<span class="op">*</span>(s<span class="op">+</span><span class="dv">1</span><span class="op">/</span>t2)<span class="op">/</span>(c_2<span class="op">*</span>s<span class="op">**</span><span class="dv">2</span><span class="op">+</span>c_1<span class="op">*</span>s<span class="op">+</span><span class="dv">1</span>)).subs({Rp:<span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">/</span>R5<span class="op">+</span><span class="dv">1</span><span class="op">/</span>R8<span class="op">+</span><span class="dv">1</span><span class="op">/</span>Rp1ab2)})</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'$H(s)=</span><span class="sc">{:s}</span><span class="st">$'</span>.<span class="bu">format</span>(latex(H)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="93">
<p><span class="math inline">\(H(s)=\frac{\left(s + \frac{1}{C_{4} R_{5}}\right) \left(s + \frac{1}{C_{6} R_{9}}\right)}{\left(R_{5} + \frac{1}{\frac{1}{Rp1ab2} + \frac{1}{R_{8}}}\right) \left(\frac{1}{Rp1ab2} + \frac{1}{R_{8}}\right) \left(\frac{C_{4} C_{6} R_{9} s^{2}}{\frac{1}{Rp1ab2} + \frac{1}{R_{8}} + \frac{1}{R_{5}}} + s \left(\frac{C_{4}}{\frac{1}{Rp1ab2} + \frac{1}{R_{8}} + \frac{1}{R_{5}}} + C_{6} \left(R_{9} + \frac{1}{\frac{1}{Rp1ab2} + \frac{1}{R_{8}} + \frac{1}{R_{5}}}\right)\right) + 1\right)}\)</span></p>
</div>
</div>
<p>Putting in the element values we get:</p>
<div id="181ec679-f827-4b04-8fec-fa94b6595c0b" class="cell" data-execution_count="94">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>H <span class="op">=</span> H.subs(element_values)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'$H(s)=</span><span class="sc">{:s}</span><span class="st">$'</span>.<span class="bu">format</span>(latex(H)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="94">
<p><span class="math inline">\(H(s)=\frac{0.224668613794653 \left(s + 2564.10256410256\right) \left(s + 2883.50634371396\right)}{3.03868793529544 \cdot 10^{-8} s^{2} + 0.00091478094810155 s + 1}\)</span></p>
</div>
</div>
<p>Now we can extract the numerator and demoninator and compare to the MNA results.</p>
<div id="33b5c0f0-1abb-4ff8-bac9-3bb01d992cf4" class="cell" data-execution_count="95">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>H1_num, H1_denom <span class="op">=</span> fraction(H)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The numerator obtained with the EET is:</p>
<div id="3e570c79-1dcc-4a0e-82cb-0232f908dea3" class="cell" data-execution_count="96">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>H1_num.expand()<span class="op">/</span>H1_num.expand().coeff(s<span class="op">**</span><span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="96">
<p><span class="math inline">\(\displaystyle 1.0 s^{2} + 5447.60890781652 s + 7393606.00952296\)</span></p>
</div>
</div>
<p>Which exactly matches the numberator obtained from MNA.</p>
<div id="22b32a49-9d83-43e7-8cfc-f8ee14e899e7" class="cell" data-execution_count="97">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>H_sym_num.subs(element_values)<span class="op">/</span>H_sym_num.subs(element_values).coeff(s<span class="op">**</span><span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="97">
<p><span class="math inline">\(\displaystyle 1.0 s^{2} + 5447.60890781652 s + 7393606.00952297\)</span></p>
</div>
</div>
<p>Looking at the demominators, the demininator obtanained from the EET is :</p>
<div id="b4bcf2af-96c2-457c-bef2-f99834a453e0" class="cell" data-execution_count="98">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>H1_denom<span class="op">/</span>H1_denom.coeff(s<span class="op">**</span><span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="98">
<p><span class="math inline">\(\displaystyle 1.0 s^{2} + 30104.4716529146 s + 32908940.3483867\)</span></p>
</div>
</div>
<p>Which exactly matches the demoninator obtained from MNA.</p>
<div id="7dc96aca-29fc-4008-8a09-d0bfbb186bc4" class="cell" data-execution_count="99">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>H_sym_denom.subs(element_values)<span class="op">/</span>H_sym_denom.subs(element_values).coeff(s<span class="op">**</span><span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="99">
<p><span class="math inline">\(\displaystyle 1.0 s^{2} + 30104.4716529146 s + 32908940.3483867\)</span></p>
</div>
</div>
<p>This varifies that the EET solution is valid. If the circuit is a 2nd order circuit, this analysis approach can be useful.</p>
<section id="numerical-solution" class="level4" data-number="27.3.5.1">
<h4 data-number="27.3.5.1" class="anchored" data-anchor-id="numerical-solution"><span class="header-section-number">27.3.5.1</span> Numerical Solution</h4>
<p>If numerical values are substituted for the reference designators in the symbolic equations, the following numerical equations can be obtained.</p>
<div id="594f532d-8fa1-481f-be9c-f9f0f08fcf77" class="cell" data-execution_count="100">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>equ_N <span class="op">=</span> NE_sym.subs(element_values)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> <span class="st">''</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(shape(equ_N.lhs)[<span class="dv">0</span>]):</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>    temp <span class="op">+=</span> <span class="st">'&lt;p&gt;$</span><span class="sc">{:s}</span><span class="st"> = </span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;'</span>.<span class="bu">format</span>(latex(equ_N.rhs[i]),</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>        latex(round_expr(equ_N.lhs[i],<span class="dv">8</span>)))</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>Markdown(temp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="100">
<p>
<span class="math inline">\(0 = I_{V1} + v_{1} \cdot \left(7.0 \cdot 10^{-8} s + 0.00019608\right) + v_{2} \left(- 7.0 \cdot 10^{-8} s - 0.00019608\right)\)</span>
</p>
<p>
<span class="math inline">\(0 = - 3.9 \cdot 10^{-7} s v_{3} + v_{1} \left(- 7.0 \cdot 10^{-8} s - 0.00019608\right) + v_{2} \cdot \left(4.6 \cdot 10^{-7} s + 0.00087275\right)\)</span>
</p>
<p>
<span class="math inline">\(0 = - 3.9 \cdot 10^{-7} s v_{2} + v_{3} \cdot \left(3.9 \cdot 10^{-7} s + 0.001\right)\)</span>
</p>
<p>
<span class="math inline">\(1.0 = v_{1}\)</span>
</p>
</div>
</div>
<p>SymPy can solve for unknown node voltages and the unknown currents from the independent voltage source, <span class="math inline">\(V_1\)</span>, and the Op Amp’s output terminal. The unknown currents, <span class="math inline">\(I_{V1}\)</span> and <span class="math inline">\(I_{O1}\)</span>, are not displayed. The node voltages are:</p>
<div id="9711f4db-189e-43b6-b992-de6197978d89" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;jupyter&quot;,&quot;value&quot;:{&quot;outputs_hidden&quot;:false}}" data-execution_count="101">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>U <span class="op">=</span> solve(equ_N,X)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> <span class="st">''</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> U.keys():</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">str</span>(i)[<span class="dv">0</span>] <span class="op">==</span> <span class="st">'v'</span>: <span class="co"># only display the node voltages</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>        temp <span class="op">+=</span> <span class="st">'&lt;p&gt;$</span><span class="sc">{:s}</span><span class="st"> = </span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;'</span>.<span class="bu">format</span>(latex(i),latex(U[i]))</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>Markdown(temp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="101">
<p>
<span class="math inline">\(v_{1} = 1.0\)</span>
</p>
<p>
<span class="math inline">\(v_{2} = \frac{2652000000000.0 s^{2} + 1.44470588235294 \cdot 10^{16} s + 1.96078431372549 \cdot 10^{19}}{2652000000000.0 s^{2} + 7.98370588235294 \cdot 10^{16} s + 8.72745098039216 \cdot 10^{19}}\)</span>
</p>
<p>
<span class="math inline">\(v_{3} = \frac{2652000000000.0 s^{2} + 7.64705882352941 \cdot 10^{15} s}{2652000000000.0 s^{2} + 7.98370588235294 \cdot 10^{16} s + 8.72745098039216 \cdot 10^{19}}\)</span>
</p>
</div>
</div>
<div id="cc17fdc4-8283-48d0-9700-d41d45a66747" class="cell" data-execution_count="102">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>H <span class="op">=</span> (U[v2]<span class="op">/</span>U[v1]).cancel()</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'The transfer function is: $H(s)=</span><span class="sc">{:s}</span><span class="st">$'</span>.<span class="bu">format</span>(latex(H)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="102">
<p>The transfer function is: <span class="math inline">\(H(s)=\frac{2652000000000.0 s^{2} + 1.44470588235294 \cdot 10^{16} s + 1.96078431372549 \cdot 10^{19}}{2652000000000.0 s^{2} + 7.98370588235294 \cdot 10^{16} s + 8.72745098039216 \cdot 10^{19}}\)</span></p>
</div>
</div>
<p>The SciPy function, <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.TransferFunction.html">TransferFunction</a>, is used to represent the system as the continuous-time transfer function. The code below extracts the numerator and denominator polynomials from the voltage transfer function. Then coefficients of the terms are used to build a SciPy transfer function object.</p>
<div id="4a0b13a0-f673-459f-ab1f-ec45ab70c82b" class="cell" data-execution_count="103">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>H_num, H_denom <span class="op">=</span> fraction(H) <span class="co">#returns numerator and denominator</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert symbolic to NumPy polynomial</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array(Poly(H_num, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array(Poly(H_denom, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>sys_tf <span class="op">=</span> signal.TransferFunction(a,b)</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>sys_zeros <span class="op">=</span> np.roots(sys_tf.num)</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>sys_poles <span class="op">=</span> np.roots(sys_tf.den)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The poles and zeros of the transfer function are plotted on the complex frequency plane with the following code:</p>
<div id="56db0ad1-998e-4cb5-bd28-138ae28b0f94" class="cell" data-execution_count="104">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>plt.plot(np.real(sys_zeros<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)), np.imag(sys_zeros<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)), <span class="st">'ob'</span>, markerfacecolor<span class="op">=</span><span class="st">'none'</span>)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>plt.plot(np.real(sys_poles<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)), np.imag(sys_poles<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)), <span class="st">'xr'</span>)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">'Zeros'</span>, <span class="st">'Poles'</span>], loc<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Pole / Zero Plot'</span>)</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'real part, </span><span class="ch">\u03B1</span><span class="st">'</span>)</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'imaginary part, j</span><span class="ch">\u03C9</span><span class="st">'</span>)</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Klon Centaur part 3v1_files/figure-html/cell-104-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The code below generates a table that lists the values of the pole and zero locations.</p>
<div id="3edcabcc-9ef1-4ef5-96fd-95967b336845" class="cell" data-execution_count="105">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>table_header <span class="op">=</span> [<span class="st">'Zeros, Hz'</span>, <span class="st">'Poles, Hz'</span>]</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>num_table_rows <span class="op">=</span> <span class="bu">max</span>(<span class="bu">len</span>(sys_zeros),<span class="bu">len</span>(sys_poles))</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>table_row <span class="op">=</span> []</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_table_rows):</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">&lt;</span> <span class="bu">len</span>(sys_zeros):</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>        z <span class="op">=</span> <span class="st">'</span><span class="sc">{:.2f}</span><span class="st">'</span>.<span class="bu">format</span>(sys_zeros[i]<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi))</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>        z <span class="op">=</span> <span class="st">''</span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">&lt;</span> <span class="bu">len</span>(sys_poles):</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>        p <span class="op">=</span> <span class="st">'</span><span class="sc">{:.2f}</span><span class="st">'</span>.<span class="bu">format</span>(sys_poles[i]<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi))</span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>        p <span class="op">=</span> <span class="st">''</span></span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>    table_row.append([z,p])</span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tabulate(table_row, headers<span class="op">=</span>table_header,colalign <span class="op">=</span> (<span class="st">'left'</span>,<span class="st">'left'</span>),tablefmt<span class="op">=</span><span class="st">"simple"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Zeros, Hz    Poles, Hz
-----------  -----------
-458.92      -4610.47
-408.09      -180.8</code></pre>
</div>
</div>
</section>
<section id="reactive-branch-3a-frequency-response" class="level4" data-number="27.3.5.2">
<h4 data-number="27.3.5.2" class="anchored" data-anchor-id="reactive-branch-3a-frequency-response"><span class="header-section-number">27.3.5.2</span> Reactive Branch 3a Frequency Response</h4>
<p>The frequency response for the circuit in <a href="#fig-Reactive_branch_3a" class="quarto-xref">Figure&nbsp;<span>27.4</span></a> is shown below.</p>
<div id="930762ae-b96d-4338-afad-0dc82f1f5f93" class="cell" data-execution_count="106">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># setup</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>x_axis <span class="op">=</span> np.logspace(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">2000</span>, endpoint<span class="op">=</span><span class="va">False</span>)<span class="op">*</span><span class="dv">2</span><span class="op">*</span>np.pi</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>color_list <span class="op">=</span> [<span class="st">'tab:blue'</span>,<span class="st">'tab:red'</span>,<span class="st">'tab:green'</span>,<span class="st">'tab:orange'</span>,<span class="st">'k'</span>]</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="co">#gain_setting = np.array([1,25,50,75,99])/100</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="co">#p1_value = 100e3</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a><span class="co">#tf_num_coef_list = []</span></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a><span class="co">#tf_denom_coef_list = []</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a><span class="co">#clean_path1_mag = np.zeros((len(gain_setting),len(x_axis)))</span></span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a><span class="co">#color_list = ['tab:blue','tab:red','tab:green','tab:orange','k']</span></span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a>fig, ax1 <span class="op">=</span> plt.subplots()</span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'magnitude, dB'</span>)</span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'frequency, Hz'</span>)</span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a><span class="co"># instantiate a second y-axes that shares the same x-axis</span></span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> ax1.twinx()</span>
<span id="cb112-21"><a href="#cb112-21" aria-hidden="true" tabindex="-1"></a>color <span class="op">=</span> <span class="st">'k'</span></span>
<span id="cb112-22"><a href="#cb112-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-23"><a href="#cb112-23" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'phase, deg'</span>,color<span class="op">=</span>color)</span>
<span id="cb112-24"><a href="#cb112-24" aria-hidden="true" tabindex="-1"></a>ax2.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelcolor<span class="op">=</span>color)</span>
<span id="cb112-25"><a href="#cb112-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-26"><a href="#cb112-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-27"><a href="#cb112-27" aria-hidden="true" tabindex="-1"></a>NE <span class="op">=</span> NE_sym.subs(element_values)</span>
<span id="cb112-28"><a href="#cb112-28" aria-hidden="true" tabindex="-1"></a>U <span class="op">=</span> solve(NE,X)</span>
<span id="cb112-29"><a href="#cb112-29" aria-hidden="true" tabindex="-1"></a>H <span class="op">=</span> U[v2]<span class="op">/</span>U[v1]</span>
<span id="cb112-30"><a href="#cb112-30" aria-hidden="true" tabindex="-1"></a>num, denom <span class="op">=</span> fraction(H) <span class="co">#returns numerator and denominator</span></span>
<span id="cb112-31"><a href="#cb112-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-32"><a href="#cb112-32" aria-hidden="true" tabindex="-1"></a><span class="co"># convert symbolic to NumPy polynomial</span></span>
<span id="cb112-33"><a href="#cb112-33" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array(Poly(num, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb112-34"><a href="#cb112-34" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array(Poly(denom, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb112-35"><a href="#cb112-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-36"><a href="#cb112-36" aria-hidden="true" tabindex="-1"></a><span class="co">#x = np.logspace(1, 5, 2000, endpoint=False)*2*np.pi</span></span>
<span id="cb112-37"><a href="#cb112-37" aria-hidden="true" tabindex="-1"></a>w, mag, phase <span class="op">=</span> signal.bode((a, b), w<span class="op">=</span>x_axis) <span class="co"># returns: rad/s, mag in dB, phase in deg</span></span>
<span id="cb112-38"><a href="#cb112-38" aria-hidden="true" tabindex="-1"></a><span class="co">#clean_path1_mag[i] = mag</span></span>
<span id="cb112-39"><a href="#cb112-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-40"><a href="#cb112-40" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the results</span></span>
<span id="cb112-41"><a href="#cb112-41" aria-hidden="true" tabindex="-1"></a>i<span class="op">=</span><span class="dv">0</span></span>
<span id="cb112-42"><a href="#cb112-42" aria-hidden="true" tabindex="-1"></a>ax1.semilogx(w<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi), mag,<span class="st">'-k'</span>,label<span class="op">=</span><span class="st">'mag'</span>)    <span class="co"># magnitude plot</span></span>
<span id="cb112-43"><a href="#cb112-43" aria-hidden="true" tabindex="-1"></a>ax2.semilogx(w<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi), phase,<span class="st">':k'</span>,label<span class="op">=</span><span class="st">'phase'</span>)  <span class="co"># phase plot</span></span>
<span id="cb112-44"><a href="#cb112-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-45"><a href="#cb112-45" aria-hidden="true" tabindex="-1"></a><span class="co"># highlight the guitar audio band, 80 to 8kHz</span></span>
<span id="cb112-46"><a href="#cb112-46" aria-hidden="true" tabindex="-1"></a>plt.axvspan(<span class="dv">80</span>, <span class="fl">8e3</span>, color<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>) </span>
<span id="cb112-47"><a href="#cb112-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-48"><a href="#cb112-48" aria-hidden="true" tabindex="-1"></a>ax1.set_ylim((<span class="op">-</span><span class="dv">20</span>,<span class="dv">5</span>))</span>
<span id="cb112-49"><a href="#cb112-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-50"><a href="#cb112-50" aria-hidden="true" tabindex="-1"></a><span class="co"># position legends</span></span>
<span id="cb112-51"><a href="#cb112-51" aria-hidden="true" tabindex="-1"></a>ax1.legend(loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb112-52"><a href="#cb112-52" aria-hidden="true" tabindex="-1"></a>ax2.legend(loc<span class="op">=</span><span class="st">'upper right'</span>)</span>
<span id="cb112-53"><a href="#cb112-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-54"><a href="#cb112-54" aria-hidden="true" tabindex="-1"></a>ax1.grid()</span>
<span id="cb112-55"><a href="#cb112-55" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Magnitude and phase response'</span>)</span>
<span id="cb112-56"><a href="#cb112-56" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Klon Centaur part 3v1_files/figure-html/cell-106-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>By examining the circuit in <a href="#fig-Reactive_branch_3a" class="quarto-xref">Figure&nbsp;<span>27.4</span></a>, we can see that there is a DC path from node 1 to node 2. At <span class="math inline">\(\omega=0\)</span>, the capacitors act as open circuits and the circuit reduces to a voltage divider equal to <span class="math inline">\(\frac {R_8||P_1} {R_5+R_8||P_1}\)</span> between nodes 1 and 2. At high frequencies, the capacitors act as short circuits and at high frequencies node 2 is shorted to node 1 by <span class="math inline">\(C_4\)</span></p>
</section>
</section>
<section id="sec-reactive_branch_3b" class="level3" data-number="27.3.6">
<h3 data-number="27.3.6" class="anchored" data-anchor-id="sec-reactive_branch_3b"><span class="header-section-number">27.3.6</span> Reactive Branch 3b</h3>
<p>The branch composed of components <span class="math inline">\(R_{15}\)</span>, <span class="math inline">\(C_{11}\)</span> and <span class="math inline">\(R_{16}\)</span> and the branch composed of components <span class="math inline">\(R_{17}\)</span>, <span class="math inline">\(R_{18}\)</span> and <span class="math inline">\(C_{12}\)</span>, form an unusual summing network attached to node 10 in <a href="#fig-reactive_branch_3_4_sch" class="quarto-xref">Figure&nbsp;<span>27.3</span></a>. The signal from the diode path combines with the signal from clean path 2 through <span class="math inline">\(C_{11}\)</span> at node 9.</p>
<p>The resistor <span class="math inline">\(R_{16}\)</span> conducts this blended signal into the summing junction at node 10. The signal from clean path 2 travels through the branch composed of components <span class="math inline">\(R_{17}\)</span>, <span class="math inline">\(R_{18}\)</span> and <span class="math inline">\(C_{12}\)</span> to the summing junction at node 10. The branch from node 5 to node 10, consisting of components <span class="math inline">\(R_{17}\)</span>, <span class="math inline">\(R_{18}\)</span> and <span class="math inline">\(C_{12}\)</span>, attaches to the summing junction at node 10 and combines the signal from clean path 2. These components have resonances that contribute to the poles and zeros of the transfer function.</p>
<p>The components <span class="math inline">\(R_{18}\)</span> and <span class="math inline">\(C_{12}\)</span> have a resonant frequency of about 500 Hz and since these are in series contribute to a pole to the transfer function at their resonant frequency. The components <span class="math inline">\(R_{18}+R_{17}\)</span> and <span class="math inline">\(C_{12}\)</span> have a resonant frequency of about 150 Hz and these contribute to a zero to the transfer function at their resonant frequency.</p>
<p>It’s not clear how the arrangement of these components attached to the summing junction were determined, perhaps this topology came to look like this by experimentation in the circuit prototyping and testing phase of the design.</p>
<p>When <span class="math inline">\(P_{1A}\)</span> in <a href="Klon Centaur part 1.html#fig-klon-centaur-schematic-high-res_w_clean_path2_highlight_sch" class="quarto-xref">Figure&nbsp;<span>25.17</span></a>, is rotated fully clockwise the wiper is connected to the ground end and no signal propagates along the path. When <span class="math inline">\(P_{1A}\)</span> is rotated fully counter clockwise, the wiper is connected to <span class="math inline">\(C_6\)</span> and the clean signal can propagate along the path. Otherwise, <span class="math inline">\(P_{1A}\)</span> acts as a voltage divider and the amplitude of the signal can be adjusted by the user.</p>
<p>The schematic in <a href="#fig-reactive_branch_3_4_sch" class="quarto-xref">Figure&nbsp;<span>27.3</span></a> has been redrawn below, notice that the node numbers have changed. The capacitor values for <span class="math inline">\(C_{10}\)</span> and <span class="math inline">\(C_9\)</span> have been combined and 0.5 <span class="math inline">\(\mu\)</span>F has been used for the value of <span class="math inline">\(C_{10}\)</span> below.</p>
<div id="fig-Reactive_branch_3b" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Reactive_branch_3b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Reactive_branch_3b.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Reactive_branch_3b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;27.5: Schematic of reactive branch 3b.
</figcaption>
</figure>
</div>
<p>The capacitor, <span class="math inline">\(C_9\)</span>, has been absorbed into <span class="math inline">\(C_{10}\)</span> in the schematic above in order to reduce the component and node count for the MNA. Since <span class="math inline">\(C_9\)</span> and <span class="math inline">\(C_{10}\)</span> are in series, the value of <span class="math inline">\(C_{10}\)</span> has been adjusted. The capacitor <span class="math inline">\(C_{13}\)</span> has not been included in the netlist so we can observe the operation of this reactive branch without the zero created at 500 Hz by <span class="math inline">\(C_{13}\)</span>.</p>
<div id="0a95aab0-15ce-4f56-84ff-56004fab73c6" class="cell" data-execution_count="107">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>reactive_branch_3_4_a_net_list <span class="op">=</span> <span class="st">'''</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="st">* Reactive_branch_3b.asc</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="st">R13 3 0 1e3</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="st">C11 4 6 2.2e-9</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="st">R15 6 1 22e3</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="st">R17 5 1 27e3</span></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="st">R18 7 1 12e3</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="st">C12 5 7 27e-9</span></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a><span class="st">R16 5 4 47e3</span></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a><span class="st">V1 1 0 1</span></span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a><span class="st">C10 4 3 0.5e-6</span></span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a><span class="st">R20 2 5 392e3</span></span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a><span class="st">*C13 2 5 820e-12</span></span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a><span class="st">O2A 5 0 2</span></span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a><span class="st">'''</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="5d5fbe91-06bc-43d4-86ca-f415f7fc3360" class="cell" data-execution_count="108">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>report, network_df, i_unk_df, A, X, Z <span class="op">=</span> SymMNA.smna(reactive_branch_3_4_a_net_list)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Build the network equations</p>
<div id="5b47f1be-4ed1-4b68-af20-6edb6ec5100f" class="cell" data-execution_count="109">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Put matrices into SymPy </span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> Matrix(X)</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> Matrix(Z)</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>NE_sym <span class="op">=</span> Eq(A<span class="op">*</span>X,Z)</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="co"># display the equations</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> <span class="st">''</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(shape(NE_sym.lhs)[<span class="dv">0</span>]):</span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>    temp <span class="op">+=</span> <span class="st">'$</span><span class="sc">{:s}</span><span class="st"> = </span><span class="sc">{:s}</span><span class="st">$&lt;br&gt;'</span>.<span class="bu">format</span>(latex(NE_sym.rhs[i]),latex(NE_sym.lhs[i]))</span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>Markdown(temp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="109">
<p><span class="math inline">\(0 = I_{V1} + v_{1} \cdot \left(\frac{1}{R_{18}} + \frac{1}{R_{17}} + \frac{1}{R_{15}}\right) - \frac{v_{7}}{R_{18}} - \frac{v_{5}}{R_{17}} - \frac{v_{6}}{R_{15}}\)</span><br><span class="math inline">\(0 = I_{O2a} + \frac{v_{2}}{R_{20}} - \frac{v_{5}}{R_{20}}\)</span><br><span class="math inline">\(0 = - C_{10} s v_{4} + v_{3} \left(C_{10} s + \frac{1}{R_{13}}\right)\)</span><br><span class="math inline">\(0 = - C_{10} s v_{3} - C_{11} s v_{6} + v_{4} \left(C_{10} s + C_{11} s + \frac{1}{R_{16}}\right) - \frac{v_{5}}{R_{16}}\)</span><br><span class="math inline">\(0 = - C_{12} s v_{7} + v_{5} \left(C_{12} s + \frac{1}{R_{20}} + \frac{1}{R_{17}} + \frac{1}{R_{16}}\right) - \frac{v_{2}}{R_{20}} - \frac{v_{1}}{R_{17}} - \frac{v_{4}}{R_{16}}\)</span><br><span class="math inline">\(0 = - C_{11} s v_{4} + v_{6} \left(C_{11} s + \frac{1}{R_{15}}\right) - \frac{v_{1}}{R_{15}}\)</span><br><span class="math inline">\(0 = - C_{12} s v_{5} + v_{7} \left(C_{12} s + \frac{1}{R_{18}}\right) - \frac{v_{1}}{R_{18}}\)</span><br><span class="math inline">\(V_{1} = v_{1}\)</span><br><span class="math inline">\(0 = v_{5}\)</span><br></p>
</div>
</div>
<p>Turn the free symbols into SymPy variables and load the element values.</p>
<div id="e0a600ef-655d-4f69-b649-62a93fee7abf" class="cell" data-execution_count="110">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>var(<span class="bu">str</span>(NE_sym.free_symbols).replace(<span class="st">'{'</span>,<span class="st">''</span>).replace(<span class="st">'}'</span>,<span class="st">''</span>))</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>element_values <span class="op">=</span> SymMNA.get_part_values(network_df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="symbolic-solution-3" class="level4" data-number="27.3.6.1">
<h4 data-number="27.3.6.1" class="anchored" data-anchor-id="symbolic-solution-3"><span class="header-section-number">27.3.6.1</span> Symbolic solution</h4>
<p>The network equations can be solved symbolically.</p>
<div id="0df7e607-5df1-4fb6-9271-e66763c56d80" class="cell" data-execution_count="111">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>U_sym <span class="op">=</span> solve(NE_sym,X)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Display the node voltages and dependent currents using symbolic notation.</p>
<div id="d61840af-ddad-46b4-a256-c70de9d35542" class="cell" data-execution_count="112">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> <span class="st">''</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> U_sym.keys():</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>    temp <span class="op">+=</span> <span class="st">'$</span><span class="sc">{:s}</span><span class="st"> = </span><span class="sc">{:s}</span><span class="st">$&lt;br&gt;'</span>.<span class="bu">format</span>(latex(i),latex(U_sym[i]))</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>Markdown(temp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="112">
<p><span class="math inline">\(v_{1} = V_{1}\)</span><br><span class="math inline">\(v_{2} = \frac{- C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} R_{20} V_{1} s^{3} - C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} R_{20} V_{1} s^{3} - C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} R_{20} V_{1} s^{3} - C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} R_{20} V_{1} s^{3} - C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} R_{20} V_{1} s^{3} - C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} R_{20} V_{1} s^{3} - C_{10} C_{11} C_{12} R_{15} R_{16} R_{18} R_{20} V_{1} s^{3} - C_{10} C_{11} R_{13} R_{15} R_{20} V_{1} s^{2} - C_{10} C_{11} R_{13} R_{16} R_{20} V_{1} s^{2} - C_{10} C_{11} R_{13} R_{17} R_{20} V_{1} s^{2} - C_{10} C_{11} R_{15} R_{16} R_{20} V_{1} s^{2} - C_{10} C_{12} R_{13} R_{17} R_{20} V_{1} s^{2} - C_{10} C_{12} R_{13} R_{18} R_{20} V_{1} s^{2} - C_{10} C_{12} R_{16} R_{17} R_{20} V_{1} s^{2} - C_{10} C_{12} R_{16} R_{18} R_{20} V_{1} s^{2} - C_{10} R_{13} R_{20} V_{1} s - C_{10} R_{16} R_{20} V_{1} s - C_{11} C_{12} R_{15} R_{17} R_{20} V_{1} s^{2} - C_{11} C_{12} R_{15} R_{18} R_{20} V_{1} s^{2} - C_{11} C_{12} R_{16} R_{17} R_{20} V_{1} s^{2} - C_{11} C_{12} R_{16} R_{18} R_{20} V_{1} s^{2} - C_{11} C_{12} R_{17} R_{18} R_{20} V_{1} s^{2} - C_{11} R_{15} R_{20} V_{1} s - C_{11} R_{16} R_{20} V_{1} s - C_{11} R_{17} R_{20} V_{1} s - C_{12} R_{17} R_{20} V_{1} s - C_{12} R_{18} R_{20} V_{1} s - R_{20} V_{1}}{C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} R_{18} s^{3} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} R_{18} s^{3} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} R_{18} s^{3} + C_{10} C_{11} R_{13} R_{15} R_{17} s^{2} + C_{10} C_{11} R_{13} R_{16} R_{17} s^{2} + C_{10} C_{11} R_{15} R_{16} R_{17} s^{2} + C_{10} C_{12} R_{13} R_{17} R_{18} s^{2} + C_{10} C_{12} R_{16} R_{17} R_{18} s^{2} + C_{10} R_{13} R_{17} s + C_{10} R_{16} R_{17} s + C_{11} C_{12} R_{15} R_{17} R_{18} s^{2} + C_{11} C_{12} R_{16} R_{17} R_{18} s^{2} + C_{11} R_{15} R_{17} s + C_{11} R_{16} R_{17} s + C_{12} R_{17} R_{18} s + R_{17}}\)</span><br><span class="math inline">\(v_{3} = \frac{C_{10} C_{11} R_{13} R_{16} V_{1} s^{2}}{C_{10} C_{11} R_{13} R_{15} s^{2} + C_{10} C_{11} R_{13} R_{16} s^{2} + C_{10} C_{11} R_{15} R_{16} s^{2} + C_{10} R_{13} s + C_{10} R_{16} s + C_{11} R_{15} s + C_{11} R_{16} s + 1}\)</span><br><span class="math inline">\(v_{4} = \frac{C_{10} C_{11} R_{13} R_{16} V_{1} s^{2} + C_{11} R_{16} V_{1} s}{C_{10} C_{11} R_{13} R_{15} s^{2} + C_{10} C_{11} R_{13} R_{16} s^{2} + C_{10} C_{11} R_{15} R_{16} s^{2} + C_{10} R_{13} s + C_{10} R_{16} s + C_{11} R_{15} s + C_{11} R_{16} s + 1}\)</span><br><span class="math inline">\(v_{5} = 0\)</span><br><span class="math inline">\(v_{6} = \frac{C_{10} C_{11} R_{13} R_{16} V_{1} s^{2} + C_{10} R_{13} V_{1} s + C_{10} R_{16} V_{1} s + C_{11} R_{16} V_{1} s + V_{1}}{C_{10} C_{11} R_{13} R_{15} s^{2} + C_{10} C_{11} R_{13} R_{16} s^{2} + C_{10} C_{11} R_{15} R_{16} s^{2} + C_{10} R_{13} s + C_{10} R_{16} s + C_{11} R_{15} s + C_{11} R_{16} s + 1}\)</span><br><span class="math inline">\(v_{7} = \frac{V_{1}}{C_{12} R_{18} s + 1}\)</span><br><span class="math inline">\(I_{V1} = \frac{- C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} V_{1} s^{3} - C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} V_{1} s^{3} - C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} V_{1} s^{3} - C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} V_{1} s^{3} - C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} V_{1} s^{3} - C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} V_{1} s^{3} - C_{10} C_{11} C_{12} R_{15} R_{16} R_{18} V_{1} s^{3} - C_{10} C_{11} C_{12} R_{16} R_{17} R_{18} V_{1} s^{3} - C_{10} C_{11} R_{13} R_{15} V_{1} s^{2} - C_{10} C_{11} R_{13} R_{16} V_{1} s^{2} - C_{10} C_{11} R_{13} R_{17} V_{1} s^{2} - C_{10} C_{11} R_{15} R_{16} V_{1} s^{2} - C_{10} C_{11} R_{16} R_{17} V_{1} s^{2} - C_{10} C_{12} R_{13} R_{17} V_{1} s^{2} - C_{10} C_{12} R_{13} R_{18} V_{1} s^{2} - C_{10} C_{12} R_{16} R_{17} V_{1} s^{2} - C_{10} C_{12} R_{16} R_{18} V_{1} s^{2} - C_{10} R_{13} V_{1} s - C_{10} R_{16} V_{1} s - C_{11} C_{12} R_{15} R_{17} V_{1} s^{2} - C_{11} C_{12} R_{15} R_{18} V_{1} s^{2} - C_{11} C_{12} R_{16} R_{17} V_{1} s^{2} - C_{11} C_{12} R_{16} R_{18} V_{1} s^{2} - C_{11} C_{12} R_{17} R_{18} V_{1} s^{2} - C_{11} R_{15} V_{1} s - C_{11} R_{16} V_{1} s - C_{11} R_{17} V_{1} s - C_{12} R_{17} V_{1} s - C_{12} R_{18} V_{1} s - V_{1}}{C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} R_{18} s^{3} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} R_{18} s^{3} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} R_{18} s^{3} + C_{10} C_{11} R_{13} R_{15} R_{17} s^{2} + C_{10} C_{11} R_{13} R_{16} R_{17} s^{2} + C_{10} C_{11} R_{15} R_{16} R_{17} s^{2} + C_{10} C_{12} R_{13} R_{17} R_{18} s^{2} + C_{10} C_{12} R_{16} R_{17} R_{18} s^{2} + C_{10} R_{13} R_{17} s + C_{10} R_{16} R_{17} s + C_{11} C_{12} R_{15} R_{17} R_{18} s^{2} + C_{11} C_{12} R_{16} R_{17} R_{18} s^{2} + C_{11} R_{15} R_{17} s + C_{11} R_{16} R_{17} s + C_{12} R_{17} R_{18} s + R_{17}}\)</span><br><span class="math inline">\(I_{O2a} = \frac{C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} V_{1} s^{3} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} V_{1} s^{3} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} V_{1} s^{3} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} V_{1} s^{3} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} V_{1} s^{3} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} V_{1} s^{3} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18} V_{1} s^{3} + C_{10} C_{11} R_{13} R_{15} V_{1} s^{2} + C_{10} C_{11} R_{13} R_{16} V_{1} s^{2} + C_{10} C_{11} R_{13} R_{17} V_{1} s^{2} + C_{10} C_{11} R_{15} R_{16} V_{1} s^{2} + C_{10} C_{12} R_{13} R_{17} V_{1} s^{2} + C_{10} C_{12} R_{13} R_{18} V_{1} s^{2} + C_{10} C_{12} R_{16} R_{17} V_{1} s^{2} + C_{10} C_{12} R_{16} R_{18} V_{1} s^{2} + C_{10} R_{13} V_{1} s + C_{10} R_{16} V_{1} s + C_{11} C_{12} R_{15} R_{17} V_{1} s^{2} + C_{11} C_{12} R_{15} R_{18} V_{1} s^{2} + C_{11} C_{12} R_{16} R_{17} V_{1} s^{2} + C_{11} C_{12} R_{16} R_{18} V_{1} s^{2} + C_{11} C_{12} R_{17} R_{18} V_{1} s^{2} + C_{11} R_{15} V_{1} s + C_{11} R_{16} V_{1} s + C_{11} R_{17} V_{1} s + C_{12} R_{17} V_{1} s + C_{12} R_{18} V_{1} s + V_{1}}{C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} R_{18} s^{3} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} R_{18} s^{3} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} R_{18} s^{3} + C_{10} C_{11} R_{13} R_{15} R_{17} s^{2} + C_{10} C_{11} R_{13} R_{16} R_{17} s^{2} + C_{10} C_{11} R_{15} R_{16} R_{17} s^{2} + C_{10} C_{12} R_{13} R_{17} R_{18} s^{2} + C_{10} C_{12} R_{16} R_{17} R_{18} s^{2} + C_{10} R_{13} R_{17} s + C_{10} R_{16} R_{17} s + C_{11} C_{12} R_{15} R_{17} R_{18} s^{2} + C_{11} C_{12} R_{16} R_{17} R_{18} s^{2} + C_{11} R_{15} R_{17} s + C_{11} R_{16} R_{17} s + C_{12} R_{17} R_{18} s + R_{17}}\)</span><br></p>
</div>
</div>
<p>The network transfer function, <span class="math inline">\(H(s)=\frac {v_2(s)}{v_1(s)}\)</span> is:</p>
<div id="9540570f-d42e-4327-8f10-69b3e860bc39" class="cell" data-execution_count="113">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>H_sym <span class="op">=</span> (U_sym[v2]<span class="op">/</span>U_sym[v1]).cancel()</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'$H(s)=</span><span class="sc">{:s}</span><span class="st">$'</span>.<span class="bu">format</span>(latex(H_sym)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="113">
<p><span class="math inline">\(H(s)=\frac{- C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} R_{20} s^{3} - C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} R_{20} s^{3} - C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} R_{20} s^{3} - C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} R_{20} s^{3} - C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} R_{20} s^{3} - C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} R_{20} s^{3} - C_{10} C_{11} C_{12} R_{15} R_{16} R_{18} R_{20} s^{3} - C_{10} C_{11} R_{13} R_{15} R_{20} s^{2} - C_{10} C_{11} R_{13} R_{16} R_{20} s^{2} - C_{10} C_{11} R_{13} R_{17} R_{20} s^{2} - C_{10} C_{11} R_{15} R_{16} R_{20} s^{2} - C_{10} C_{12} R_{13} R_{17} R_{20} s^{2} - C_{10} C_{12} R_{13} R_{18} R_{20} s^{2} - C_{10} C_{12} R_{16} R_{17} R_{20} s^{2} - C_{10} C_{12} R_{16} R_{18} R_{20} s^{2} - C_{10} R_{13} R_{20} s - C_{10} R_{16} R_{20} s - C_{11} C_{12} R_{15} R_{17} R_{20} s^{2} - C_{11} C_{12} R_{15} R_{18} R_{20} s^{2} - C_{11} C_{12} R_{16} R_{17} R_{20} s^{2} - C_{11} C_{12} R_{16} R_{18} R_{20} s^{2} - C_{11} C_{12} R_{17} R_{18} R_{20} s^{2} - C_{11} R_{15} R_{20} s - C_{11} R_{16} R_{20} s - C_{11} R_{17} R_{20} s - C_{12} R_{17} R_{20} s - C_{12} R_{18} R_{20} s - R_{20}}{C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} R_{18} s^{3} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} R_{18} s^{3} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} R_{18} s^{3} + C_{10} C_{11} R_{13} R_{15} R_{17} s^{2} + C_{10} C_{11} R_{13} R_{16} R_{17} s^{2} + C_{10} C_{11} R_{15} R_{16} R_{17} s^{2} + C_{10} C_{12} R_{13} R_{17} R_{18} s^{2} + C_{10} C_{12} R_{16} R_{17} R_{18} s^{2} + C_{10} R_{13} R_{17} s + C_{10} R_{16} R_{17} s + C_{11} C_{12} R_{15} R_{17} R_{18} s^{2} + C_{11} C_{12} R_{16} R_{17} R_{18} s^{2} + C_{11} R_{15} R_{17} s + C_{11} R_{16} R_{17} s + C_{12} R_{17} R_{18} s + R_{17}}\)</span></p>
</div>
</div>
<p>The numerator and the denominator are third order polynomials in terms of <span class="math inline">\(s\)</span>. Generally, the order of the dominator is equal to the number of reactive elements in the circuit. The roots of the numerator polynomial are called the zeros of the transfer function and the roots of the denominator are called the poles of the transfer function.</p>
<div id="06301d17-679a-4a90-bbca-319f4e563dfa" class="cell" data-tags="[]" data-execution_count="114">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>H_sym_num, H_sym_denom <span class="op">=</span> fraction(H_sym,s) <span class="co">#returns numerator and denominator</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="numerator-polynomial-of-h_syms-1" class="level4" data-number="27.3.6.2">
<h4 data-number="27.3.6.2" class="anchored" data-anchor-id="numerator-polynomial-of-h_syms-1"><span class="header-section-number">27.3.6.2</span> Numerator Polynomial of <span class="math inline">\(H_{sym}(s)\)</span></h4>
<p>The numerator polynomial is:</p>
<div id="c8513a3c-fdc5-4f9b-93b1-478cd7c6b46a" class="cell" data-execution_count="115">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'$N(s)=</span><span class="sc">{:s}</span><span class="st">$'</span>.<span class="bu">format</span>(latex(H_sym_num)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="115">
<p><span class="math inline">\(N(s)=- C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} R_{20} s^{3} - C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} R_{20} s^{3} - C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} R_{20} s^{3} - C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} R_{20} s^{3} - C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} R_{20} s^{3} - C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} R_{20} s^{3} - C_{10} C_{11} C_{12} R_{15} R_{16} R_{18} R_{20} s^{3} - C_{10} C_{11} R_{13} R_{15} R_{20} s^{2} - C_{10} C_{11} R_{13} R_{16} R_{20} s^{2} - C_{10} C_{11} R_{13} R_{17} R_{20} s^{2} - C_{10} C_{11} R_{15} R_{16} R_{20} s^{2} - C_{10} C_{12} R_{13} R_{17} R_{20} s^{2} - C_{10} C_{12} R_{13} R_{18} R_{20} s^{2} - C_{10} C_{12} R_{16} R_{17} R_{20} s^{2} - C_{10} C_{12} R_{16} R_{18} R_{20} s^{2} - C_{10} R_{13} R_{20} s - C_{10} R_{16} R_{20} s - C_{11} C_{12} R_{15} R_{17} R_{20} s^{2} - C_{11} C_{12} R_{15} R_{18} R_{20} s^{2} - C_{11} C_{12} R_{16} R_{17} R_{20} s^{2} - C_{11} C_{12} R_{16} R_{18} R_{20} s^{2} - C_{11} C_{12} R_{17} R_{18} R_{20} s^{2} - C_{11} R_{15} R_{20} s - C_{11} R_{16} R_{20} s - C_{11} R_{17} R_{20} s - C_{12} R_{17} R_{20} s - C_{12} R_{18} R_{20} s - R_{20}\)</span></p>
</div>
</div>
<p>The coefficients of each Laplace term can be equated to the variables <span class="math inline">\(b_2\)</span>, <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_0\)</span> in the expression:</p>
<p><span class="math inline">\(b_3s^{3}+b_2s^{2}+b_1s+b_0\)</span></p>
<p>where <span class="math inline">\(b_3\)</span>, <span class="math inline">\(b_2\)</span>, <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_0\)</span> are:</p>
<div id="3b91fab3-09c0-479c-a185-e14b813c0c7e" class="cell" data-execution_count="116">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>b3 <span class="op">=</span> H_sym_num.coeff(s<span class="op">**</span><span class="dv">3</span>)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>b2 <span class="op">=</span> H_sym_num.coeff(s<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>b1 <span class="op">=</span> H_sym_num.coeff(s<span class="op">**</span><span class="dv">1</span>)</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>b0 <span class="op">=</span> (H_sym_num <span class="op">-</span> b1<span class="op">*</span>s<span class="op">*</span><span class="dv">1</span> <span class="op">-</span> b2<span class="op">*</span>s<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> b3<span class="op">*</span>s<span class="op">**</span><span class="dv">3</span>).expand()</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'&lt;p&gt;$b_3=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;&lt;p&gt;$b_2=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;&lt;p&gt;$b_1=</span><span class="sc">{:s}</span><span class="st">$</span><span class="op">\</span></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/p&gt;&lt;p&gt;$b_0=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;'</span>.<span class="bu">format</span>(latex(b3),latex(b2),latex(b1),latex(b0)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="116">
<p>
<span class="math inline">\(b_3=- C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} R_{20} - C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} R_{20} - C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} R_{20} - C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} R_{20} - C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} R_{20} - C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} R_{20} - C_{10} C_{11} C_{12} R_{15} R_{16} R_{18} R_{20}\)</span>
</p>
<p>
<span class="math inline">\(b_2=- C_{10} C_{11} R_{13} R_{15} R_{20} - C_{10} C_{11} R_{13} R_{16} R_{20} - C_{10} C_{11} R_{13} R_{17} R_{20} - C_{10} C_{11} R_{15} R_{16} R_{20} - C_{10} C_{12} R_{13} R_{17} R_{20} - C_{10} C_{12} R_{13} R_{18} R_{20} - C_{10} C_{12} R_{16} R_{17} R_{20} - C_{10} C_{12} R_{16} R_{18} R_{20} - C_{11} C_{12} R_{15} R_{17} R_{20} - C_{11} C_{12} R_{15} R_{18} R_{20} - C_{11} C_{12} R_{16} R_{17} R_{20} - C_{11} C_{12} R_{16} R_{18} R_{20} - C_{11} C_{12} R_{17} R_{18} R_{20}\)</span>
</p>
<p>
<span class="math inline">\(b_1=- C_{10} R_{13} R_{20} - C_{10} R_{16} R_{20} - C_{11} R_{15} R_{20} - C_{11} R_{16} R_{20} - C_{11} R_{17} R_{20} - C_{12} R_{17} R_{20} - C_{12} R_{18} R_{20}\)</span>
</p>
<p>
<span class="math inline">\(b_0=- R_{20}\)</span>
</p>
</div>
</div>
<p>The roots of the numerator polynomial can easily be found with SymPy. This filter has two transmission zeros, which can be found using the <code>solve</code> function on the numerator polynomial.</p>
<div id="de42e365-1d49-489d-9e37-c8c753e36fb9" class="cell" data-execution_count="117">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>num_root_sym <span class="op">=</span> solve(H_sym_num,s)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>There are three solutions:</p>
<div id="0009d5a7-a43d-406d-b2ed-e9f4de9344ef" class="cell" data-execution_count="118">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'&lt;p&gt;$z_0=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;&lt;p&gt;$z_1=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;&lt;p&gt;$z_2=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;'</span>.<span class="bu">format</span>(latex(num_root_sym[<span class="dv">0</span>]),latex(num_root_sym[<span class="dv">1</span>]),latex(num_root_sym[<span class="dv">2</span>])))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="118">
<p>
<span class="math inline">\(z_0=- \frac{- \frac{3 \left(C_{10} R_{13} + C_{10} R_{16} + C_{11} R_{15} + C_{11} R_{16} + C_{11} R_{17} + C_{12} R_{17} + C_{12} R_{18}\right)}{C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}} + \frac{\left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)^{2}}{\left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{2}}}{3 \sqrt[3]{\frac{\sqrt{- 4 \left(- \frac{3 \left(C_{10} R_{13} + C_{10} R_{16} + C_{11} R_{15} + C_{11} R_{16} + C_{11} R_{17} + C_{12} R_{17} + C_{12} R_{18}\right)}{C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}} + \frac{\left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)^{2}}{\left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{2}}\right)^{3} + \left(- \frac{9 \left(C_{10} R_{13} + C_{10} R_{16} + C_{11} R_{15} + C_{11} R_{16} + C_{11} R_{17} + C_{12} R_{17} + C_{12} R_{18}\right) \left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)}{\left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{2}} + \frac{27}{C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}} + \frac{2 \left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)^{3}}{\left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{3}}\right)^{2}}}{2} - \frac{9 \left(C_{10} R_{13} + C_{10} R_{16} + C_{11} R_{15} + C_{11} R_{16} + C_{11} R_{17} + C_{12} R_{17} + C_{12} R_{18}\right) \left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)}{2 \left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{2}} + \frac{27}{2 \left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)} + \frac{\left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)^{3}}{\left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{3}}}} - \frac{\sqrt[3]{\frac{\sqrt{- 4 \left(- \frac{3 \left(C_{10} R_{13} + C_{10} R_{16} + C_{11} R_{15} + C_{11} R_{16} + C_{11} R_{17} + C_{12} R_{17} + C_{12} R_{18}\right)}{C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}} + \frac{\left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)^{2}}{\left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{2}}\right)^{3} + \left(- \frac{9 \left(C_{10} R_{13} + C_{10} R_{16} + C_{11} R_{15} + C_{11} R_{16} + C_{11} R_{17} + C_{12} R_{17} + C_{12} R_{18}\right) \left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)}{\left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{2}} + \frac{27}{C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}} + \frac{2 \left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)^{3}}{\left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{3}}\right)^{2}}}{2} - \frac{9 \left(C_{10} R_{13} + C_{10} R_{16} + C_{11} R_{15} + C_{11} R_{16} + C_{11} R_{17} + C_{12} R_{17} + C_{12} R_{18}\right) \left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)}{2 \left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{2}} + \frac{27}{2 \left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)} + \frac{\left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)^{3}}{\left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{3}}}}{3} - \frac{C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}}{3 \left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)}\)</span>
</p>
<p>
<span class="math inline">\(z_1=- \frac{- \frac{3 \left(C_{10} R_{13} + C_{10} R_{16} + C_{11} R_{15} + C_{11} R_{16} + C_{11} R_{17} + C_{12} R_{17} + C_{12} R_{18}\right)}{C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}} + \frac{\left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)^{2}}{\left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{2}}}{3 \left(- \frac{1}{2} - \frac{\sqrt{3} i}{2}\right) \sqrt[3]{\frac{\sqrt{- 4 \left(- \frac{3 \left(C_{10} R_{13} + C_{10} R_{16} + C_{11} R_{15} + C_{11} R_{16} + C_{11} R_{17} + C_{12} R_{17} + C_{12} R_{18}\right)}{C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}} + \frac{\left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)^{2}}{\left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{2}}\right)^{3} + \left(- \frac{9 \left(C_{10} R_{13} + C_{10} R_{16} + C_{11} R_{15} + C_{11} R_{16} + C_{11} R_{17} + C_{12} R_{17} + C_{12} R_{18}\right) \left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)}{\left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{2}} + \frac{27}{C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}} + \frac{2 \left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)^{3}}{\left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{3}}\right)^{2}}}{2} - \frac{9 \left(C_{10} R_{13} + C_{10} R_{16} + C_{11} R_{15} + C_{11} R_{16} + C_{11} R_{17} + C_{12} R_{17} + C_{12} R_{18}\right) \left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)}{2 \left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{2}} + \frac{27}{2 \left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)} + \frac{\left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)^{3}}{\left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{3}}}} - \frac{\left(- \frac{1}{2} - \frac{\sqrt{3} i}{2}\right) \sqrt[3]{\frac{\sqrt{- 4 \left(- \frac{3 \left(C_{10} R_{13} + C_{10} R_{16} + C_{11} R_{15} + C_{11} R_{16} + C_{11} R_{17} + C_{12} R_{17} + C_{12} R_{18}\right)}{C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}} + \frac{\left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)^{2}}{\left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{2}}\right)^{3} + \left(- \frac{9 \left(C_{10} R_{13} + C_{10} R_{16} + C_{11} R_{15} + C_{11} R_{16} + C_{11} R_{17} + C_{12} R_{17} + C_{12} R_{18}\right) \left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)}{\left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{2}} + \frac{27}{C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}} + \frac{2 \left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)^{3}}{\left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{3}}\right)^{2}}}{2} - \frac{9 \left(C_{10} R_{13} + C_{10} R_{16} + C_{11} R_{15} + C_{11} R_{16} + C_{11} R_{17} + C_{12} R_{17} + C_{12} R_{18}\right) \left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)}{2 \left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{2}} + \frac{27}{2 \left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)} + \frac{\left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)^{3}}{\left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{3}}}}{3} - \frac{C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}}{3 \left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)}\)</span>
</p>
<p>
<span class="math inline">\(z_2=- \frac{- \frac{3 \left(C_{10} R_{13} + C_{10} R_{16} + C_{11} R_{15} + C_{11} R_{16} + C_{11} R_{17} + C_{12} R_{17} + C_{12} R_{18}\right)}{C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}} + \frac{\left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)^{2}}{\left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{2}}}{3 \left(- \frac{1}{2} + \frac{\sqrt{3} i}{2}\right) \sqrt[3]{\frac{\sqrt{- 4 \left(- \frac{3 \left(C_{10} R_{13} + C_{10} R_{16} + C_{11} R_{15} + C_{11} R_{16} + C_{11} R_{17} + C_{12} R_{17} + C_{12} R_{18}\right)}{C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}} + \frac{\left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)^{2}}{\left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{2}}\right)^{3} + \left(- \frac{9 \left(C_{10} R_{13} + C_{10} R_{16} + C_{11} R_{15} + C_{11} R_{16} + C_{11} R_{17} + C_{12} R_{17} + C_{12} R_{18}\right) \left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)}{\left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{2}} + \frac{27}{C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}} + \frac{2 \left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)^{3}}{\left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{3}}\right)^{2}}}{2} - \frac{9 \left(C_{10} R_{13} + C_{10} R_{16} + C_{11} R_{15} + C_{11} R_{16} + C_{11} R_{17} + C_{12} R_{17} + C_{12} R_{18}\right) \left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)}{2 \left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{2}} + \frac{27}{2 \left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)} + \frac{\left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)^{3}}{\left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{3}}}} - \frac{\left(- \frac{1}{2} + \frac{\sqrt{3} i}{2}\right) \sqrt[3]{\frac{\sqrt{- 4 \left(- \frac{3 \left(C_{10} R_{13} + C_{10} R_{16} + C_{11} R_{15} + C_{11} R_{16} + C_{11} R_{17} + C_{12} R_{17} + C_{12} R_{18}\right)}{C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}} + \frac{\left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)^{2}}{\left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{2}}\right)^{3} + \left(- \frac{9 \left(C_{10} R_{13} + C_{10} R_{16} + C_{11} R_{15} + C_{11} R_{16} + C_{11} R_{17} + C_{12} R_{17} + C_{12} R_{18}\right) \left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)}{\left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{2}} + \frac{27}{C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}} + \frac{2 \left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)^{3}}{\left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{3}}\right)^{2}}}{2} - \frac{9 \left(C_{10} R_{13} + C_{10} R_{16} + C_{11} R_{15} + C_{11} R_{16} + C_{11} R_{17} + C_{12} R_{17} + C_{12} R_{18}\right) \left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)}{2 \left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{2}} + \frac{27}{2 \left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)} + \frac{\left(C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}\right)^{3}}{\left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)^{3}}}}{3} - \frac{C_{10} C_{11} R_{13} R_{15} + C_{10} C_{11} R_{13} R_{16} + C_{10} C_{11} R_{13} R_{17} + C_{10} C_{11} R_{15} R_{16} + C_{10} C_{12} R_{13} R_{17} + C_{10} C_{12} R_{13} R_{18} + C_{10} C_{12} R_{16} R_{17} + C_{10} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{15} R_{17} + C_{11} C_{12} R_{15} R_{18} + C_{11} C_{12} R_{16} R_{17} + C_{11} C_{12} R_{16} R_{18} + C_{11} C_{12} R_{17} R_{18}}{3 \left(C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{15} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{18}\right)}\)</span>
</p>
</div>
</div>
</section>
<section id="denominator-polynomial-of-h_syms-1" class="level4" data-number="27.3.6.3">
<h4 data-number="27.3.6.3" class="anchored" data-anchor-id="denominator-polynomial-of-h_syms-1"><span class="header-section-number">27.3.6.3</span> Denominator Polynomial of <span class="math inline">\(H_{sym}(s)\)</span></h4>
<p>The denominator polynomial of the transfer function is called the characteristic polynomial. The roots of the denominator, also called poles of the system, determine the system’s stability. If any of these roots have a positive real part, the system is unstable, meaning its output will grow unbounded. The roots also influence how the system responds to changes in input (the transient response). They affect things like how quickly the system settles to a new state, whether it oscillates, and the damping of those oscillations. Each root of the characteristic polynomial corresponds to a natural mode of the system.</p>
<p>The denominator polynomial is:</p>
<div id="108f75df-0b81-4cfc-9d2c-152fcac2e7ba" class="cell" data-execution_count="119">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'$D(s)=</span><span class="sc">{:s}</span><span class="st">$'</span>.<span class="bu">format</span>(latex(H_sym_denom)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="119">
<p><span class="math inline">\(D(s)=C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} R_{18} s^{3} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} R_{18} s^{3} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} R_{18} s^{3} + C_{10} C_{11} R_{13} R_{15} R_{17} s^{2} + C_{10} C_{11} R_{13} R_{16} R_{17} s^{2} + C_{10} C_{11} R_{15} R_{16} R_{17} s^{2} + C_{10} C_{12} R_{13} R_{17} R_{18} s^{2} + C_{10} C_{12} R_{16} R_{17} R_{18} s^{2} + C_{10} R_{13} R_{17} s + C_{10} R_{16} R_{17} s + C_{11} C_{12} R_{15} R_{17} R_{18} s^{2} + C_{11} C_{12} R_{16} R_{17} R_{18} s^{2} + C_{11} R_{15} R_{17} s + C_{11} R_{16} R_{17} s + C_{12} R_{17} R_{18} s + R_{17}\)</span></p>
</div>
</div>
<p>The coefficients of each Laplace term can be equated to the variables <span class="math inline">\(a_3\)</span>, <span class="math inline">\(a_2\)</span>, <span class="math inline">\(a_1\)</span> and <span class="math inline">\(a_0\)</span> in the expression:</p>
<p><span class="math inline">\(a_3s^3+a_2s^2+a_1s+a_0\)</span></p>
<p>where <span class="math inline">\(a_3\)</span>, <span class="math inline">\(a_2\)</span>, <span class="math inline">\(a_1\)</span> and <span class="math inline">\(a_0\)</span> are:</p>
<div id="c84fb67c-07d9-4fd1-8ce8-463d47619490" class="cell" data-execution_count="120">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>a3 <span class="op">=</span> H_sym_denom.coeff(s<span class="op">**</span><span class="dv">3</span>)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>a2 <span class="op">=</span> H_sym_denom.coeff(s<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>a1 <span class="op">=</span> H_sym_denom.coeff(s<span class="op">**</span><span class="dv">1</span>)</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>a0 <span class="op">=</span> (H_sym_denom <span class="op">-</span> a1<span class="op">*</span>s<span class="op">*</span><span class="dv">1</span> <span class="op">-</span> a2<span class="op">*</span>s<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> a3<span class="op">*</span>s<span class="op">**</span><span class="dv">3</span>).expand()</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'&lt;p&gt;$a_3=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;&lt;p&gt;$a_2=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;&lt;p&gt;</span><span class="op">\</span></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a><span class="st">    $a_1=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;&lt;p&gt;$a_0=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;'</span>.<span class="bu">format</span>(latex(a3),</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>    latex(a2),latex(a1),latex(a0)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="120">
<p>
<span class="math inline">\(a_3=C_{10} C_{11} C_{12} R_{13} R_{15} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{13} R_{16} R_{17} R_{18} + C_{10} C_{11} C_{12} R_{15} R_{16} R_{17} R_{18}\)</span>
</p>
<p>
<span class="math inline">\(a_2=C_{10} C_{11} R_{13} R_{15} R_{17} + C_{10} C_{11} R_{13} R_{16} R_{17} + C_{10} C_{11} R_{15} R_{16} R_{17} + C_{10} C_{12} R_{13} R_{17} R_{18} + C_{10} C_{12} R_{16} R_{17} R_{18} + C_{11} C_{12} R_{15} R_{17} R_{18} + C_{11} C_{12} R_{16} R_{17} R_{18}\)</span>
</p>
<p>
<span class="math inline">\(a_1=C_{10} R_{13} R_{17} + C_{10} R_{16} R_{17} + C_{11} R_{15} R_{17} + C_{11} R_{16} R_{17} + C_{12} R_{17} R_{18}\)</span>
</p>
<p>
<span class="math inline">\(a_0=R_{17}\)</span>
</p>
</div>
</div>
<p>The roots of the denominator polynomial, which are the poles of the transfer function, can be found with SymPy.</p>
<div id="9f739220-da0c-45e5-8e19-8a67532d4885" class="cell" data-execution_count="121">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>denom_root_sym <span class="op">=</span> solve(H_sym_denom,s)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The poles of the transfer function are:</p>
<div id="9726c3b2-02d8-4920-977f-9291832f48ea" class="cell" data-execution_count="122">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'&lt;p&gt;$p_0=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;&lt;p&gt;$p_1=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;&lt;p&gt;$p_2=</span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;'</span>.<span class="bu">format</span>(latex(denom_root_sym[<span class="dv">0</span>]),latex(denom_root_sym[<span class="dv">1</span>]),latex(denom_root_sym[<span class="dv">2</span>])))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="122">
<p>
<span class="math inline">\(p_0=- \frac{1}{C_{12} R_{18}}\)</span>
</p>
<p>
<span class="math inline">\(p_1=\frac{- C_{10} R_{13} - C_{10} R_{16} - C_{11} R_{15} - C_{11} R_{16} - \sqrt{C_{10}^{2} R_{13}^{2} + 2 C_{10}^{2} R_{13} R_{16} + C_{10}^{2} R_{16}^{2} - 2 C_{10} C_{11} R_{13} R_{15} - 2 C_{10} C_{11} R_{13} R_{16} - 2 C_{10} C_{11} R_{15} R_{16} + 2 C_{10} C_{11} R_{16}^{2} + C_{11}^{2} R_{15}^{2} + 2 C_{11}^{2} R_{15} R_{16} + C_{11}^{2} R_{16}^{2}}}{2 C_{10} C_{11} R_{13} R_{15} + 2 C_{10} C_{11} R_{13} R_{16} + 2 C_{10} C_{11} R_{15} R_{16}}\)</span>
</p>
<p>
<span class="math inline">\(p_2=\frac{- C_{10} R_{13} - C_{10} R_{16} - C_{11} R_{15} - C_{11} R_{16} + \sqrt{C_{10}^{2} R_{13}^{2} + 2 C_{10}^{2} R_{13} R_{16} + C_{10}^{2} R_{16}^{2} - 2 C_{10} C_{11} R_{13} R_{15} - 2 C_{10} C_{11} R_{13} R_{16} - 2 C_{10} C_{11} R_{15} R_{16} + 2 C_{10} C_{11} R_{16}^{2} + C_{11}^{2} R_{15}^{2} + 2 C_{11}^{2} R_{15} R_{16} + C_{11}^{2} R_{16}^{2}}}{2 C_{10} C_{11} R_{13} R_{15} + 2 C_{10} C_{11} R_{13} R_{16} + 2 C_{10} C_{11} R_{15} R_{16}}\)</span>
</p>
</div>
</div>
<p>The expressions for the zeros and poles of <span class="math inline">\(H(s)\)</span> are rather long and not very intuitive.</p>
</section>
<section id="numerical-solution-1" class="level4" data-number="27.3.6.4">
<h4 data-number="27.3.6.4" class="anchored" data-anchor-id="numerical-solution-1"><span class="header-section-number">27.3.6.4</span> Numerical Solution</h4>
<p>After substituting the element values into the network equations, we get the following numerical equations:</p>
<div id="b8b39491-e3b0-4ac0-8004-e849fc0e7065" class="cell" data-execution_count="123">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>equ_N <span class="op">=</span> NE_sym.subs(element_values)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> <span class="st">''</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(shape(equ_N.lhs)[<span class="dv">0</span>]):</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>    temp <span class="op">+=</span> <span class="st">'&lt;p&gt;$</span><span class="sc">{:s}</span><span class="st"> = </span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;'</span>.<span class="bu">format</span>(latex(equ_N.rhs[i]),</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>        latex(round_expr(equ_N.lhs[i],<span class="dv">9</span>)))</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>Markdown(temp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="123">
<p>
<span class="math inline">\(0 = I_{V1} + 0.000165825 v_{1} - 3.7037 \cdot 10^{-5} v_{5} - 4.5455 \cdot 10^{-5} v_{6} - 8.3333 \cdot 10^{-5} v_{7}\)</span>
</p>
<p>
<span class="math inline">\(0 = I_{O2a} + 2.551 \cdot 10^{-6} v_{2} - 2.551 \cdot 10^{-6} v_{5}\)</span>
</p>
<p>
<span class="math inline">\(0 = - 5.0 \cdot 10^{-7} s v_{4} + v_{3} \cdot \left(5.0 \cdot 10^{-7} s + 0.001\right)\)</span>
</p>
<p>
<span class="math inline">\(0 = - 5.0 \cdot 10^{-7} s v_{3} - 2.0 \cdot 10^{-9} s v_{6} + v_{4} \cdot \left(5.02 \cdot 10^{-7} s + 2.1277 \cdot 10^{-5}\right) - 2.1277 \cdot 10^{-5} v_{5}\)</span>
</p>
<p>
<span class="math inline">\(0 = - 2.7 \cdot 10^{-8} s v_{7} - 3.7037 \cdot 10^{-5} v_{1} - 2.551 \cdot 10^{-6} v_{2} - 2.1277 \cdot 10^{-5} v_{4} + v_{5} \cdot \left(2.7 \cdot 10^{-8} s + 6.0865 \cdot 10^{-5}\right)\)</span>
</p>
<p>
<span class="math inline">\(0 = - 2.0 \cdot 10^{-9} s v_{4} - 4.5455 \cdot 10^{-5} v_{1} + v_{6} \cdot \left(2.0 \cdot 10^{-9} s + 4.5455 \cdot 10^{-5}\right)\)</span>
</p>
<p>
<span class="math inline">\(0 = - 2.7 \cdot 10^{-8} s v_{5} - 8.3333 \cdot 10^{-5} v_{1} + v_{7} \cdot \left(2.7 \cdot 10^{-8} s + 8.3333 \cdot 10^{-5}\right)\)</span>
</p>
<p>
<span class="math inline">\(1.0 = v_{1}\)</span>
</p>
<p>
<span class="math inline">\(0 = v_{5}\)</span>
</p>
</div>
</div>
<p>SymPy can solve for unknown node voltages and the unknown currents from the independent voltage source, <span class="math inline">\(V_1\)</span>, and the Op Amp’s output terminal. The unknown currents, <span class="math inline">\(I_{V1}\)</span> and <span class="math inline">\(I_{O1}\)</span>, are not displayed. The node voltages are:</p>
<div id="029a42be-8baa-4ed8-bf27-9a0ae0902b92" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;jupyter&quot;,&quot;value&quot;:{&quot;outputs_hidden&quot;:false}}" data-execution_count="124">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>U <span class="op">=</span> solve(equ_N,X)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> <span class="st">''</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> U.keys():</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">str</span>(i)[<span class="dv">0</span>] <span class="op">==</span> <span class="st">'v'</span>: <span class="co"># only display the node voltages</span></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>        temp <span class="op">+=</span> <span class="st">'&lt;p&gt;$</span><span class="sc">{:s}</span><span class="st"> = </span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;'</span>.<span class="bu">format</span>(latex(i),latex(U[i]))</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>Markdown(temp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="124">
<p>
<span class="math inline">\(v_{1} = 1.0\)</span>
</p>
<p>
<span class="math inline">\(v_{2} = \frac{- 7.62501901595745 \cdot 10^{36} s^{3} - 1.58125055488394 \cdot 10^{41} s^{2} - 1.4965495647969 \cdot 10^{44} s - 5.92359767891683 \cdot 10^{45}}{1.60389694148936 \cdot 10^{35} s^{3} + 3.68772736943907 \cdot 10^{39} s^{2} + 9.98619741295937 \cdot 10^{42} s + 4.08002901353966 \cdot 10^{44}}\)</span>
</p>
<p>
<span class="math inline">\(v_{3} = \frac{4.99999999999999 \cdot 10^{24} s^{2}}{1.17340425531915 \cdot 10^{26} s^{2} + 2.33576402321083 \cdot 10^{30} s + 9.67117988394585 \cdot 10^{31}}\)</span>
</p>
<p>
<span class="math inline">\(v_{4} = \frac{4.99999999999999 \cdot 10^{24} s^{2} + 9.99999999999999 \cdot 10^{27} s}{1.17340425531915 \cdot 10^{26} s^{2} + 2.33576402321083 \cdot 10^{30} s + 9.67117988394585 \cdot 10^{31}}\)</span>
</p>
<p>
<span class="math inline">\(v_{5} = 0.0\)</span>
</p>
<p>
<span class="math inline">\(v_{6} = \frac{4.99999999999999 \cdot 10^{24} s^{2} + 2.331083172147 \cdot 10^{30} s + 9.67117988394585 \cdot 10^{31}}{1.17340425531915 \cdot 10^{26} s^{2} + 2.33576402321083 \cdot 10^{30} s + 9.67117988394585 \cdot 10^{31}}\)</span>
</p>
<p>
<span class="math inline">\(v_{7} = \frac{250000.0}{81.0 s + 250000.0}\)</span>
</p>
</div>
</div>
<p>The voltage transfer function is displayed below.</p>
<div id="08fb3146-226f-4614-ae50-bc1d2a8080bd" class="cell" data-execution_count="125">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>H <span class="op">=</span> (U[v2]<span class="op">/</span>U[v1]).cancel()</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'$H(s)=</span><span class="sc">{:s}</span><span class="st">$'</span>.<span class="bu">format</span>(latex(H)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="125">
<p><span class="math inline">\(H(s)=\frac{- 7.62501901595745 \cdot 10^{36} s^{3} - 1.58125055488394 \cdot 10^{41} s^{2} - 1.4965495647969 \cdot 10^{44} s - 5.92359767891683 \cdot 10^{45}}{1.60389694148936 \cdot 10^{35} s^{3} + 3.68772736943907 \cdot 10^{39} s^{2} + 9.98619741295937 \cdot 10^{42} s + 4.08002901353966 \cdot 10^{44}}\)</span></p>
</div>
</div>
<p>The code below extracts the numerator and denominator polynomials from the voltage transfer function. Then coefficients of the terms are used to build a SciPy transfer function object.</p>
<div id="71c27d4d-1566-4278-a7e9-7984c76daea7" class="cell" data-execution_count="126">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>H_num, H_denom <span class="op">=</span> fraction(H) <span class="co">#returns numerator and denominator</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert symbolic to NumPy polynomial</span></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array(Poly(H_num, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array(Poly(H_denom, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>sys_tf <span class="op">=</span> signal.TransferFunction(a,b)</span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>sys_zeros <span class="op">=</span> np.roots(sys_tf.num)</span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>sys_poles <span class="op">=</span> np.roots(sys_tf.den)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The poles and zeros of the transfer function are plotted on the complex frequency plane with the following code:</p>
<div id="67aa9934-3009-4556-bfa4-69b725ba31c7" class="cell" data-execution_count="127">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>plt.plot(np.real(sys_zeros<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)), np.imag(sys_zeros<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)), <span class="st">'ob'</span>, markerfacecolor<span class="op">=</span><span class="st">'none'</span>)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>plt.plot(np.real(sys_poles<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)), np.imag(sys_poles<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)), <span class="st">'xr'</span>)</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">'Zeros'</span>, <span class="st">'Poles'</span>], loc<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Pole / Zero Plot'</span>)</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'real part, </span><span class="ch">\u03B1</span><span class="st">'</span>)</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'imaginary part, j</span><span class="ch">\u03C9</span><span class="st">'</span>)</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Klon Centaur part 3v1_files/figure-html/cell-127-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The code below generates a table that lists the values of the pole and zero locations.</p>
<div id="fe5f9102-ae71-4a36-bbec-0cf75b9870cd" class="cell" data-execution_count="128">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>table_header <span class="op">=</span> [<span class="st">'Zeros, Hz'</span>, <span class="st">'Poles, Hz'</span>]</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>num_table_rows <span class="op">=</span> <span class="bu">max</span>(<span class="bu">len</span>(sys_zeros),<span class="bu">len</span>(sys_poles))</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>table_row <span class="op">=</span> []</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_table_rows):</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">&lt;</span> <span class="bu">len</span>(sys_zeros):</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>        z <span class="op">=</span> <span class="st">'</span><span class="sc">{:.2f}</span><span class="st">'</span>.<span class="bu">format</span>(sys_zeros[i]<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi))</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>        z <span class="op">=</span> <span class="st">''</span></span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">&lt;</span> <span class="bu">len</span>(sys_poles):</span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a>        p <span class="op">=</span> <span class="st">'</span><span class="sc">{:.2f}</span><span class="st">'</span>.<span class="bu">format</span>(sys_poles[i]<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi))</span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a>        p <span class="op">=</span> <span class="st">''</span></span>
<span id="cb134-14"><a href="#cb134-14" aria-hidden="true" tabindex="-1"></a>    table_row.append([z,p])</span>
<span id="cb134-15"><a href="#cb134-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-16"><a href="#cb134-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tabulate(table_row, headers<span class="op">=</span>table_header,colalign <span class="op">=</span> (<span class="st">'left'</span>,<span class="st">'left'</span>),tablefmt<span class="op">=</span><span class="st">"simple"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Zeros, Hz    Poles, Hz
-----------  -----------
-3142.62     -3161.52
-151.29      -491.22
-6.59        -6.6</code></pre>
</div>
</div>
</section>
<section id="reactive-branch-3b-frequency-response" class="level4" data-number="27.3.6.5">
<h4 data-number="27.3.6.5" class="anchored" data-anchor-id="reactive-branch-3b-frequency-response"><span class="header-section-number">27.3.6.5</span> Reactive Branch 3b Frequency Response</h4>
<p>The amplitude and phase of the reactive branch is plotted below.</p>
<div id="44e31cec-868c-461f-8871-4144891a0062" class="cell" data-execution_count="129">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># setup</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>x_axis <span class="op">=</span> np.logspace(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">2000</span>, endpoint<span class="op">=</span><span class="va">False</span>)<span class="op">*</span><span class="dv">2</span><span class="op">*</span>np.pi</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>color_list <span class="op">=</span> [<span class="st">'tab:blue'</span>,<span class="st">'tab:red'</span>,<span class="st">'tab:green'</span>,<span class="st">'tab:orange'</span>,<span class="st">'k'</span>]</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a><span class="co">#gain_setting = np.array([1,25,50,75,99])/100</span></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a><span class="co">#p1_value = 100e3</span></span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a><span class="co">#tf_num_coef_list = []</span></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a><span class="co">#tf_denom_coef_list = []</span></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a><span class="co">#clean_path1_mag = np.zeros((len(gain_setting),len(x_axis)))</span></span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a><span class="co">#color_list = ['tab:blue','tab:red','tab:green','tab:orange','k']</span></span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a>fig, ax1 <span class="op">=</span> plt.subplots()</span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'magnitude, dB'</span>)</span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'frequency, Hz'</span>)</span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a><span class="co"># instantiate a second y-axes that shares the same x-axis</span></span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> ax1.twinx()</span>
<span id="cb136-21"><a href="#cb136-21" aria-hidden="true" tabindex="-1"></a>color <span class="op">=</span> <span class="st">'k'</span></span>
<span id="cb136-22"><a href="#cb136-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-23"><a href="#cb136-23" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'phase, deg'</span>,color<span class="op">=</span>color)</span>
<span id="cb136-24"><a href="#cb136-24" aria-hidden="true" tabindex="-1"></a>ax2.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelcolor<span class="op">=</span>color)</span>
<span id="cb136-25"><a href="#cb136-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-26"><a href="#cb136-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-27"><a href="#cb136-27" aria-hidden="true" tabindex="-1"></a>NE <span class="op">=</span> NE_sym.subs(element_values)</span>
<span id="cb136-28"><a href="#cb136-28" aria-hidden="true" tabindex="-1"></a>U <span class="op">=</span> solve(NE,X)</span>
<span id="cb136-29"><a href="#cb136-29" aria-hidden="true" tabindex="-1"></a>H <span class="op">=</span> U[v2]<span class="op">/</span>U[v1]</span>
<span id="cb136-30"><a href="#cb136-30" aria-hidden="true" tabindex="-1"></a>num, denom <span class="op">=</span> fraction(H) <span class="co">#returns numerator and denominator</span></span>
<span id="cb136-31"><a href="#cb136-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-32"><a href="#cb136-32" aria-hidden="true" tabindex="-1"></a><span class="co"># convert symbolic to NumPy polynomial</span></span>
<span id="cb136-33"><a href="#cb136-33" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array(Poly(num, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb136-34"><a href="#cb136-34" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array(Poly(denom, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb136-35"><a href="#cb136-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-36"><a href="#cb136-36" aria-hidden="true" tabindex="-1"></a><span class="co">#x = np.logspace(1, 5, 2000, endpoint=False)*2*np.pi</span></span>
<span id="cb136-37"><a href="#cb136-37" aria-hidden="true" tabindex="-1"></a>w, mag, phase <span class="op">=</span> signal.bode((a, b), w<span class="op">=</span>x_axis) <span class="co"># returns: rad/s, mag in dB, phase in deg</span></span>
<span id="cb136-38"><a href="#cb136-38" aria-hidden="true" tabindex="-1"></a><span class="co">#clean_path1_mag[i] = mag</span></span>
<span id="cb136-39"><a href="#cb136-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-40"><a href="#cb136-40" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the results</span></span>
<span id="cb136-41"><a href="#cb136-41" aria-hidden="true" tabindex="-1"></a>i<span class="op">=</span><span class="dv">0</span></span>
<span id="cb136-42"><a href="#cb136-42" aria-hidden="true" tabindex="-1"></a>ax1.semilogx(w<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi), mag,<span class="st">'-k'</span>,label<span class="op">=</span><span class="st">'mag'</span>)    <span class="co"># magnitude plot</span></span>
<span id="cb136-43"><a href="#cb136-43" aria-hidden="true" tabindex="-1"></a>ax2.semilogx(w<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi), phase,<span class="st">':k'</span>,label<span class="op">=</span><span class="st">'phase'</span>)  <span class="co"># phase plot</span></span>
<span id="cb136-44"><a href="#cb136-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-45"><a href="#cb136-45" aria-hidden="true" tabindex="-1"></a><span class="co"># highlight the guitar audio band, 80 to 8kHz</span></span>
<span id="cb136-46"><a href="#cb136-46" aria-hidden="true" tabindex="-1"></a>plt.axvspan(<span class="dv">80</span>, <span class="fl">8e3</span>, color<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>) </span>
<span id="cb136-47"><a href="#cb136-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-48"><a href="#cb136-48" aria-hidden="true" tabindex="-1"></a>ax1.set_ylim((<span class="dv">0</span>,<span class="dv">40</span>))</span>
<span id="cb136-49"><a href="#cb136-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-50"><a href="#cb136-50" aria-hidden="true" tabindex="-1"></a><span class="co"># position legends</span></span>
<span id="cb136-51"><a href="#cb136-51" aria-hidden="true" tabindex="-1"></a>ax1.legend(loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb136-52"><a href="#cb136-52" aria-hidden="true" tabindex="-1"></a>ax2.legend(loc<span class="op">=</span><span class="st">'upper right'</span>)</span>
<span id="cb136-53"><a href="#cb136-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-54"><a href="#cb136-54" aria-hidden="true" tabindex="-1"></a>ax1.grid()</span>
<span id="cb136-55"><a href="#cb136-55" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Magnitude and phase response'</span>)</span>
<span id="cb136-56"><a href="#cb136-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-57"><a href="#cb136-57" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Klon Centaur part 3v1_files/figure-html/cell-129-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>As shown in the amplitude response, there is a lot of gain in this path since <span class="math inline">\(R_{20}\)</span> is relatively large compared to the impedance of the other components connected to the non-inverting input of <span class="math inline">\(U_{2A}\)</span>. One thing to keep in mind is that the effect of <span class="math inline">\(C_{13}\)</span> is not included in the plot above. The zero created at 500 Hz by <span class="math inline">\(C_{13}\)</span> creates a dominating low pass response, which makes me wonder how much do the components <span class="math inline">\(C_{11}\)</span> and <span class="math inline">\(C_{12}\)</span> contribute to the overall tone created by the pedal.</p>
</section>
</section>
<section id="sec-reactive_branch_4" class="level3" data-number="27.3.7">
<h3 data-number="27.3.7" class="anchored" data-anchor-id="sec-reactive_branch_4"><span class="header-section-number">27.3.7</span> Reactive Branch 4</h3>
<p>Reactive branch 4 is the circuit path following the diodes, <span class="math inline">\(D_2\)</span> and <span class="math inline">\(D_3\)</span> and shown in <a href="Klon Centaur part 1.html#fig-klon-centaur-schematic-high-res_w_diode_path2_highlight_sch" class="quarto-xref">Figure&nbsp;<span>25.21</span></a>. The diodes have been commented out in this analysis and <span class="math inline">\(V_1\)</span> has been turned off and <span class="math inline">\(V_2\)</span> is set to a value of 1. The source <span class="math inline">\(V_2\)</span> represents the signal after the diode shaping. In <a href="#fig-reactive_branch_3_4_sch" class="quarto-xref">Figure&nbsp;<span>27.3</span></a> the components from reactive paths 3 and 4 are connected at the non-inverting terminals of <span class="math inline">\(U_{2A}\)</span>. This makes the netlist rather long and the number of equations makes a symbolic solution impracticable. Notice that <span class="math inline">\(C_{13}\)</span> is not included in the netlist, which is noted below.</p>
<div id="82503ffd-e5c9-46a4-9b95-2d289713b303" class="cell" data-execution_count="130">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>Reactive_branch_3_4_net_list <span class="op">=</span> <span class="st">'''</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="st">* Reactive_branch_3&amp;4.asc</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="st">V1 1 0 0</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="st">V2 6 0 1</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="st">R5 1 3 5.1e3</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="st">R8 3 0 1.5e3</span></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a><span class="st">C4 1 3 68e-9</span></span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a><span class="st">C6 3 4 390e-9</span></span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a><span class="st">R9 4 0 1e3</span></span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a><span class="st">Rp1b2 3 5 50e3</span></span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a><span class="st">Rp1a2 5 0 50e3</span></span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a><span class="st">R13 8 7 1e3</span></span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a><span class="st">C11 9 11 2.2e-9</span></span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a><span class="st">R15 11 5 22e3</span></span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a><span class="st">R17 10 5 27e3</span></span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a><span class="st">R18 12 5 12e3</span></span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a><span class="st">C12 10 12 27e-9</span></span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a><span class="st">R16 10 9 47e3</span></span>
<span id="cb137-19"><a href="#cb137-19" aria-hidden="true" tabindex="-1"></a><span class="st">*R20 2 10 100e3</span></span>
<span id="cb137-20"><a href="#cb137-20" aria-hidden="true" tabindex="-1"></a><span class="st">R20 2 10 393e3</span></span>
<span id="cb137-21"><a href="#cb137-21" aria-hidden="true" tabindex="-1"></a><span class="st">*C13 2 10 820e-12</span></span>
<span id="cb137-22"><a href="#cb137-22" aria-hidden="true" tabindex="-1"></a><span class="st">O2a 10 0 2</span></span>
<span id="cb137-23"><a href="#cb137-23" aria-hidden="true" tabindex="-1"></a><span class="st">*D2 0 8 1N34A</span></span>
<span id="cb137-24"><a href="#cb137-24" aria-hidden="true" tabindex="-1"></a><span class="st">*D3 8 0 1N34A</span></span>
<span id="cb137-25"><a href="#cb137-25" aria-hidden="true" tabindex="-1"></a><span class="st">C9 6 7 1e-6</span></span>
<span id="cb137-26"><a href="#cb137-26" aria-hidden="true" tabindex="-1"></a><span class="st">C10 9 8 1e-6</span></span>
<span id="cb137-27"><a href="#cb137-27" aria-hidden="true" tabindex="-1"></a><span class="st">'''</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The following code takes the netlist and builds and displays the MNA equations.</p>
<div id="d77b1609-7aea-4ab9-92d6-699324f843c6" class="cell" data-execution_count="131">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>report, network_df, i_unk_df, A, X, Z <span class="op">=</span> SymMNA.smna(Reactive_branch_3_4_net_list)</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Put matrices into SymPy </span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> Matrix(X)</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> Matrix(Z)</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>NE_sym <span class="op">=</span> Eq(A<span class="op">*</span>X,Z)</span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a><span class="co"># display the equations</span></span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> <span class="st">''</span></span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(shape(NE_sym.lhs)[<span class="dv">0</span>]):</span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a>    temp <span class="op">+=</span> <span class="st">'$</span><span class="sc">{:s}</span><span class="st"> = </span><span class="sc">{:s}</span><span class="st">$&lt;br&gt;'</span>.<span class="bu">format</span>(latex(NE_sym.rhs[i]),latex(NE_sym.lhs[i]))</span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a>Markdown(temp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="131">
<p><span class="math inline">\(0 = I_{V1} + v_{1} \left(C_{4} s + \frac{1}{R_{5}}\right) + v_{3} \left(- C_{4} s - \frac{1}{R_{5}}\right)\)</span><br><span class="math inline">\(0 = I_{O2a} - \frac{v_{10}}{R_{20}} + \frac{v_{2}}{R_{20}}\)</span><br><span class="math inline">\(0 = - C_{6} s v_{4} + v_{1} \left(- C_{4} s - \frac{1}{R_{5}}\right) + v_{3} \left(C_{4} s + C_{6} s + \frac{1}{Rp1b2} + \frac{1}{R_{8}} + \frac{1}{R_{5}}\right) - \frac{v_{5}}{Rp1b2}\)</span><br><span class="math inline">\(0 = - C_{6} s v_{3} + v_{4} \left(C_{6} s + \frac{1}{R_{9}}\right)\)</span><br><span class="math inline">\(0 = v_{5} \cdot \left(\frac{1}{Rp1b2} + \frac{1}{Rp1a2} + \frac{1}{R_{18}} + \frac{1}{R_{17}} + \frac{1}{R_{15}}\right) - \frac{v_{3}}{Rp1b2} - \frac{v_{12}}{R_{18}} - \frac{v_{10}}{R_{17}} - \frac{v_{11}}{R_{15}}\)</span><br><span class="math inline">\(0 = C_{9} s v_{6} - C_{9} s v_{7} + I_{V2}\)</span><br><span class="math inline">\(0 = - C_{9} s v_{6} + v_{7} \left(C_{9} s + \frac{1}{R_{13}}\right) - \frac{v_{8}}{R_{13}}\)</span><br><span class="math inline">\(0 = - C_{10} s v_{9} + v_{8} \left(C_{10} s + \frac{1}{R_{13}}\right) - \frac{v_{7}}{R_{13}}\)</span><br><span class="math inline">\(0 = - C_{10} s v_{8} - C_{11} s v_{11} + v_{9} \left(C_{10} s + C_{11} s + \frac{1}{R_{16}}\right) - \frac{v_{10}}{R_{16}}\)</span><br><span class="math inline">\(0 = - C_{12} s v_{12} + v_{10} \left(C_{12} s + \frac{1}{R_{20}} + \frac{1}{R_{17}} + \frac{1}{R_{16}}\right) - \frac{v_{2}}{R_{20}} - \frac{v_{5}}{R_{17}} - \frac{v_{9}}{R_{16}}\)</span><br><span class="math inline">\(0 = - C_{11} s v_{9} + v_{11} \left(C_{11} s + \frac{1}{R_{15}}\right) - \frac{v_{5}}{R_{15}}\)</span><br><span class="math inline">\(0 = - C_{12} s v_{10} + v_{12} \left(C_{12} s + \frac{1}{R_{18}}\right) - \frac{v_{5}}{R_{18}}\)</span><br><span class="math inline">\(V_{1} = v_{1}\)</span><br><span class="math inline">\(V_{2} = v_{6}\)</span><br><span class="math inline">\(0 = v_{10}\)</span><br></p>
</div>
</div>
<p>Turn the free symbols into SymPy variables and load the element values.</p>
<div id="4c0c24a8-8ceb-4a9b-9e77-5118bc724488" class="cell" data-execution_count="132">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb139"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>var(<span class="bu">str</span>(NE_sym.free_symbols).replace(<span class="st">'{'</span>,<span class="st">''</span>).replace(<span class="st">'}'</span>,<span class="st">''</span>))</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>element_values <span class="op">=</span> SymMNA.get_part_values(network_df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="numerical-solution-for-p1-at-50-3" class="level4" data-number="27.3.7.1">
<h4 data-number="27.3.7.1" class="anchored" data-anchor-id="numerical-solution-for-p1-at-50-3"><span class="header-section-number">27.3.7.1</span> Numerical Solution for P1 at 50%</h4>
<p>Substitute the component values into the network equations and display the numerical equations.</p>
<div id="4cdd978e-4749-4915-8957-421e71f4a757" class="cell" data-execution_count="133">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>equ_N <span class="op">=</span> NE_sym.subs(element_values)</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> <span class="st">''</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(shape(equ_N.lhs)[<span class="dv">0</span>]):</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>    temp <span class="op">+=</span> <span class="st">'&lt;p&gt;$</span><span class="sc">{:s}</span><span class="st"> = </span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;'</span>.<span class="bu">format</span>(latex(equ_N.rhs[i]),</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>        latex(round_expr(equ_N.lhs[i],<span class="dv">7</span>)))</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>Markdown(temp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="133">
<p>
<span class="math inline">\(0 = I_{V1} + v_{1} \cdot \left(1.0 \cdot 10^{-7} s + 0.0001961\right) + v_{3} \left(- 1.0 \cdot 10^{-7} s - 0.0001961\right)\)</span>
</p>
<p>
<span class="math inline">\(0 = I_{O2a} - 2.5 \cdot 10^{-6} v_{10} + 2.5 \cdot 10^{-6} v_{2}\)</span>
</p>
<p>
<span class="math inline">\(0 = - 4.0 \cdot 10^{-7} s v_{4} + v_{1} \left(- 1.0 \cdot 10^{-7} s - 0.0001961\right) + v_{3} \cdot \left(5.0 \cdot 10^{-7} s + 0.0008827\right) - 2.0 \cdot 10^{-5} v_{5}\)</span>
</p>
<p>
<span class="math inline">\(0 = - 4.0 \cdot 10^{-7} s v_{3} + v_{4} \cdot \left(4.0 \cdot 10^{-7} s + 0.001\right)\)</span>
</p>
<p>
<span class="math inline">\(0 = - 3.7 \cdot 10^{-5} v_{10} - 4.55 \cdot 10^{-5} v_{11} - 8.33 \cdot 10^{-5} v_{12} - 2.0 \cdot 10^{-5} v_{3} + 0.0002058 v_{5}\)</span>
</p>
<p>
<span class="math inline">\(0 = I_{V2} + 1.0 \cdot 10^{-6} s v_{6} - 1.0 \cdot 10^{-6} s v_{7}\)</span>
</p>
<p>
<span class="math inline">\(0 = - 1.0 \cdot 10^{-6} s v_{6} + v_{7} \cdot \left(1.0 \cdot 10^{-6} s + 0.001\right) - 0.001 v_{8}\)</span>
</p>
<p>
<span class="math inline">\(0 = - 1.0 \cdot 10^{-6} s v_{9} - 0.001 v_{7} + v_{8} \cdot \left(1.0 \cdot 10^{-6} s + 0.001\right)\)</span>
</p>
<p>
<span class="math inline">\(0 = - 1.0 \cdot 10^{-6} s v_{8} - 2.13 \cdot 10^{-5} v_{10} + v_{9} \cdot \left(1.0 \cdot 10^{-6} s + 2.13 \cdot 10^{-5}\right)\)</span>
</p>
<p>
<span class="math inline">\(0 = 6.09 \cdot 10^{-5} v_{10} - 2.5 \cdot 10^{-6} v_{2} - 3.7 \cdot 10^{-5} v_{5} - 2.13 \cdot 10^{-5} v_{9}\)</span>
</p>
<p>
<span class="math inline">\(0 = 4.55 \cdot 10^{-5} v_{11} - 4.55 \cdot 10^{-5} v_{5}\)</span>
</p>
<p>
<span class="math inline">\(0 = 8.33 \cdot 10^{-5} v_{12} - 8.33 \cdot 10^{-5} v_{5}\)</span>
</p>
<p>
<span class="math inline">\(0 = v_{1}\)</span>
</p>
<p>
<span class="math inline">\(1.0 = v_{6}\)</span>
</p>
<p>
<span class="math inline">\(0 = v_{10}\)</span>
</p>
</div>
</div>
<p>SymPy can solve for unknown node voltages and the unknown currents from the independent voltage source, <span class="math inline">\(V_2\)</span>, and the Op Amp’s output terminal. The unknown currents, <span class="math inline">\(I_{V1}\)</span> and <span class="math inline">\(I_{O1}\)</span>, are not displayed. The node voltages are:</p>
<div id="2a59edb9-eae1-4134-bf9b-687ebcb2965e" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;jupyter&quot;,&quot;value&quot;:{&quot;outputs_hidden&quot;:false}}" data-execution_count="134">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>U <span class="op">=</span> solve(equ_N,X)</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> <span class="st">''</span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> U.keys():</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">str</span>(i)[<span class="dv">0</span>] <span class="op">==</span> <span class="st">'v'</span>: <span class="co"># only display the node voltages</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>        temp <span class="op">+=</span> <span class="st">'&lt;p&gt;$</span><span class="sc">{:s}</span><span class="st"> = </span><span class="sc">{:s}</span><span class="st">$&lt;/p&gt;'</span>.<span class="bu">format</span>(latex(i),latex(U[i]))</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>Markdown(temp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="134">
<p>
<span class="math inline">\(v_{1} = 0.0\)</span>
</p>
<p>
<span class="math inline">\(v_{2} = \frac{- 1.96394441888298 \cdot 10^{71} s^{5} - 7.60825164075479 \cdot 10^{75} s^{4} - 5.90607987153688 \cdot 10^{79} s^{3} - 1.18301509344067 \cdot 10^{83} s^{2} - 6.89566385064667 \cdot 10^{85} s}{1.10336500111661 \cdot 10^{70} s^{5} + 5.26456182674577 \cdot 10^{74} s^{4} + 6.46095251106143 \cdot 10^{78} s^{3} + 1.43698004458909 \cdot 10^{82} s^{2} + 9.04296553120415 \cdot 10^{84} s + 3.50924368989652 \cdot 10^{86}}\)</span>
</p>
<p>
<span class="math inline">\(v_{3} = \frac{2.9615625 \cdot 10^{56} s^{4} + 1.6734375 \cdot 10^{60} s^{3} + 2.34375 \cdot 10^{63} s^{2}}{4.81802717154256 \cdot 10^{54} s^{5} + 2.29885866434566 \cdot 10^{59} s^{4} + 2.82128259649683 \cdot 10^{63} s^{3} + 6.27481286137239 \cdot 10^{66} s^{2} + 3.94876161529248 \cdot 10^{69} s + 1.53236974458815 \cdot 10^{71}}\)</span>
</p>
<p>
<span class="math inline">\(v_{4} = \frac{2.9615625 \cdot 10^{56} s^{4} + 9.14062499999999 \cdot 10^{59} s^{3}}{4.81802717154256 \cdot 10^{54} s^{5} + 2.29885866434566 \cdot 10^{59} s^{4} + 2.82128259649683 \cdot 10^{63} s^{3} + 6.27481286137239 \cdot 10^{66} s^{2} + 3.94876161529248 \cdot 10^{69} s + 1.53236974458815 \cdot 10^{71}}\)</span>
</p>
<p>
<span class="math inline">\(v_{5} = \frac{1.00693125 \cdot 10^{54} s^{5} + 3.35690238970588 \cdot 10^{58} s^{4} + 1.275328125 \cdot 10^{62} s^{3} + 1.0344669117647 \cdot 10^{65} s^{2}}{4.81802717154256 \cdot 10^{54} s^{5} + 2.29885866434566 \cdot 10^{59} s^{4} + 2.82128259649683 \cdot 10^{63} s^{3} + 6.27481286137239 \cdot 10^{66} s^{2} + 3.94876161529248 \cdot 10^{69} s + 1.53236974458815 \cdot 10^{71}}\)</span>
</p>
<p>
<span class="math inline">\(v_{6} = 1.0\)</span>
</p>
<p>
<span class="math inline">\(v_{7} = \frac{4.81802717154256 \cdot 10^{54} s^{5} + 2.29627373138023 \cdot 10^{59} s^{4} + 2.81149214573178 \cdot 10^{63} s^{3} + 6.20412190793865 \cdot 10^{66} s^{2} + 3.81322450115202 \cdot 10^{69} s + 7.66184872294075 \cdot 10^{70}}{4.81802717154256 \cdot 10^{54} s^{5} + 2.29885866434566 \cdot 10^{59} s^{4} + 2.82128259649683 \cdot 10^{63} s^{3} + 6.27481286137239 \cdot 10^{66} s^{2} + 3.94876161529248 \cdot 10^{69} s + 1.53236974458815 \cdot 10^{71}}\)</span>
</p>
<p>
<span class="math inline">\(v_{8} = \frac{4.559533875 \cdot 10^{54} s^{5} + 2.19836922372969 \cdot 10^{59} s^{4} + 2.74080119229803 \cdot 10^{63} s^{3} + 6.06858479379818 \cdot 10^{66} s^{2} + 3.73660601392261 \cdot 10^{69} s + 7.66184872294075 \cdot 10^{70}}{4.81802717154256 \cdot 10^{54} s^{5} + 2.29885866434566 \cdot 10^{59} s^{4} + 2.82128259649683 \cdot 10^{63} s^{3} + 6.27481286137239 \cdot 10^{66} s^{2} + 3.94876161529248 \cdot 10^{69} s + 1.53236974458815 \cdot 10^{71}}\)</span>
</p>
<p>
<span class="math inline">\(v_{9} = \frac{4.559533875 \cdot 10^{54} s^{5} + 2.19578429076426 \cdot 10^{59} s^{4} + 2.73101074153298 \cdot 10^{63} s^{3} + 5.99789384036444 \cdot 10^{66} s^{2} + 3.60106889978214 \cdot 10^{69} s}{4.81802717154256 \cdot 10^{54} s^{5} + 2.29885866434566 \cdot 10^{59} s^{4} + 2.82128259649683 \cdot 10^{63} s^{3} + 6.27481286137239 \cdot 10^{66} s^{2} + 3.94876161529248 \cdot 10^{69} s + 1.53236974458815 \cdot 10^{71}}\)</span>
</p>
<p>
<span class="math inline">\(v_{10} = 0.0\)</span>
</p>
<p>
<span class="math inline">\(v_{11} = \frac{4.559533875 \cdot 10^{54} s^{5} + 1.46177548394608 \cdot 10^{59} s^{4} + 4.04388334558824 \cdot 10^{62} s^{3} + 2.77738425925926 \cdot 10^{65} s^{2}}{4.81802717154256 \cdot 10^{54} s^{5} + 2.29885866434566 \cdot 10^{59} s^{4} + 2.82128259649683 \cdot 10^{63} s^{3} + 6.27481286137239 \cdot 10^{66} s^{2} + 3.94876161529248 \cdot 10^{69} s + 1.53236974458815 \cdot 10^{71}}\)</span>
</p>
<p>
<span class="math inline">\(v_{12} = \frac{3.1078125 \cdot 10^{57} s^{4} + 9.40160845588234 \cdot 10^{61} s^{3} + 1.0344669117647 \cdot 10^{65} s^{2}}{4.81802717154256 \cdot 10^{54} s^{5} + 2.29885866434566 \cdot 10^{59} s^{4} + 2.82128259649683 \cdot 10^{63} s^{3} + 6.27481286137239 \cdot 10^{66} s^{2} + 3.94876161529248 \cdot 10^{69} s + 1.53236974458815 \cdot 10^{71}}\)</span>
</p>
</div>
</div>
<p>The network transfer function, <span class="math inline">\(H(s)=\frac {v_2(s)}{v_1(s)}\)</span>, is:</p>
<div id="b6aead93-a9b9-43a3-b31c-b2a8524b15a0" class="cell" data-execution_count="135">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>H <span class="op">=</span> (U[v2]<span class="op">/</span>U[v6]).cancel()</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">'$H(s)=</span><span class="sc">{:s}</span><span class="st">$'</span>.<span class="bu">format</span>(latex(H)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="135">
<p><span class="math inline">\(H(s)=\frac{- 1.96394441888298 \cdot 10^{71} s^{5} - 7.60825164075479 \cdot 10^{75} s^{4} - 5.90607987153688 \cdot 10^{79} s^{3} - 1.18301509344067 \cdot 10^{83} s^{2} - 6.89566385064667 \cdot 10^{85} s}{1.10336500111661 \cdot 10^{70} s^{5} + 5.26456182674577 \cdot 10^{74} s^{4} + 6.46095251106143 \cdot 10^{78} s^{3} + 1.43698004458909 \cdot 10^{82} s^{2} + 9.04296553120415 \cdot 10^{84} s + 3.50924368989652 \cdot 10^{86}}\)</span></p>
</div>
</div>
<p>The SciPy function, <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.TransferFunction.html">TransferFunction</a>, is used to represent the system as the continuous-time transfer function. The code below extracts the numerator and denominator polynomials from the voltage transfer function. Then coefficients of the terms are used to build a SciPy transfer function object.</p>
<div id="6eb6384e-c455-48f2-bff5-f8a6a924a7b4" class="cell" data-execution_count="136">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>H_num, H_denom <span class="op">=</span> fraction(H) <span class="co">#returns numerator and denominator</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert symbolic to NumPy polynomial</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array(Poly(H_num, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array(Poly(H_denom, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>sys_tf <span class="op">=</span> signal.TransferFunction(a,b)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="pole-zero-plot-2" class="level4" data-number="27.3.7.2">
<h4 data-number="27.3.7.2" class="anchored" data-anchor-id="pole-zero-plot-2"><span class="header-section-number">27.3.7.2</span> Pole Zero Plot</h4>
<p>The poles and zeros of the transfer function can easily be obtained with the following code:</p>
<div id="7deeaec4-225b-489e-9758-9d80e2667395" class="cell" data-execution_count="137">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>sys_zeros <span class="op">=</span> np.roots(sys_tf.num)</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>sys_poles <span class="op">=</span> np.roots(sys_tf.den)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The poles and zeros of the transfer function are plotted on the complex frequency plane with the following code:</p>
<div id="3a8f53d9-62a6-433d-8c3e-0d4ad87a4023" class="cell" data-execution_count="138">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb145"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>plt.plot(np.real(sys_zeros<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)), np.imag(sys_zeros<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)), <span class="st">'ob'</span>, markerfacecolor<span class="op">=</span><span class="st">'none'</span>)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>plt.plot(np.real(sys_poles<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)), np.imag(sys_poles<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)), <span class="st">'xr'</span>)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">'Zeros'</span>, <span class="st">'Poles'</span>], loc<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Pole / Zero Plot'</span>)</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'real part, </span><span class="ch">\u03B1</span><span class="st">'</span>)</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'imaginary part, j</span><span class="ch">\u03C9</span><span class="st">'</span>)</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Klon Centaur part 3v1_files/figure-html/cell-138-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The code below generates a table that lists the values of the pole and zero locations.</p>
<div id="1abaafc8-20d3-455b-ba52-60009a234be0" class="cell" data-execution_count="139">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>table_header <span class="op">=</span> [<span class="st">'Zeros, Hz'</span>, <span class="st">'Poles, Hz'</span>]</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>num_table_rows <span class="op">=</span> <span class="bu">max</span>(<span class="bu">len</span>(sys_zeros),<span class="bu">len</span>(sys_poles))</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>table_row <span class="op">=</span> []</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_table_rows):</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">&lt;</span> <span class="bu">len</span>(sys_zeros):</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>        z <span class="op">=</span> <span class="st">'</span><span class="sc">{:.2f}</span><span class="st">'</span>.<span class="bu">format</span>(sys_zeros[i]<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi))</span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>        z <span class="op">=</span> <span class="st">''</span></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">&lt;</span> <span class="bu">len</span>(sys_poles):</span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>        p <span class="op">=</span> <span class="st">'</span><span class="sc">{:.2f}</span><span class="st">'</span>.<span class="bu">format</span>(sys_poles[i]<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi))</span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a>        p <span class="op">=</span> <span class="st">''</span></span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a>    table_row.append([z,p])</span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tabulate(table_row, headers<span class="op">=</span>table_header,colalign <span class="op">=</span> (<span class="st">'left'</span>,<span class="st">'left'</span>),tablefmt<span class="op">=</span><span class="st">"simple"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Zeros, Hz    Poles, Hz
-----------  -----------
-4631.99     -4629.79
-1110.36     -2545.69
-243         -231.62
-180.26      -180.17
0            -6.6</code></pre>
</div>
</div>
</section>
<section id="polezero-locus-plot-versus-p1-value-1" class="level4" data-number="27.3.7.3">
<h4 data-number="27.3.7.3" class="anchored" data-anchor-id="polezero-locus-plot-versus-p1-value-1"><span class="header-section-number">27.3.7.3</span> Pole/Zero Locus Plot versus P1 value</h4>
<p>There are six zeros and six poles. The code below solves the network equations and finds the numerator and denominator roots of the transfer function for various rotation positions of <span class="math inline">\(P_1\)</span>.</p>
<div id="a9ffa06d-ce5b-4f82-ad09-e82749241d92" class="cell" data-execution_count="140">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>p1_value <span class="op">=</span> <span class="fl">100e3</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>num_roots <span class="op">=</span> []</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>denom_roots <span class="op">=</span> []</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.linspace(<span class="dv">1</span>,<span class="dv">99</span>,<span class="dv">20</span>)<span class="op">/</span><span class="dv">100</span>:</span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>    element_values[Rp1a2] <span class="op">=</span> p1_value <span class="op">-</span> i<span class="op">*</span>p1_value</span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>    element_values[Rp1b2] <span class="op">=</span> i<span class="op">*</span>p1_value</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>    NE <span class="op">=</span> NE_sym.subs(element_values)</span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>    U <span class="op">=</span> solve(NE,X)</span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a>    H <span class="op">=</span> U[v2]<span class="op">/</span>U[v6]</span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a>    num, denom <span class="op">=</span> fraction(H) <span class="co">#returns numerator and denominator</span></span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># convert symbolic to NumPy polynomial</span></span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> np.array(Poly(num, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> np.array(Poly(denom, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)    </span>
<span id="cb148-16"><a href="#cb148-16" aria-hidden="true" tabindex="-1"></a>    sys_tf <span class="op">=</span> signal.TransferFunction(a,b)</span>
<span id="cb148-17"><a href="#cb148-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb148-18"><a href="#cb148-18" aria-hidden="true" tabindex="-1"></a>    num_roots.append(np.roots(sys_tf.num))</span>
<span id="cb148-19"><a href="#cb148-19" aria-hidden="true" tabindex="-1"></a>    denom_roots.append(np.roots(sys_tf.den))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The range of values taken on by the zeros as <span class="math inline">\(P_1\)</span> is rotated are printed below.</p>
<div id="e1ccbac5-46ca-45bb-8c52-40fccabed10f" class="cell" data-execution_count="141">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb149"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># put the zeros into an array</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>z0_locus <span class="op">=</span> np.zeros(<span class="bu">len</span>(np.array(num_roots)))</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>z1_locus <span class="op">=</span> np.zeros(<span class="bu">len</span>(np.array(num_roots)))</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>z2_locus <span class="op">=</span> np.zeros(<span class="bu">len</span>(np.array(num_roots)))</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>z3_locus <span class="op">=</span> np.zeros(<span class="bu">len</span>(np.array(num_roots)))</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>z4_locus <span class="op">=</span> np.zeros(<span class="bu">len</span>(np.array(num_roots)))</span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(np.array(num_roots))):</span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a>    z0_locus[i] <span class="op">=</span> <span class="op">-</span>np.array(num_roots)[i][<span class="dv">0</span>]    </span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a>    z1_locus[i] <span class="op">=</span> <span class="op">-</span>np.array(num_roots)[i][<span class="dv">1</span>]        </span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a>    z2_locus[i] <span class="op">=</span> <span class="op">-</span>np.array(num_roots)[i][<span class="dv">2</span>]    </span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a>    z3_locus[i] <span class="op">=</span> <span class="op">-</span>np.array(num_roots)[i][<span class="dv">3</span>]  </span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a>    z4_locus[i] <span class="op">=</span> <span class="op">-</span>np.array(num_roots)[i][<span class="dv">4</span>]    </span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'z0 range as a function of P1: </span><span class="sc">{</span>z0_locus<span class="sc">.</span><span class="bu">min</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> to </span><span class="sc">{</span>z0_locus<span class="sc">.</span><span class="bu">max</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> kHz'</span>)</span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'z1 range as a function of P1: </span><span class="sc">{</span>z1_locus<span class="sc">.</span><span class="bu">min</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> to </span><span class="sc">{</span>z1_locus<span class="sc">.</span><span class="bu">max</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> kHz'</span>)</span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'z2 range as a function of P1: </span><span class="sc">{</span>z2_locus<span class="sc">.</span><span class="bu">min</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> to </span><span class="sc">{</span>z2_locus<span class="sc">.</span><span class="bu">max</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> kHz'</span>)</span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'z3 range as a function of P1: </span><span class="sc">{</span>z3_locus<span class="sc">.</span><span class="bu">min</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> to </span><span class="sc">{</span>z3_locus<span class="sc">.</span><span class="bu">max</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> kHz'</span>)</span>
<span id="cb149-19"><a href="#cb149-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'z4 range as a function of P1: </span><span class="sc">{</span>z4_locus<span class="sc">.</span><span class="bu">min</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> to </span><span class="sc">{</span>z4_locus<span class="sc">.</span><span class="bu">max</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> kHz'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>z0 range as a function of P1: 4.611 to 5.652 kHz
z1 range as a function of P1: 1.111 to 2.529 kHz
z2 range as a function of P1: 0.243 to 0.467 kHz
z3 range as a function of P1: 0.179 to 0.181 kHz
z4 range as a function of P1: -0.000 to -0.000 kHz</code></pre>
</div>
</div>
<p>The plot provides a visual indication of how the zeros change in frequency as a function of the rotational position of <span class="math inline">\(P_1\)</span>.</p>
<div id="6163248b-cf20-4a61-afe4-e2753df8cbbc" class="cell" data-execution_count="142">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb151"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>plt.plot(np.linspace(<span class="dv">1</span>,<span class="dv">99</span>,<span class="bu">len</span>(np.array(num_roots))),z0_locus<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span>,<span class="st">'x-'</span>, markerfacecolor<span class="op">=</span><span class="st">'none'</span>,label<span class="op">=</span><span class="st">'z_0'</span>)</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>plt.plot(np.linspace(<span class="dv">1</span>,<span class="dv">99</span>,<span class="bu">len</span>(np.array(num_roots))),z1_locus<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span>,<span class="st">'x-'</span>, markerfacecolor<span class="op">=</span><span class="st">'none'</span>,label<span class="op">=</span><span class="st">'z_1'</span>)</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>plt.plot(np.linspace(<span class="dv">1</span>,<span class="dv">99</span>,<span class="bu">len</span>(np.array(num_roots))),z2_locus<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span>,<span class="st">'x-'</span>, markerfacecolor<span class="op">=</span><span class="st">'none'</span>,label<span class="op">=</span><span class="st">'z_2'</span>)</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>plt.plot(np.linspace(<span class="dv">1</span>,<span class="dv">99</span>,<span class="bu">len</span>(np.array(num_roots))),z3_locus<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span>,<span class="st">'x-'</span>, markerfacecolor<span class="op">=</span><span class="st">'none'</span>,label<span class="op">=</span><span class="st">'z_3'</span>)</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>plt.ylim((<span class="dv">0</span>,<span class="dv">6</span>))</span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Gain control pole &amp; zero frequency plot vs gain rotation %'</span>)</span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Gain rotation percentage'</span>)</span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'pole and zero frequency, kHz'</span>)</span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Klon Centaur part 3v1_files/figure-html/cell-142-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>As shown above, the zeros are relatively constant versus <span class="math inline">\(P_1\)</span> for most of the rotational range.</p>
<p>The range of values for each of the poles as function of <span class="math inline">\(P_1\)</span> are printed below.</p>
<div id="d897cea2-11c6-4a67-87c4-3a13b3973a50" class="cell" data-execution_count="143">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># put the poles into an array</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>p0_locus <span class="op">=</span> np.zeros(<span class="bu">len</span>(np.array(denom_roots)))</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>p1_locus <span class="op">=</span> np.zeros(<span class="bu">len</span>(np.array(denom_roots)))</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>p2_locus <span class="op">=</span> np.zeros(<span class="bu">len</span>(np.array(denom_roots)))</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>p3_locus <span class="op">=</span> np.zeros(<span class="bu">len</span>(np.array(denom_roots)))</span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>p4_locus <span class="op">=</span> np.zeros(<span class="bu">len</span>(np.array(denom_roots)))</span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(np.array(denom_roots))):</span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a>    p0_locus[i] <span class="op">=</span> <span class="op">-</span>np.array(denom_roots)[i][<span class="dv">0</span>]    </span>
<span id="cb152-10"><a href="#cb152-10" aria-hidden="true" tabindex="-1"></a>    p1_locus[i] <span class="op">=</span> <span class="op">-</span>np.array(denom_roots)[i][<span class="dv">1</span>]       </span>
<span id="cb152-11"><a href="#cb152-11" aria-hidden="true" tabindex="-1"></a>    p2_locus[i] <span class="op">=</span> <span class="op">-</span>np.array(denom_roots)[i][<span class="dv">2</span>]      </span>
<span id="cb152-12"><a href="#cb152-12" aria-hidden="true" tabindex="-1"></a>    p3_locus[i] <span class="op">=</span> <span class="op">-</span>np.array(denom_roots)[i][<span class="dv">3</span>]      </span>
<span id="cb152-13"><a href="#cb152-13" aria-hidden="true" tabindex="-1"></a>    p4_locus[i] <span class="op">=</span> <span class="op">-</span>np.array(denom_roots)[i][<span class="dv">4</span>]      </span>
<span id="cb152-14"><a href="#cb152-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-15"><a href="#cb152-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'p0 range as a function of P1: </span><span class="sc">{</span>p0_locus<span class="sc">.</span><span class="bu">min</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> to </span><span class="sc">{</span>p0_locus<span class="sc">.</span><span class="bu">max</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> kHz'</span>)</span>
<span id="cb152-16"><a href="#cb152-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'p1 range as a function of P1: </span><span class="sc">{</span>p1_locus<span class="sc">.</span><span class="bu">min</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> to </span><span class="sc">{</span>p1_locus<span class="sc">.</span><span class="bu">max</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> kHz'</span>)</span>
<span id="cb152-17"><a href="#cb152-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'p2 range as a function of P1: </span><span class="sc">{</span>p2_locus<span class="sc">.</span><span class="bu">min</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> to </span><span class="sc">{</span>p2_locus<span class="sc">.</span><span class="bu">max</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> kHz'</span>)</span>
<span id="cb152-18"><a href="#cb152-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'p3 range as a function of P1: </span><span class="sc">{</span>p3_locus<span class="sc">.</span><span class="bu">min</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> to </span><span class="sc">{</span>p3_locus<span class="sc">.</span><span class="bu">max</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> kHz'</span>)</span>
<span id="cb152-19"><a href="#cb152-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'p4 range as a function of P1: </span><span class="sc">{</span>p4_locus<span class="sc">.</span><span class="bu">min</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> to </span><span class="sc">{</span>p4_locus<span class="sc">.</span><span class="bu">max</span>()<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span><span class="sc">:.3f}</span><span class="ss"> kHz'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>p0 range as a function of P1: 4.611 to 5.043 kHz
p1 range as a function of P1: 2.546 to 3.046 kHz
p2 range as a function of P1: 0.232 to 0.455 kHz
p3 range as a function of P1: 0.179 to 0.181 kHz
p4 range as a function of P1: 0.007 to 0.007 kHz</code></pre>
</div>
</div>
<p>The plot provides a visual indication of how the poles change in frequency as a function of the rotational position of <span class="math inline">\(P_1\)</span>.</p>
<div id="cb459130-f996-488f-8f57-5597531ce344" class="cell" data-execution_count="144">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>plt.plot(np.linspace(<span class="dv">1</span>,<span class="dv">99</span>,<span class="bu">len</span>(np.array(denom_roots))),p0_locus<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span>,<span class="st">'x-'</span>, markerfacecolor<span class="op">=</span><span class="st">'none'</span>,label<span class="op">=</span><span class="st">'p_0'</span>)</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>plt.plot(np.linspace(<span class="dv">1</span>,<span class="dv">99</span>,<span class="bu">len</span>(np.array(denom_roots))),p1_locus<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span>,<span class="st">'x-'</span>, markerfacecolor<span class="op">=</span><span class="st">'none'</span>,label<span class="op">=</span><span class="st">'p_1'</span>)</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>plt.plot(np.linspace(<span class="dv">1</span>,<span class="dv">99</span>,<span class="bu">len</span>(np.array(denom_roots))),p2_locus<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span>,<span class="st">'x-'</span>, markerfacecolor<span class="op">=</span><span class="st">'none'</span>,label<span class="op">=</span><span class="st">'p_2'</span>)</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>plt.plot(np.linspace(<span class="dv">1</span>,<span class="dv">99</span>,<span class="bu">len</span>(np.array(denom_roots))),p3_locus<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi)<span class="op">/</span><span class="fl">1e3</span>,<span class="st">'x-'</span>, markerfacecolor<span class="op">=</span><span class="st">'none'</span>,label<span class="op">=</span><span class="st">'p_3'</span>)</span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>plt.ylim((<span class="dv">0</span>,<span class="dv">6</span>))</span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Gain control pole &amp; zero frequency plot vs gain rotation %'</span>)</span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Gain rotation percentage'</span>)</span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'pole and zero frequency, kHz'</span>)</span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Klon Centaur part 3v1_files/figure-html/cell-144-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>As shown above, the poles are relatively constant versus <span class="math inline">\(P_1\)</span> for most of the rotational range.</p>
</section>
<section id="reactive-branch-4-frequency-response" class="level4" data-number="27.3.7.4">
<h4 data-number="27.3.7.4" class="anchored" data-anchor-id="reactive-branch-4-frequency-response"><span class="header-section-number">27.3.7.4</span> Reactive Branch 4 Frequency Response</h4>
<p>The frequency response of reactive branch 4 is plotted below. The gain setting is a percent of full scale.</p>
<div id="b5b58e06-be54-45c0-a2c9-3178e4380ed4" class="cell" data-execution_count="145">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># setup</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>x_axis <span class="op">=</span> np.logspace(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">2000</span>, endpoint<span class="op">=</span><span class="va">False</span>)<span class="op">*</span><span class="dv">2</span><span class="op">*</span>np.pi</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>color_list <span class="op">=</span> [<span class="st">'tab:blue'</span>,<span class="st">'tab:red'</span>,<span class="st">'tab:green'</span>,<span class="st">'tab:orange'</span>,<span class="st">'k'</span>]</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>gain_setting <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">25</span>,<span class="dv">50</span>,<span class="dv">75</span>,<span class="dv">99</span>])<span class="op">/</span><span class="dv">100</span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>p1_value <span class="op">=</span> <span class="fl">100e3</span></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a><span class="co">#tf_num_coef_list = []</span></span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a><span class="co">#tf_denom_coef_list = []</span></span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a><span class="co">#clean_path1_mag = np.zeros((len(gain_setting),len(x_axis)))</span></span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a><span class="co">#color_list = ['tab:blue','tab:red','tab:green','tab:orange','k']</span></span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a>fig, ax1 <span class="op">=</span> plt.subplots()</span>
<span id="cb155-16"><a href="#cb155-16" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'magnitude, dB'</span>)</span>
<span id="cb155-17"><a href="#cb155-17" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'frequency, Hz'</span>)</span>
<span id="cb155-18"><a href="#cb155-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-19"><a href="#cb155-19" aria-hidden="true" tabindex="-1"></a><span class="co"># instantiate a second y-axes that shares the same x-axis</span></span>
<span id="cb155-20"><a href="#cb155-20" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> ax1.twinx()</span>
<span id="cb155-21"><a href="#cb155-21" aria-hidden="true" tabindex="-1"></a>color <span class="op">=</span> <span class="st">'k'</span></span>
<span id="cb155-22"><a href="#cb155-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-23"><a href="#cb155-23" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'phase, deg'</span>,color<span class="op">=</span>color)</span>
<span id="cb155-24"><a href="#cb155-24" aria-hidden="true" tabindex="-1"></a>ax2.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelcolor<span class="op">=</span>color)</span>
<span id="cb155-25"><a href="#cb155-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-26"><a href="#cb155-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(gain_setting)):</span>
<span id="cb155-27"><a href="#cb155-27" aria-hidden="true" tabindex="-1"></a>    element_values[Rp1a2] <span class="op">=</span> p1_value <span class="op">-</span> gain_setting[i]<span class="op">*</span>p1_value</span>
<span id="cb155-28"><a href="#cb155-28" aria-hidden="true" tabindex="-1"></a>    element_values[Rp1b2] <span class="op">=</span> gain_setting[i]<span class="op">*</span>p1_value</span>
<span id="cb155-29"><a href="#cb155-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb155-30"><a href="#cb155-30" aria-hidden="true" tabindex="-1"></a>    <span class="co">#element_values[Rp1a2] = p1_value - gain_setting[i]*p1_value</span></span>
<span id="cb155-31"><a href="#cb155-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">#element_values[Rp1b2] = gain_setting[i]*p1_value</span></span>
<span id="cb155-32"><a href="#cb155-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb155-33"><a href="#cb155-33" aria-hidden="true" tabindex="-1"></a>    NE <span class="op">=</span> NE_sym.subs(element_values)</span>
<span id="cb155-34"><a href="#cb155-34" aria-hidden="true" tabindex="-1"></a>    U <span class="op">=</span> solve(NE,X)</span>
<span id="cb155-35"><a href="#cb155-35" aria-hidden="true" tabindex="-1"></a>    H <span class="op">=</span> U[v2]<span class="op">/</span>U[v6]</span>
<span id="cb155-36"><a href="#cb155-36" aria-hidden="true" tabindex="-1"></a>    num, denom <span class="op">=</span> fraction(H) <span class="co">#returns numerator and denominator</span></span>
<span id="cb155-37"><a href="#cb155-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-38"><a href="#cb155-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># convert symbolic to NumPy polynomial</span></span>
<span id="cb155-39"><a href="#cb155-39" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> np.array(Poly(num, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb155-40"><a href="#cb155-40" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> np.array(Poly(denom, s).all_coeffs(), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb155-41"><a href="#cb155-41" aria-hidden="true" tabindex="-1"></a>    <span class="co">#tf_num_coef_list.append(a)</span></span>
<span id="cb155-42"><a href="#cb155-42" aria-hidden="true" tabindex="-1"></a>    <span class="co">#tf_denom_coef_list.append(b)</span></span>
<span id="cb155-43"><a href="#cb155-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb155-44"><a href="#cb155-44" aria-hidden="true" tabindex="-1"></a>    <span class="co">#x = np.logspace(1, 5, 2000, endpoint=False)*2*np.pi</span></span>
<span id="cb155-45"><a href="#cb155-45" aria-hidden="true" tabindex="-1"></a>    w, mag, phase <span class="op">=</span> signal.bode((a, b), w<span class="op">=</span>x_axis) <span class="co"># returns: rad/s, mag in dB, phase in deg</span></span>
<span id="cb155-46"><a href="#cb155-46" aria-hidden="true" tabindex="-1"></a>    <span class="co">#clean_path1_mag[i] = mag</span></span>
<span id="cb155-47"><a href="#cb155-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb155-48"><a href="#cb155-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot the results.  </span></span>
<span id="cb155-49"><a href="#cb155-49" aria-hidden="true" tabindex="-1"></a>    ax1.semilogx(w<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi), mag,<span class="st">'-'</span>,color<span class="op">=</span>color_list[i],label<span class="op">=</span><span class="st">'mag: </span><span class="sc">{:.0f}</span><span class="st">%'</span>.<span class="bu">format</span>(gain_setting[i]<span class="op">*</span><span class="dv">100</span>))    <span class="co"># magnitude plot</span></span>
<span id="cb155-50"><a href="#cb155-50" aria-hidden="true" tabindex="-1"></a>    ax2.semilogx(w<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi), phase,<span class="st">':'</span>,color<span class="op">=</span>color_list[i],label<span class="op">=</span><span class="st">'phase: </span><span class="sc">{:.0f}</span><span class="st">%'</span>.<span class="bu">format</span>(gain_setting[i]<span class="op">*</span><span class="dv">100</span>))  <span class="co"># phase plot</span></span>
<span id="cb155-51"><a href="#cb155-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-52"><a href="#cb155-52" aria-hidden="true" tabindex="-1"></a><span class="co"># highlight the guitar audio band, 80 to 8kHz</span></span>
<span id="cb155-53"><a href="#cb155-53" aria-hidden="true" tabindex="-1"></a>plt.axvspan(<span class="dv">80</span>, <span class="fl">8e3</span>, color<span class="op">=</span><span class="st">'y'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>) </span>
<span id="cb155-54"><a href="#cb155-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-55"><a href="#cb155-55" aria-hidden="true" tabindex="-1"></a><span class="co">#ax1.set_ylim((0,15))</span></span>
<span id="cb155-56"><a href="#cb155-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-57"><a href="#cb155-57" aria-hidden="true" tabindex="-1"></a><span class="co"># position legends outside the graph</span></span>
<span id="cb155-58"><a href="#cb155-58" aria-hidden="true" tabindex="-1"></a>ax1.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.6</span>,<span class="dv">1</span>)) <span class="co"># magnitude legend position: relative (horizontal position, vertical position) </span></span>
<span id="cb155-59"><a href="#cb155-59" aria-hidden="true" tabindex="-1"></a>ax2.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.6</span>,<span class="fl">0.5</span>)) <span class="co"># phase legend position:</span></span>
<span id="cb155-60"><a href="#cb155-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-61"><a href="#cb155-61" aria-hidden="true" tabindex="-1"></a><span class="co">#ax1.legend(loc='lower left')</span></span>
<span id="cb155-62"><a href="#cb155-62" aria-hidden="true" tabindex="-1"></a><span class="co">#ax2.legend(loc='lower right')</span></span>
<span id="cb155-63"><a href="#cb155-63" aria-hidden="true" tabindex="-1"></a>ax1.grid()</span>
<span id="cb155-64"><a href="#cb155-64" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Magnitude and phase response'</span>)</span>
<span id="cb155-65"><a href="#cb155-65" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.savefig('reactive_path_4_bode.png')</span></span>
<span id="cb155-66"><a href="#cb155-66" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Klon Centaur part 3v1_files/figure-html/cell-145-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The plot above shows that influence of the rotation of <span class="math inline">\(P_1\)</span> has a large effect on the amplitude response at <span class="math inline">\(P_1\)</span> rotational positions of 50 and 75%. However when <span class="math inline">\(C_{13}\)</span> is included in the analysis, the zero created at about 500 Hz greatly influences the response along this path as shown in the plot below.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="reactive_path_4_bode.png" class="img-fluid figure-img"></p>
<figcaption>Reactive path 4 with <span class="math inline">\(C_{13}\)</span> included in the netlist.</figcaption>
</figure>
</div>
</section>
</section>
</section>
<section id="summary" class="level2" data-number="27.4">
<h2 data-number="27.4" class="anchored" data-anchor-id="summary"><span class="header-section-number">27.4</span> Summary</h2>
<p>The Klon Centaur is a famous, highly sought-after and legendary guitar pedal. The pedal was adopted by some <a href="https://www.geartalk.com/klon-centaur/">notable players</a> (Jeff Beck, Mark Tremonti, John Mayer, Andy Summers, Peter Frampton, Jason Isbell, James Hetfield, Joe Perry, Britt Daniel, David Grissom, Adam Hann, Joe Bonamassa). The limited initial production and long wait times led to its rarity and high demand.</p>
<p>Working on this series of JupyterLab pages has given me the opportunity to to learn a few things about electric guitars and pedals. If I were to continue farther down this path, the next step would be to build some breadboard circuits and verify my analysis by comparing calculated with measured results.</p>
<p>Here are a few of my observations:</p>
<ul>
<li>Clean path 1 not contributing much and signals on this path appear to be covered by the clean path 2 and the diode path.</li>
<li>Reactive branches 3 and 4 are unusual filters
<ul>
<li>Branch 3 provides 20 dB of emphasis across the guitar audio band</li>
<li>Branch 4 provides 3 to 4 dB of emphasis across the guitar audio band<br>
</li>
<li>Both seem superfluous and appear to be dominated by <span class="math inline">\(R_{20}\)</span> and <span class="math inline">\(C_{13}\)</span></li>
</ul></li>
</ul>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-basso2016" class="csl-entry" role="listitem">
Basso, Christophe. 2016. <span>“Introduction to Fast Analytical Techniques: Application to Small-Signal Modeling.”</span> 2016. <a href="https://www.powersimtof.com/Downloads/PPTs/Chris%20Basso%20APEC%20seminar%202016.pdf">https://www.powersimtof.com/Downloads/PPTs/Chris%20Basso%20APEC%20seminar%202016.pdf</a>.
</div>
<div id="ref-Middlebrook1998" class="csl-entry" role="listitem">
Middlebrook, R. D., V. Vorperian, and J. Lindal. 1998. <span>“The n Extra Element Theorem.”</span> <em>IEEE Transactions on Circuits and Systems I: Fundamental Theory and Applications</em> 45 (9): 919–35. <a href="https://doi.org/10.1109/81.721258">https://doi.org/10.1109/81.721258</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Klon Centaur part 2v0.html" class="pagination-link" aria-label="Klon Centaur, Part 2">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Klon Centaur, Part 2</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Wien bridge oscillator.html" class="pagination-link" aria-label="Wien Bridge Oscillator">
        <span class="nav-page-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Wien Bridge Oscillator</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>